"use strict";(self.webpackChunkih_portal=self.webpackChunkih_portal||[]).push([[294],{9294:(kt,q,f)=>{f.r(q),f.d(q,{DashboardsModule:()=>zt});var m=f(8692),l=f(92),y=f(9841),D=f(8968),g=f(8239),o=f(8629),x=f(574),t=f(4537),T=f(1383),A=f(7556),U=f(1815);let N=(()=>{class a{constructor(){}ngOnInit(){}csv(e="data",i=","){table2csv(e,i)}excel(e="data"){table2excel(e)}pdf(e="data"){table2pdf(e,"l")}json(e="data"){table2json(e)}print(e="data"){printTable(e)}}return a.\u0275fac=function(e){return new(e||a)},a.\u0275cmp=t.Xpm({type:a,selectors:[["table-export"]],decls:16,vars:0,consts:[[3,"click"]],template:function(e,i){1&e&&(t.TgZ(0,"ul")(1,"li")(2,"span",0),t.NdJ("click",function(){return i.excel()}),t._uU(3,"Excel"),t.qZA()(),t.TgZ(4,"li")(5,"span",0),t.NdJ("click",function(){return i.csv()}),t._uU(6,"CSV"),t.qZA()(),t.TgZ(7,"li")(8,"span",0),t.NdJ("click",function(){return i.json()}),t._uU(9,"JSON"),t.qZA()(),t.TgZ(10,"li")(11,"span",0),t.NdJ("click",function(){return i.pdf()}),t._uU(12,"PDF"),t.qZA()(),t.TgZ(13,"li")(14,"span",0),t.NdJ("click",function(){return i.print()}),t._uU(15,"PRINT"),t.qZA()()())},styles:["ul[_ngcontent-%COMP%]{list-style-type:none;margin:0;padding:0;overflow:hidden}li[_ngcontent-%COMP%]{float:left;background-color:#333}li[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;color:#fff;text-align:center;padding:5px 10px;text-decoration:none;font-size:14px;cursor:pointer}li[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:hover{background-color:#111}"]}),a})();class ${constructor(){this.sortOrder=1,this.collator=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"})}startSort(n,e,i=""){return"desc"===e&&(this.sortOrder=-1),(s,d)=>{if("date"===i)return this.sortData(new Date(s[n]),new Date(d[n]));var r=n.split(".");if(r.length>1){if(2==r.length)return this.collator.compare(s[r[0]][r[1]],d[r[0]][r[1]])*this.sortOrder;if(3==r.length)return this.collator.compare(s[r[0]][r[1]][r[2]],d[r[0]][r[1]][r[2]])*this.sortOrder;if(4==r.length)return this.collator.compare(s[r[0]][r[1]][r[2]][r[3]],d[r[0]][r[1]][r[2]][r[3]])*this.sortOrder;if(5==r.length)return this.collator.compare(s[r[0]][r[1]][r[2]][r[3]][r[4]],d[r[0]][r[1]][r[2]][r[3]][r[4]])*this.sortOrder}return this.collator.compare(s[n],d[n])*this.sortOrder}}sortData(n,e){return n<e?-1*this.sortOrder:n>e?1*this.sortOrder:0*this.sortOrder}}let O=(()=>{class a{constructor(e,i){this.renderer=e,this.targetElem=i}sortData(){const e=new $,i=this.targetElem.nativeElement,s=i.getAttribute("data-order"),d=i.getAttribute("data-type"),r=i.getAttribute("data-name");"desc"===s?(this.appSort.sort(e.startSort(r,s,d)),i.setAttribute("data-order","asc")):(this.appSort.sort(e.startSort(r,s,d)),i.setAttribute("data-order","desc"))}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(t.Qsj),t.Y36(t.SBq))},a.\u0275dir=t.lG2({type:a,selectors:[["","appSort",""]],hostBindings:function(e,i){1&e&&t.NdJ("click",function(){return i.sortData()})},inputs:{appSort:"appSort"}}),a})();function I(a,n){if(1&a&&(t.TgZ(0,"div",18),t._UZ(1,"i",19),t.TgZ(2,"div",20),t._uU(3),t.qZA()()),2&a){const e=t.oxw();t.xp6(3),t.hij(" ",e.initMsg,"")}}function S(a,n){if(1&a&&(t.TgZ(0,"option",24),t._uU(1),t.qZA()),2&a){const e=n.$implicit;t.s9C("value",e.id),t.xp6(1),t.hij(" ",e.name," ")}}function J(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"div",9)(1,"div",10)(2,"label"),t._uU(3,"District"),t.qZA(),t.TgZ(4,"select",21),t.NdJ("change",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.genarateSites())}),t._UZ(5,"option",22),t.YNc(6,S,2,2,"option",23),t.qZA()()()}if(2&a){const e=t.oxw();t.xp6(6),t.Q6J("ngForOf",e.Districts$)}}function Q(a,n){if(1&a&&(t.TgZ(0,"option",24),t._uU(1),t.qZA()),2&a){const e=n.$implicit;t.s9C("value",e.id),t.xp6(1),t.hij(" ",e.name," ")}}function M(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"div",9)(1,"div",10)(2,"label"),t._uU(3,"Site"),t.qZA(),t.TgZ(4,"select",25),t.NdJ("change",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.genarateChws())}),t._UZ(5,"option",22),t.YNc(6,Q,2,2,"option",23),t.qZA()()()}if(2&a){const e=t.oxw();t.xp6(6),t.Q6J("ngForOf",e.sites$)}}function Y(a,n){1&a&&(t.TgZ(0,"div",8)(1,"div",26)(2,"div",10)(3,"label"),t._uU(4,"."),t.qZA(),t.TgZ(5,"div",27),t._UZ(6,"input",28),t.TgZ(7,"label",29)(8,"b"),t._uU(9,"Avec Ratio"),t.qZA()()()()()())}function E(a,n){if(1&a&&(t.TgZ(0,"tr")(1,"td",49),t._uU(2),t.qZA(),t.TgZ(3,"td",49),t._uU(4),t.qZA(),t.TgZ(5,"td",50),t._uU(6),t.qZA(),t.TgZ(7,"td",50),t._uU(8),t.qZA(),t.TgZ(9,"td",51),t._uU(10),t.qZA(),t.TgZ(11,"td",51),t._uU(12),t.qZA(),t.TgZ(13,"td",50),t._uU(14),t.qZA(),t.TgZ(15,"td",50),t._uU(16),t.qZA(),t.TgZ(17,"td",51),t._uU(18),t.qZA(),t.TgZ(19,"td",51),t._uU(20),t.qZA(),t.TgZ(21,"td",52),t._uU(22),t.qZA(),t.TgZ(23,"td",52),t._uU(24),t.qZA(),t.TgZ(25,"td",49)(26,"strong"),t._uU(27),t.qZA()()()),2&a){const e=n.$implicit;t.xp6(2),t.Oqu(e.chw.external_id),t.xp6(2),t.Oqu(e.chw.name),t.xp6(2),t.Oqu(e.data.sum_soins_suivi.tonoudayo),t.xp6(2),t.Oqu(e.data.sum_soins_suivi.dhis2),t.xp6(2),t.Oqu(e.data.sum_enceinte_postpartum.tonoudayo),t.xp6(2),t.Oqu(e.data.sum_enceinte_postpartum.dhis2),t.xp6(2),t.Oqu(e.data.pf.tonoudayo),t.xp6(2),t.Oqu(e.data.pf.dhis2),t.xp6(2),t.Oqu(e.data.home_visit.tonoudayo),t.xp6(2),t.Oqu(e.data.home_visit.dhis2),t.xp6(2),t.Oqu(e.data.total_vad.tonoudayo),t.xp6(2),t.Oqu(e.data.total_vad.dhis2),t.xp6(3),t.Oqu(e.data.sum_total_vad)}}function L(a,n){if(1&a&&(t.TgZ(0,"section",30)(1,"div",31)(2,"div",6)(3,"div",32),t._UZ(4,"table-export"),t.qZA()(),t.TgZ(5,"div",33)(6,"table",34)(7,"thead")(8,"tr")(9,"th",35),t._uU(10,"Code ASC"),t.qZA(),t.TgZ(11,"th",36),t._uU(12,"Nom ASC"),t.qZA(),t.TgZ(13,"th",37),t._uU(14,"Pcime "),t._UZ(15,"br"),t._uU(16," Appli."),t.qZA(),t.TgZ(17,"th",38),t._uU(18,"Pcime "),t._UZ(19,"br"),t._uU(20," Saisie"),t.qZA(),t.TgZ(21,"th",39),t._uU(22,"Maternel "),t._UZ(23,"br"),t._uU(24," Appli."),t.qZA(),t.TgZ(25,"th",40),t._uU(26,"Maternel "),t._UZ(27,"br"),t._uU(28," Saisie"),t.qZA(),t.TgZ(29,"th",41),t._uU(30,"PF "),t._UZ(31,"br"),t._uU(32," Appli."),t.qZA(),t.TgZ(33,"th",42),t._uU(34,"PF "),t._UZ(35,"br"),t._uU(36," Saisie"),t.qZA(),t.TgZ(37,"th",43),t._uU(38,"Recherche "),t._UZ(39,"br"),t._uU(40," Appli."),t.qZA(),t.TgZ(41,"th",44),t._uU(42,"Recherche "),t._UZ(43,"br"),t._uU(44," Saisie"),t.qZA(),t.TgZ(45,"th",45),t._uU(46,"Somme "),t._UZ(47,"br"),t._uU(48," Appli."),t.qZA(),t.TgZ(49,"th",46),t._uU(50,"Somme "),t._UZ(51,"br"),t._uU(52," Saisie"),t.qZA(),t.TgZ(53,"th",47),t._uU(54,"Total "),t._UZ(55,"br"),t._uU(56," Action"),t.qZA()()(),t.TgZ(57,"tbody"),t.YNc(58,E,28,13,"tr",48),t.qZA()()()()()),2&a){const e=t.oxw();t.xp6(9),t.Q6J("appSort",e.FinalChwsOutputData$),t.xp6(2),t.Q6J("appSort",e.FinalChwsOutputData$),t.xp6(2),t.Q6J("appSort",e.FinalChwsOutputData$),t.xp6(4),t.Q6J("appSort",e.FinalChwsOutputData$),t.xp6(4),t.Q6J("appSort",e.FinalChwsOutputData$),t.xp6(4),t.Q6J("appSort",e.FinalChwsOutputData$),t.xp6(4),t.Q6J("appSort",e.FinalChwsOutputData$),t.xp6(4),t.Q6J("appSort",e.FinalChwsOutputData$),t.xp6(4),t.Q6J("appSort",e.FinalChwsOutputData$),t.xp6(4),t.Q6J("appSort",e.FinalChwsOutputData$),t.xp6(4),t.Q6J("appSort",e.FinalChwsOutputData$),t.xp6(4),t.Q6J("appSort",e.FinalChwsOutputData$),t.xp6(4),t.Q6J("appSort",e.FinalChwsOutputData$),t.xp6(5),t.Q6J("ngForOf",e.FinalChwsOutputData$)}}function P(a,n){if(1&a&&(t.TgZ(0,"thead")(1,"tr",57)(2,"th",58),t._uU(3),t.qZA()()()),2&a){const e=n.$implicit;t.xp6(3),t.AsE(" ",e.chw.name," ( ",e.chw.external_id," )")}}function z(a,n){if(1&a&&(t.TgZ(0,"tbody")(1,"tr")(2,"th",56),t._uU(3," Pcime"),t.qZA(),t.TgZ(4,"th",59),t._uU(5),t.qZA(),t.TgZ(6,"th",59),t._uU(7),t.qZA()(),t.TgZ(8,"tr")(9,"th",56),t._uU(10," Maternel"),t.qZA(),t.TgZ(11,"th",59),t._uU(12),t.qZA(),t.TgZ(13,"th",59),t._uU(14),t.qZA()(),t.TgZ(15,"tr")(16,"th",56),t._uU(17," PF"),t.qZA(),t.TgZ(18,"th",59),t._uU(19),t.qZA(),t.TgZ(20,"th",59),t._uU(21),t.qZA()(),t.TgZ(22,"tr")(23,"th",56),t._uU(24," Recherche"),t.qZA(),t.TgZ(25,"th",59),t._uU(26),t.qZA(),t.TgZ(27,"th",59),t._uU(28),t.qZA()(),t.TgZ(29,"tr")(30,"th",56),t._uU(31," Total"),t.qZA(),t.TgZ(32,"th",59),t._uU(33),t.qZA(),t.TgZ(34,"th",59),t._uU(35),t.qZA()(),t.TgZ(36,"tr")(37,"th",60),t._uU(38),t.qZA()()()),2&a){const e=n.$implicit;t.xp6(5),t.Oqu(e.data.sum_soins_suivi.tonoudayo),t.xp6(2),t.Oqu(e.data.sum_soins_suivi.dhis2),t.xp6(5),t.Oqu(e.data.sum_enceinte_postpartum.tonoudayo),t.xp6(2),t.Oqu(e.data.sum_enceinte_postpartum.dhis2),t.xp6(5),t.Oqu(e.data.pf.tonoudayo),t.xp6(2),t.Oqu(e.data.pf.dhis2),t.xp6(5),t.Oqu(e.data.home_visit.tonoudayo),t.xp6(2),t.Oqu(e.data.home_visit.dhis2),t.xp6(5),t.Oqu(e.data.total_vad.tonoudayo),t.xp6(2),t.Oqu(e.data.total_vad.dhis2),t.xp6(3),t.hij(" Total Action: ",e.data.sum_total_vad," ")}}function k(a,n){if(1&a&&(t.TgZ(0,"section",30)(1,"div",53)(2,"div",33)(3,"table",54),t.YNc(4,P,4,2,"thead",48),t.TgZ(5,"thead")(6,"tr",55)(7,"th",56),t._uU(8,"Type"),t.qZA(),t.TgZ(9,"th",56),t._uU(10,"Application"),t.qZA(),t.TgZ(11,"th",56),t._uU(12,"Fiche r\xe9cape"),t.qZA()()(),t.YNc(13,z,39,11,"tbody",48),t.qZA()()()()),2&a){const e=t.oxw();t.xp6(4),t.Q6J("ngForOf",e.FinalChwsOutputData$),t.xp6(9),t.Q6J("ngForOf",e.FinalChwsOutputData$)}}let G=(()=>{class a{constructor(e,i,s){this.store=e,this.auth=i,this.sync=s,this.roles=new x.G(this.store),this.chwOU=null,this.FinalChwsOutputData$=[],this.Districts$=[],this.Chws$=[],this.Sites$=[],this.chws$=[],this.sites$=[],this.responseMessage="",!this.roles.isSupervisorMentor()&&!this.roles.isChws()&&(location.href=this.auth.userValue()?.defaultRedirectUrl)}sum(e){throw new Error("Method not implemented.")}createDataFilterFormGroup(){return new l.cw({start_date:new l.NI(this.initDate.start_date,[l.kI.required,l.kI.minLength(7)]),end_date:new l.NI(this.initDate.end_date,[l.kI.required,l.kI.minLength(7)]),districts:new l.NI(""),sites:new l.NI(""),withRatio:new l.NI(!1,[l.kI.required])})}identifyBodyData(e,i){return i.Code}ngOnInit(){this.chwOU=this.auth.chwsOrgUnit(),this.roles.isChws()&&(null==this.chwOU||!(0,o.Nf)(this.chwOU))&&(location.href="chws/select_orgunit"),this.isLoading=!1,this.initDate=o.ED.startEnd21and20Date(),this.aggradateDataForm=this.createDataFilterFormGroup(),this.roles.isChws()?this.initDataFilted():this.initAllData()}initAllData(){var e=this;return(0,g.Z)(function*(){e.isLoading=!0,e.initMsg="Chargement des Districts ...",e.sync.getDistrictsList().subscribe(function(){var i=(0,g.Z)(function*(s){200==s.status&&(e.Districts$=s.data),e.initMsg="Chargement des Sites ...",e.sync.getSitesList().subscribe(function(){var d=(0,g.Z)(function*(r){200==r.status&&(e.Sites$=r.data),e.genarateSites(),e.initMsg="Chargement des ASC ...",e.sync.getChwsList().subscribe(function(){var c=(0,g.Z)(function*(p){200==p.status&&(e.Chws$=p.data),e.genarateChws(),e.isLoading=!1});return function(p){return c.apply(this,arguments)}}(),c=>{e.isLoading=!1,console.log(c.error)})});return function(r){return d.apply(this,arguments)}}(),d=>{e.isLoading=!1,console.log(d.error)})});return function(s){return i.apply(this,arguments)}}(),i=>{e.isLoading=!1,console.log(i.error)})})()}genarateSites(){this.sites$=[],this.chws$=[];const e=this.aggradateDataForm.value.districts;if(this.aggradateDataForm.value.sites="",this.aggradateDataForm.value.chws=[],(0,o.Nf)(e))for(let i=0;i<this.Sites$.length;i++){const s=this.Sites$[i];(0,o.Nf)(s)&&e.includes(s.district.id)&&this.sites$.push(s)}else this.sites$=[]}genarateChws(){const e=o.FI.returnDataAsArray(this.aggradateDataForm.value.sites);if(this.chws$=[],this.aggradateDataForm.value.chws=[],(0,o.Nf)(e))for(let i=0;i<this.Chws$.length;i++){const s=this.Chws$[i];(0,o.Nf)(s)&&e.includes(s.site.id)&&this.chws$.push(s)}else this.chws$=this.Chws$}ParamsToFilter(){const e=this.aggradateDataForm.value.start_date,i=this.aggradateDataForm.value.end_date;var s=[],d=[],r=[];return this.roles.isChws()?null!=this.chwOU&&(0,o.Nf)(this.chwOU)&&(s=o.FI.returnDataAsArray(this.chwOU.site.district.id),d=o.FI.returnDataAsArray(this.chwOU.site.id),r=o.FI.returnDataAsArray(this.chwOU.id)):(s=o.FI.returnDataAsArray(this.aggradateDataForm.value.districts),d=o.FI.returnDataAsArray(this.aggradateDataForm.value.sites)),{start_date:e,end_date:i,districts:s,sites:d,chws:r,withDhis2Data:!0}}initDataFilted(e){this.initMsg="Loading Data ...",this.isLoading=!0,this.genarateChws(),this.sync.ihChtDataPerChw(e??this.ParamsToFilter()).subscribe(i=>{200==i.status?this.FinalChwsOutputData$=i.data:this.responseMessage=i.data,this.isLoading=!1},i=>{this.isLoading=!1,console.log(i)})}isRatioChecked(){return 1==this.aggradateDataForm.value.withRatio}getRatio(e,i,s=!0){var d=0,r="success",c=e-i;if(s){const p=100*(e>0?c/e:i/100);(d=+(p<0?-1*p:p).toFixed(2))>0&&d<=5&&(r="warning"),d>5&&(r="danger")}else d=+(c<0?-1*c:c).toFixed(2);return{value:d,color:r}}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(T.u),t.Y36(A.e),t.Y36(U._))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-dashboard-1"]],decls:32,vars:8,consts:[[1,"content-header"],[1,"container-fluid"],[1,"card","card-info"],[2,"text-align","center"],[1,"overlay-wrapper"],["class","overlay",4,"ngIf"],[1,"card-header"],["novalidate","",3,"formGroup","ngSubmit"],[1,"row"],[1,"col-sm-2","col-6"],[1,"form-group"],["type","date","formControlName","start_date",1,"form-control"],["type","date","formControlName","end_date",1,"form-control"],["class","col-sm-2 col-6",4,"ngIf"],["type","submit",1,"btn","btn-warning","form-control",3,"disabled"],[1,"fa","fa-floppy-o","fa-right"],["class","row",4,"ngIf"],["class","content",4,"ngIf"],[1,"overlay"],[1,"fas","fa-3x","fa-sync-alt","fa-spin"],[1,"text-bold","pt-2"],["formControlName","districts",1,"form-control",3,"change"],["value",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["formControlName","sites",1,"form-control",3,"change"],[1,"col-sm-4"],[1,"form-check"],["id","withRatio","type","checkbox","formControlName","withRatio",1,"form-check-input",2,"font-size","20px"],["for","withRatio",1,"form-check-label"],[1,"content"],[1,"card",2,"overflow-y","scroll!important"],[1,"card-title"],[1,"card-body"],["border","1 solid","id","export_table",1,"table","table-bordered","table-hover","border"],["data-order","desc","data-name","chw.external_id",1,"bg-info",2,"width","50px",3,"appSort"],["data-order","desc","data-name","chw.name",1,"bg-info",2,"width","150px",3,"appSort"],["data-order","desc","data-name","data.sum_soins_suivi.tonoudayo",1,"bg-warning",2,"width","40px",3,"appSort"],["data-order","desc","data-name","data.sum_soins_suivi.dhis2",1,"bg-warning",2,"width","40px",3,"appSort"],["data-order","desc","data-name","data.sum_enceinte_postpartum.tonoudayo",1,"bg-primary",2,"width","40px",3,"appSort"],["data-order","desc","data-name","data.sum_enceinte_postpartum.dhis2",1,"bg-primary",2,"width","40px",3,"appSort"],["data-order","desc","data-name","data.pf.tonoudayo",1,"bg-warning",2,"width","40px",3,"appSort"],["data-order","desc","data-name","data.pf.dhis2",1,"bg-warning",2,"width","40px",3,"appSort"],["data-order","desc","data-name","data.home_visit.tonoudayo",1,"bg-primary",2,"width","40px",3,"appSort"],["data-order","desc","data-name","data.home_visit.dhis2",1,"bg-primary",2,"width","40px",3,"appSort"],["data-order","desc","data-name","data.total_vad.tonoudayo",1,"bg-success",2,"width","40px",3,"appSort"],["data-order","desc","data-name","data.total_vad.dhis2",1,"bg-success",2,"width","40px",3,"appSort"],["data-order","desc","data-name","data.sum_total_vad",1,"bg-info",2,"width","40px",3,"appSort"],[4,"ngFor","ngForOf"],[1,"info"],[1,"warning"],[1,"primary"],[1,"final"],[1,"card"],["id","compare_data",1,"table","table-bordered","table-hover"],[1,"bg-info"],[2,"font-size","20px"],[1,"bg-default"],["colspan","3"],[2,"font-size","20px","text-align","center"],["colspan","3",2,"font-size","20px","text-align","center"]],template:function(e,i){1&e&&(t.TgZ(0,"section",0)(1,"div",1)(2,"div",2)(3,"h1",3),t._uU(4,"Activit\xe9 des ASC"),t.qZA(),t.TgZ(5,"div",4),t.YNc(6,I,4,1,"div",5),t.TgZ(7,"div",6)(8,"form",7),t.NdJ("ngSubmit",function(){return i.initDataFilted()}),t.TgZ(9,"div",8)(10,"div",9)(11,"div",10)(12,"label"),t._uU(13,"Date D\xe9but"),t.qZA(),t._UZ(14,"input",11),t.qZA()(),t.TgZ(15,"div",9)(16,"div",10)(17,"label"),t._uU(18,"Date Fin"),t.qZA(),t._UZ(19,"input",12),t.qZA()(),t.YNc(20,J,7,1,"div",13),t.YNc(21,M,7,1,"div",13),t.TgZ(22,"div",9)(23,"div",10)(24,"label"),t._uU(25,"."),t.qZA(),t.TgZ(26,"button",14),t._uU(27," OK "),t._UZ(28,"span",15),t.qZA()()()(),t.YNc(29,Y,10,0,"div",16),t.qZA()()()()()(),t.YNc(30,L,59,14,"section",17),t.YNc(31,k,14,2,"section",17)),2&e&&(t.xp6(6),t.Q6J("ngIf",i.isLoading),t.xp6(2),t.Q6J("formGroup",i.aggradateDataForm),t.xp6(12),t.Q6J("ngIf",!i.roles.isChws()),t.xp6(1),t.Q6J("ngIf",!i.roles.isChws()),t.xp6(5),t.Q6J("disabled",!i.aggradateDataForm.valid),t.xp6(3),t.Q6J("ngIf",!i.roles.isChws()),t.xp6(1),t.Q6J("ngIf",i.FinalChwsOutputData$.length>0&&i.roles.isSupervisorMentor()),t.xp6(1),t.Q6J("ngIf",i.FinalChwsOutputData$.length>0&&i.roles.isChws()))},dependencies:[m.sg,m.O5,l._Y,l.YN,l.Kr,l.Fj,l.Wl,l.EJ,l.JJ,l.JL,l.sg,l.u,N,O],styles:[".info[_ngcontent-%COMP%]{color:#00f;font-weight:bolder}.warning[_ngcontent-%COMP%]{color:orange;font-size:large;font-weight:bolder}.primary[_ngcontent-%COMP%]{color:purple;font-size:large;font-weight:bolder}.final[_ngcontent-%COMP%]{color:green;font-size:large;font-weight:bolder}.line[_ngcontent-%COMP%]{color:#000;font-size:large;font-weight:bolder}"]}),a})();function K(a,n){if(1&a&&(t.TgZ(0,"div",21),t._UZ(1,"i",22),t.TgZ(2,"div",23),t._uU(3),t.qZA()()),2&a){const e=t.oxw();t.xp6(3),t.hij(" ",e.initMsg,"")}}function R(a,n){if(1&a&&(t.TgZ(0,"option",28),t._uU(1),t.qZA()),2&a){const e=n.$implicit;t.s9C("value",e.id),t.xp6(1),t.hij(" ",e.name," ")}}function H(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"select",26),t.NdJ("change",function(){t.CHM(e);const s=t.oxw(2);return t.KtG(s.genarateSites())}),t.YNc(1,R,2,2,"option",27),t.qZA()}if(2&a){const e=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",e.Districts$)}}function V(a,n){1&a&&t._UZ(0,"select",29)}function B(a,n){if(1&a&&(t.TgZ(0,"div",9)(1,"div",10)(2,"label"),t._uU(3,"District"),t.qZA(),t.YNc(4,H,2,1,"select",24),t.YNc(5,V,1,0,"select",25),t.qZA()()),2&a){const e=t.oxw();t.xp6(4),t.Q6J("ngIf",e.Districts$.length>0),t.xp6(1),t.Q6J("ngIf",0==e.Districts$.length)}}function X(a,n){if(1&a&&(t.TgZ(0,"option",28),t._uU(1),t.qZA()),2&a){const e=n.$implicit;t.s9C("value",e.id),t.xp6(1),t.hij(" ",e.name," ")}}function j(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"select",31),t.NdJ("change",function(){t.CHM(e);const s=t.oxw(2);return t.KtG(s.genarateChws())}),t.YNc(1,X,2,2,"option",27),t.qZA()}if(2&a){const e=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",e.sites$)}}function W(a,n){1&a&&t._UZ(0,"select",29)}function tt(a,n){if(1&a&&(t.TgZ(0,"div",9)(1,"div",10)(2,"label"),t._uU(3,"Site"),t.qZA(),t.YNc(4,j,2,1,"select",30),t.YNc(5,W,1,0,"select",25),t.qZA()()),2&a){const e=t.oxw();t.xp6(4),t.Q6J("ngIf",e.sites$.length>0),t.xp6(1),t.Q6J("ngIf",0==e.sites$.length)}}function et(a,n){if(1&a&&(t.TgZ(0,"option",28),t._uU(1),t.qZA()),2&a){const e=n.$implicit;t.s9C("value",e.id),t.xp6(1),t.hij(" ",e.name," ")}}function it(a,n){if(1&a&&(t.TgZ(0,"select",33),t.YNc(1,et,2,2,"option",27),t.qZA()),2&a){const e=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",e.chws$)}}function at(a,n){1&a&&t._UZ(0,"select",29)}function st(a,n){if(1&a&&(t.TgZ(0,"div",9)(1,"div",10)(2,"label"),t._uU(3,"ASC"),t.qZA(),t.YNc(4,it,2,1,"select",32),t.YNc(5,at,1,0,"select",25),t.qZA()()),2&a){const e=t.oxw();t.xp6(4),t.Q6J("ngIf",e.chws$.length>0),t.xp6(1),t.Q6J("ngIf",0==e.chws$.length)}}function ot(a,n){if(1&a&&(t.TgZ(0,"option",28),t._uU(1),t.qZA()),2&a){const e=n.$implicit;t.s9C("value",e),t.xp6(1),t.hij(" ",e," ")}}function nt(a,n){if(1&a&&(t.TgZ(0,"div",9)(1,"div",10)(2,"label"),t._uU(3,"Source"),t.qZA(),t.TgZ(4,"select",34)(5,"option",35),t._uU(6,"Tout"),t.qZA(),t.YNc(7,ot,2,2,"option",27),t.qZA()()()),2&a){const e=t.oxw();t.xp6(7),t.Q6J("ngForOf",e.Sources$)}}function rt(a,n){if(1&a&&(t.TgZ(0,"option",28),t._uU(1),t.qZA()),2&a){const e=n.$implicit;t.s9C("value",e),t.xp6(1),t.hij(" ",e," ")}}function lt(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"div",9)(1,"div",10)(2,"label"),t._uU(3,"Nbre Jour d'activit\xe9"),t.qZA(),t.TgZ(4,"select",36),t.NdJ("change",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.initDataFilted())}),t.YNc(5,rt,2,2,"option",27),t.qZA()()()}if(2&a){const e=t.oxw();t.xp6(5),t.Q6J("ngForOf",e.days$)}}function dt(a,n){if(1&a&&(t.TgZ(0,"h2")(1,"div",2)(2,"div",37),t._uU(3),t.qZA()()()),2&a){const e=t.oxw();t.xp6(3),t.hij(" ",e.data_error_messages," ")}}function ct(a,n){1&a&&(t.TgZ(0,"h2")(1,"div",2)(2,"div",37),t._uU(3," Pas de donn\xe9es trouv\xe9e avec les paramettres renseign\xe9s ! "),t.qZA()()())}function ht(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"tr")(1,"td")(2,"span",44)(3,"b"),t._uU(4),t.qZA()(),t._UZ(5,"br"),t.TgZ(6,"span",45),t._uU(7),t.qZA(),t._UZ(8,"br"),t.TgZ(9,"span",46)(10,"small"),t._uU(11,"Total Action: "),t.qZA(),t.TgZ(12,"b"),t._uU(13),t.qZA()()(),t.TgZ(14,"td")(15,"span",47),t._uU(16,"~ "),t.qZA(),t.TgZ(17,"span",48),t._uU(18),t.qZA(),t._UZ(19,"br"),t.TgZ(20,"span",49)(21,"strong"),t._uU(22,"Actions/Jr"),t.qZA()()(),t.TgZ(23,"td")(24,"button",50),t.NdJ("click",function(){const d=t.CHM(e).$implicit,r=t.oxw(2);return t.KtG(r.seeSelectedChwData(d))}),t._uU(25,"D\xe9tails"),t.qZA()()()}if(2&a){const e=n.$implicit,i=t.oxw(2);t.xp6(4),t.Oqu(e.chw.name),t.xp6(3),t.Oqu(e.chw.external_id),t.xp6(6),t.Oqu(i.sum(e.data)),t.xp6(4),t.Gre("custom-action badge ",i.getVadPerDay(e).class,""),t.xp6(1),t.hij(" ",i.getVadPerDay(e).val," ")}}function ut(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"div",2)(1,"div",38)(2,"div",6)(3,"h3",39),t._uU(4,"Donn\xe9es par ASC"),t.qZA()(),t.TgZ(5,"div",40)(6,"table",41),t.NdJ("click",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.sort())}),t.TgZ(7,"thead")(8,"tr",42)(9,"th"),t._uU(10,"ASC"),t.qZA(),t.TgZ(11,"th"),t._uU(12,"Nbre Action/Jour"),t.qZA(),t._UZ(13,"th"),t.qZA()(),t.TgZ(14,"tbody"),t.YNc(15,ht,26,7,"tr",43),t.qZA()()()()()}if(2&a){const e=t.oxw();t.xp6(15),t.Q6J("ngForOf",e.FinalChwsOutputData$)}}function pt(a,n){if(1&a&&(t.TgZ(0,"div",63)(1,"div",64)(2,"h3",65),t._uU(3),t.qZA(),t.TgZ(4,"p",66)(5,"strong"),t._uU(6),t.qZA()()(),t.TgZ(7,"div",67),t._UZ(8,"i",68),t.qZA()()),2&a){const e=t.oxw().$implicit,i=t.oxw(2);t.xp6(3),t.Oqu(i.generateCount(e.value)),t.xp6(3),t.Oqu(i.capitaliseDataGiven(e.key,"_"," "))}}function gt(a,n){if(1&a&&(t.TgZ(0,"div"),t.YNc(1,pt,9,2,"div",62),t.qZA()),2&a){const e=n.$implicit,i=t.oxw(2);t.Tol(i.showClass(e)),t.xp6(1),t.Q6J("ngIf",i.isNumber(e.value))}}function ft(a,n){if(1&a&&(t.TgZ(0,"div",51)(1,"div",52)(2,"div",53)(3,"div",54)(4,"h2"),t._uU(5),t._UZ(6,"br"),t.TgZ(7,"small"),t._uU(8),t.qZA()(),t.TgZ(9,"button",55)(10,"span",56),t._uU(11,"\xd7"),t.qZA()()(),t.TgZ(12,"div",57)(13,"div",58),t.YNc(14,gt,2,4,"div",59),t.ALo(15,"keyvalue"),t.qZA()(),t.TgZ(16,"div",60)(17,"button",61),t._uU(18,"Fermer"),t.qZA()()()()()),2&a){const e=t.oxw();t.xp6(5),t.hij(" ",e.selectedChwData.chw.name," "),t.xp6(3),t.Oqu(e.selectedChwData.chw.external_id),t.xp6(6),t.Q6J("ngForOf",t.lcZ(15,3,e.selectedChwData.data))}}let _t=(()=>{class a{constructor(e,i,s){this.store=e,this.auth=i,this.sync=s,this.roles=new x.G(this.store),this.chwOU=null,this.allAggragateData=[],this.data_error_messages="",this.data_no_data_found=!1,this.FinalChwsOutputData$=[],this.selectedChwData=null,this.ChwsDataFromDbError="",this.Sources$=[],this.Districts$=[],this.Sites$=[],this.Chws$=[],this.Zones$=[],this.Patients$=[],this.Families$=[],this.chws$=[],this.sites$=[],this.days$=o.FI.range(18,1),this.day=18,!this.roles.isSupervisorMentor()&&!this.roles.isChws()&&(location.href=this.auth.userValue()?.defaultRedirectUrl)}createDataFilterFormGroup(){return new l.cw({start_date:new l.NI(this.initDate.start_date,[l.kI.required,l.kI.minLength(7)]),end_date:new l.NI(this.initDate.end_date,[l.kI.required,l.kI.minLength(7)]),sources:new l.NI(""),districts:new l.NI("",this.roles.isChws()?[]:[l.kI.required]),sites:new l.NI("",this.roles.isChws()?[]:[l.kI.required]),chws:new l.NI(""),day:new l.NI(this.day,[l.kI.required])})}identifyAggragateData(e,i){return i.total_vad}generateCount(e){return e.tonoudayo+e.dhis2}isNumber(e){return!isNaN(this.generateCount(e))}showClass(e){return this.isNumber(e)?"col-sm-6 col-6":""}ngOnInit(){this.chwOU=this.auth.chwsOrgUnit(),this.roles.isChws()&&(null==this.chwOU||!(0,o.Nf)(this.chwOU))&&(location.href="chws/select_orgunit"),this.isLoading=!1,this.initDate=o.ED.startEnd21and20Date(),this.aggradateDataForm=this.createDataFilterFormGroup(),this.roles.isChws()?this.initDataFilted():this.initAllData()}initAllData(){var e=this;return(0,g.Z)(function*(){e.isLoading=!0;const i=e.ParamsToFilter();e.initMsg="Chargement des Districts ...",e.sync.getDistrictsList(i).subscribe(function(){var s=(0,g.Z)(function*(d){200==d.status&&(e.Districts$=d.data),e.initMsg="Chargement des Sites ...",e.sync.getSitesList(i).subscribe(function(){var r=(0,g.Z)(function*(c){200==c.status&&(e.Sites$=c.data),e.genarateSites(),e.initMsg="Chargement des ASC ...",e.sync.getChwsList(i).subscribe(function(){var p=(0,g.Z)(function*(_){200==_.status&&(e.Chws$=_.data),e.genarateChws(),e.isLoading=!1});return function(_){return p.apply(this,arguments)}}(),p=>{e.isLoading=!1,console.log(p.error)})});return function(c){return r.apply(this,arguments)}}(),r=>{e.isLoading=!1,console.log(r.error)})});return function(d){return s.apply(this,arguments)}}(),s=>{e.isLoading=!1,console.log(s.error)})})()}sort(){sortTable("export_table")}capitaliseDataGiven(e,i,s){return o.FI.capitaliseDataGiven(e,i,s)}seeSelectedChwData(e){this.selectedChwData=e}genarateSites(){this.sites$=[],this.chws$=[];const e=o.FI.returnEmptyArrayIfNul(this.aggradateDataForm.value.districts);if(this.aggradateDataForm.value.sites=[],this.aggradateDataForm.value.chws=[],(0,o.Nf)(e))for(let i=0;i<this.Sites$.length;i++){const s=this.Sites$[i];(0,o.Nf)(s)&&e.includes(s.district.id)&&this.sites$.push(s)}else this.sites$=[]}genarateChws(){const e=o.FI.returnEmptyArrayIfNul(this.aggradateDataForm.value.sites);if(this.chws$=[],this.aggradateDataForm.value.chws=[],(0,o.Nf)(e))for(let i=0;i<this.Chws$.length;i++){const s=this.Chws$[i];(0,o.Nf)(s)&&e.includes(s.site.id)&&this.chws$.push(s)}else this.chws$=[]}ParamsToFilter(){const e=this.aggradateDataForm.value.start_date,i=this.aggradateDataForm.value.end_date,s=this.aggradateDataForm.value.sources,d=(0,o.Nf)(s)?o.FI.returnDataAsArray(s):[];var r=[],c=[],p=[];return this.roles.isChws()?null!=this.chwOU&&(0,o.Nf)(this.chwOU)&&(r=o.FI.returnDataAsArray(this.chwOU.site.district.id),c=o.FI.returnDataAsArray(this.chwOU.site.id),p=o.FI.returnDataAsArray(this.chwOU.id),this.chws$=[this.chwOU]):(r=o.FI.returnEmptyArrayIfNul(this.aggradateDataForm.value.districts),c=o.FI.returnEmptyArrayIfNul(this.aggradateDataForm.value.sites),p=o.FI.returnEmptyArrayIfNul(this.aggradateDataForm.value.chws)),{start_date:e,end_date:i,sources:d,districts:r,sites:c,chws:p,withDhis2Data:!0}}returnEmptyArrayIfNul(e){return(0,o.Nf)(e)?e:[]}getVadPerDay(e){const i=this.sum(e.data),s=i/this.day;var d=s.toFixed(s<1?1:0);if(e.chw.name.includes("(R)")&&i<=0)return{val:d,class:""};var r="bg-success";return i>0&&s<10*this.day/this.day&&s>=5*this.day/this.day&&(r="bg-warning"),(0==i||i>0&&s<5*this.day/this.day)&&(r="bg-danger"),{val:d,class:r}}initDataFilted(e){this.isLoading=!0,this.selectedChwData=null,this.day=this.aggradateDataForm.value.day;const i=e??this.ParamsToFilter();this.defaultParams?.start_date!=i.start_date||this.defaultParams?.end_date!=i.end_date||this.defaultParams?.districts!=i.districts||this.defaultParams?.sites!=i.sites?(this.FinalChwsOutputData$=[],this.data_error_messages="",this.data_no_data_found=!1,this.ChwsDataFromDbError="",this.sync.ihChtDataPerChw(i).subscribe(s=>{this.response$=s,this.startTraitement(i)},s=>{this.isLoading=!1,this.ChwsDataFromDbError=s.toString()})):this.startTraitement(i)}sum(e){return e.total_vad.tonoudayo+e.total_vad.dhis2}startTraitement(e){this.isLoading=!0;const i=e??this.ParamsToFilter();200==this.response$.status?(this.FinalChwsOutputData$=this.response$.data,this.defaultParams=i,this.data_no_data_found=this.FinalChwsOutputData$.length<=0):(this.data_error_messages=this.response$.data.toString(),this.data_no_data_found=!0),this.isLoading=!1}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(T.u),t.Y36(A.e),t.Y36(U._))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-dashboard-2"]],decls:41,vars:12,consts:[[1,"content-header"],[1,"container-fluid"],[1,"card","card-info"],[2,"text-align","center"],[1,"overlay-wrapper"],["class","overlay",4,"ngIf"],[1,"card-header"],["novalidate","",3,"formGroup","ngSubmit"],[1,"row"],[1,"col-sm-2","col-6"],[1,"form-group"],["type","date","formControlName","start_date",1,"form-control"],["type","date","formControlName","end_date",1,"form-control"],["class","col-sm-2 col-6",4,"ngIf"],["type","submit",1,"btn","btn-warning","form-control",3,"disabled"],[1,"fa","fa-floppy-o","fa-right"],[1,"content"],[1,"col-sm-5"],[4,"ngIf"],["class","card card-info",4,"ngIf"],["class","modal fade","id","modal-default",4,"ngIf"],[1,"overlay"],[1,"fas","fa-3x","fa-sync-alt","fa-spin"],[1,"text-bold","pt-2"],["class","form-control","multiple","multiple","formControlName","districts",3,"change",4,"ngIf"],["class","form-control",4,"ngIf"],["multiple","multiple","formControlName","districts",1,"form-control",3,"change"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"form-control"],["class","form-control","multiple","multiple","formControlName","sites",3,"change",4,"ngIf"],["multiple","multiple","formControlName","sites",1,"form-control",3,"change"],["class","form-control","multiple","multiple","formControlName","chws",4,"ngIf"],["multiple","multiple","formControlName","chws",1,"form-control"],["formControlName","sources",1,"form-control"],["value",""],["formControlName","day",1,"form-control",2,"font-size","20px",3,"change"],[1,"card-body"],[1,"card"],[1,"card-title"],[1,"card-body","p-0"],["id","export_table",1,"table","table-sm","table-striped",2,"margin","auto",3,"click"],[1,"bg-info"],[4,"ngFor","ngForOf"],[1,"custom-badge",2,"font-size","16px"],[1,"custom-badge",2,"font-size","12px","color","gray"],[1,"info",2,"font-size","16px","color","blue"],[2,"font-size","18px"],[2,"font-size","33px","padding","1px"],[1,"info"],["data-toggle","modal","data-target","#modal-default",1,"btn","btn-info",2,"margin-top","15px","padding","2px!important","font-size","10px",3,"click"],["id","modal-default",1,"modal","fade"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body"],[1,"row","card-body"],[3,"class",4,"ngFor","ngForOf"],[1,"modal-footer","justify-content-between"],["id","close-modal","type","button","data-dismiss","modal",1,"btn","btn-default"],["style","border: 1px solid black;","class","small-box bg-info",4,"ngIf"],[1,"small-box","bg-info",2,"border","1px solid black"],[1,"inner"],[2,"font-size","45px","text-align","center"],[2,"font-size","20px","text-align","center"],[1,"icon"],[1,"ion","ion-stats-bars"]],template:function(e,i){1&e&&(t.TgZ(0,"section",0)(1,"div",1)(2,"div",2)(3,"h1",3),t._uU(4,"Donn\xe9es d\xe9taill\xe9es par ASC"),t.qZA(),t.TgZ(5,"div",4),t.YNc(6,K,4,1,"div",5),t.TgZ(7,"div",6)(8,"form",7),t.NdJ("ngSubmit",function(){return i.initDataFilted()}),t.TgZ(9,"div",8)(10,"div",9)(11,"div",10)(12,"label"),t._uU(13,"Date D\xe9but"),t.qZA(),t._UZ(14,"input",11),t.qZA()(),t.TgZ(15,"div",9)(16,"div",10)(17,"label"),t._uU(18,"Date Fin"),t.qZA(),t._UZ(19,"input",12),t.qZA()(),t.YNc(20,B,6,2,"div",13),t.YNc(21,tt,6,2,"div",13),t.YNc(22,st,6,2,"div",13),t.YNc(23,nt,8,1,"div",13),t.YNc(24,lt,6,1,"div",13),t.TgZ(25,"div",9)(26,"div",10)(27,"label"),t._uU(28,"."),t.qZA(),t.TgZ(29,"button",14),t._uU(30," OK "),t._UZ(31,"span",15),t.qZA()()()()()()()(),t.TgZ(32,"section",16)(33,"div",1)(34,"div",17),t.YNc(35,dt,4,1,"h2",18),t.YNc(36,ct,4,0,"h2",18),t.qZA(),t.YNc(37,ut,16,1,"div",19),t.qZA()(),t.YNc(38,ft,19,5,"div",20),t._UZ(39,"br")(40,"br"),t.qZA()()),2&e&&(t.xp6(6),t.Q6J("ngIf",i.isLoading),t.xp6(2),t.Q6J("formGroup",i.aggradateDataForm),t.xp6(12),t.Q6J("ngIf",!i.roles.isChws()),t.xp6(1),t.Q6J("ngIf",!i.roles.isChws()),t.xp6(1),t.Q6J("ngIf",!i.roles.isChws()),t.xp6(1),t.Q6J("ngIf",i.Sources$.length>0&&!i.roles.isChws()),t.xp6(1),t.Q6J("ngIf",i.days$.length>0),t.xp6(5),t.Q6J("disabled",!i.aggradateDataForm.valid),t.xp6(6),t.Q6J("ngIf",""!=i.data_error_messages),t.xp6(1),t.Q6J("ngIf",1==i.data_no_data_found),t.xp6(1),t.Q6J("ngIf",""==i.data_error_messages&&i.FinalChwsOutputData$.length>0),t.xp6(1),t.Q6J("ngIf",null!=i.selectedChwData))},dependencies:[m.sg,m.O5,l._Y,l.YN,l.Kr,l.Fj,l.EJ,l.K7,l.JJ,l.JL,l.sg,l.u,m.Nd],styles:[".custom-badge[_ngcontent-%COMP%]{font-size:18px;color:#000}.custom-action[_ngcontent-%COMP%]{font-size:25px;color:#000;text-align:center!important}.info[_ngcontent-%COMP%]{text-align:center!important}.box[_ngcontent-%COMP%]{width:600px;height:300px;border:1px solid black;padding:2px 4px;overflow-y:scroll;overflow-x:auto}.log[_ngcontent-%COMP%]{margin-top:8px;font-family:monospace}"]}),a})();var mt=f(8171);function Zt(a,n){if(1&a&&(t.TgZ(0,"div",9),t._UZ(1,"i",10),t.TgZ(2,"div",11),t._uU(3),t.qZA()()),2&a){const e=t.oxw();t.xp6(3),t.hij(" ",e.initMsg,"")}}function wt(a,n){if(1&a&&(t.TgZ(0,"option",28),t._uU(1),t.qZA()),2&a){const e=n.$implicit;t.s9C("value",e.id),t.xp6(1),t.hij(" ",e.name," ")}}function vt(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"select",25),t.NdJ("change",function(){t.CHM(e);const s=t.oxw(2);return t.KtG(s.genarateSites())}),t._UZ(1,"option",26),t.YNc(2,wt,2,2,"option",27),t.qZA()}if(2&a){const e=t.oxw(2);t.xp6(2),t.Q6J("ngForOf",e.Districts$)}}function Ct(a,n){1&a&&t._UZ(0,"select",29)}function bt(a,n){if(1&a&&(t.TgZ(0,"option",28),t._uU(1),t.qZA()),2&a){const e=n.$implicit;t.s9C("value",e.id),t.xp6(1),t.hij(" ",e.name," ")}}function Dt(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"select",30),t.NdJ("change",function(){t.CHM(e);const s=t.oxw(2);return t.KtG(s.genarateChws())})("click",function(){t.CHM(e);const s=t.oxw(2);return t.KtG(s.genarateChws())}),t._UZ(1,"option",26),t.YNc(2,bt,2,2,"option",27),t.qZA()}if(2&a){const e=t.oxw(2);t.xp6(2),t.Q6J("ngForOf",e.sites$)}}function xt(a,n){1&a&&t._UZ(0,"select",29)}function Tt(a,n){if(1&a&&(t.TgZ(0,"option",28),t._uU(1),t.qZA()),2&a){const e=n.$implicit;t.s9C("value",e.id),t.xp6(1),t.hij(" ",e.name," ")}}function At(a,n){if(1&a&&(t.TgZ(0,"select",31),t._UZ(1,"option",26),t.YNc(2,Tt,2,2,"option",27),t.qZA()),2&a){const e=t.oxw(2);t.xp6(2),t.Q6J("ngForOf",e.chws$)}}function Ut(a,n){1&a&&t._UZ(0,"select",29)}function Ft(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"div",12)(1,"form",13),t.NdJ("ngSubmit",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.initAllData())}),t.TgZ(2,"div",14)(3,"div",15)(4,"div",16)(5,"label"),t._uU(6,"District"),t.qZA(),t.YNc(7,vt,3,1,"select",17),t.qZA(),t.YNc(8,Ct,1,0,"select",18),t.qZA(),t.TgZ(9,"div",15)(10,"div",16)(11,"label"),t._uU(12,"Site"),t.qZA(),t.YNc(13,Dt,3,1,"select",19),t.qZA(),t.YNc(14,xt,1,0,"select",18),t.qZA(),t.TgZ(15,"div",20)(16,"div",16)(17,"label"),t._uU(18,"ASC"),t.qZA(),t.YNc(19,At,3,1,"select",21),t.YNc(20,Ut,1,0,"select",18),t.qZA()(),t.TgZ(21,"div",22)(22,"div",16)(23,"label"),t._uU(24,"."),t.qZA(),t.TgZ(25,"button",23),t._UZ(26,"i",24),t.qZA()()()()()()}if(2&a){const e=t.oxw();t.xp6(1),t.Q6J("formGroup",e.aggradateDataForm),t.xp6(6),t.Q6J("ngIf",e.Districts$.length>0),t.xp6(1),t.Q6J("ngIf",0==e.Districts$.length),t.xp6(5),t.Q6J("ngIf",e.sites$.length>0),t.xp6(1),t.Q6J("ngIf",0==e.sites$.length),t.xp6(5),t.Q6J("ngIf",e.chws$.length>0),t.xp6(1),t.Q6J("ngIf",0==e.chws$.length),t.xp6(5),t.Q6J("disabled",!e.aggradateDataForm.valid)}}function qt(a,n){if(1&a&&(t.TgZ(0,"div",20)(1,"div")(2,"div",32)(3,"h3",33),t._uU(4),t.qZA(),t.TgZ(5,"p")(6,"strong"),t._uU(7),t.qZA()()(),t.TgZ(8,"div",34),t._UZ(9,"i"),t.qZA()()()),2&a){const e=n.$implicit;t.xp6(1),t.Gre("small-box ",e.color,""),t.xp6(3),t.Oqu(e.count),t.xp6(3),t.Oqu(e.label),t.xp6(2),t.Gre("ion ",e.icon,"")}}function Nt(a,n){if(1&a&&(t.TgZ(0,"div",17),t._UZ(1,"i",18),t.TgZ(2,"div",19),t._uU(3),t.qZA()()),2&a){const e=t.oxw();t.xp6(3),t.hij(" ",e.initMsg,"")}}function Ot(a,n){if(1&a&&(t.TgZ(0,"option",23),t._uU(1),t.qZA()),2&a){const e=n.$implicit;t.s9C("value",e.id),t.xp6(1),t.hij(" ",e.name," ")}}function $t(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"div",9)(1,"div",10)(2,"label"),t._uU(3,"District"),t.qZA(),t.TgZ(4,"select",20),t.NdJ("change",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.generateSites())}),t._UZ(5,"option",21),t.YNc(6,Ot,2,2,"option",22),t.qZA()()()}if(2&a){const e=t.oxw();t.xp6(6),t.Q6J("ngForOf",e.Districts$)}}function It(a,n){if(1&a&&(t.TgZ(0,"option",23),t._uU(1),t.qZA()),2&a){const e=n.$implicit;t.s9C("value",e.id),t.xp6(1),t.hij(" ",e.name," ")}}function St(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"div",9)(1,"div",10)(2,"label"),t._uU(3,"Site"),t.qZA(),t.TgZ(4,"select",24),t.NdJ("change",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.generateZones())}),t._UZ(5,"option",21),t.YNc(6,It,2,2,"option",22),t.qZA()()()}if(2&a){const e=t.oxw();t.xp6(6),t.Q6J("ngForOf",e.sites$)}}function Jt(a,n){if(1&a&&(t.TgZ(0,"option",23),t._uU(1),t.qZA()),2&a){const e=n.$implicit;t.s9C("value",e.id),t.xp6(1),t.hij(" ",e.name," ")}}function Qt(a,n){if(1&a&&(t.TgZ(0,"div",9)(1,"div",10)(2,"label"),t._uU(3,"Zone"),t.qZA(),t.TgZ(4,"select",25),t._UZ(5,"option",21),t.YNc(6,Jt,2,2,"option",22),t.qZA()()()),2&a){const e=t.oxw();t.xp6(6),t.Q6J("ngForOf",e.zones$)}}function Mt(a,n){if(1&a&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.qZA(),t.TgZ(9,"td"),t._uU(10),t.qZA(),t.TgZ(11,"td"),t._uU(12),t.qZA(),t.TgZ(13,"td"),t._uU(14),t.qZA(),t.TgZ(15,"td"),t._uU(16),t.qZA(),t.TgZ(17,"td"),t._uU(18),t.qZA(),t.TgZ(19,"td"),t._uU(20),t.qZA()()),2&a){const e=n.$implicit;t.xp6(2),t.Oqu(e.family.name),t.xp6(2),t.Oqu(e.family.zone.name),t.xp6(2),t.Oqu(null!=e.chw?e.chw.external_id:""),t.xp6(2),t.Oqu(e.data.visit_in_day),t.xp6(2),t.Oqu(e.data.death),t.xp6(2),t.Oqu(e.data.child_visit),t.xp6(2),t.Oqu(e.data.women_visit),t.xp6(2),t.Oqu(e.data.home_visit),t.xp6(2),t.Oqu(e.data.all_visit),t.xp6(1),t.Tol(e.data.isVisited?"success0":"danger0"),t.xp6(1),t.hij(" ",e.data.isVisited?"":"Non "," Visit\xe9")}}function Yt(a,n){if(1&a&&(t.TgZ(0,"section",26)(1,"div",27)(2,"div",6)(3,"div",28),t._UZ(4,"table-export"),t.qZA()(),t.TgZ(5,"div",29)(6,"div",30),t._uU(7," Total Familles: "),t.TgZ(8,"strong",31),t._uU(9),t.qZA()(),t.TgZ(10,"div",32),t._uU(11," Total Familles Visit\xe9s: "),t.TgZ(12,"strong",33),t._uU(13),t.qZA()(),t.TgZ(14,"div",34),t._uU(15," Total Famille Non Visit\xe9s: "),t.TgZ(16,"strong",35),t._uU(17),t.qZA()()(),t.TgZ(18,"div",36)(19,"table",37)(20,"thead")(21,"tr",38)(22,"th",39),t._uU(23,"Famille"),t.qZA(),t.TgZ(24,"th",40),t._uU(25,"Zone"),t.qZA(),t.TgZ(26,"th",40),t._uU(27,"Code ASC"),t.qZA(),t.TgZ(28,"th",41),t._uU(29,"Visit 1/jour"),t.qZA(),t.TgZ(30,"th",42),t._uU(31,"#D\xe9ces"),t.qZA(),t.TgZ(32,"th",43),t._uU(33,"#Pcime"),t.qZA(),t.TgZ(34,"th",44),t._uU(35,"#Maternel_PF"),t.qZA(),t.TgZ(36,"th",45),t._uU(37,"#Recherche"),t.qZA(),t.TgZ(38,"th",46),t._uU(39,"#Action Total"),t.qZA(),t.TgZ(40,"th",47),t._uU(41,"#Type"),t.qZA()()(),t.TgZ(42,"tbody"),t.YNc(43,Mt,21,13,"tr",48),t.qZA()()()()()),2&a){const e=t.oxw();t.xp6(9),t.Oqu(e.ChwsDataInfos$.family_count),t.xp6(4),t.Oqu(e.ChwsDataInfos$.total_visited),t.xp6(4),t.Oqu(e.ChwsDataInfos$.total_not_visited),t.xp6(5),t.Q6J("appSort",e.ChwsDataInfos$.detail),t.xp6(2),t.Q6J("appSort",e.ChwsDataInfos$.detail),t.xp6(2),t.Q6J("appSort",e.ChwsDataInfos$.detail),t.xp6(2),t.Q6J("appSort",e.ChwsDataInfos$.detail),t.xp6(2),t.Q6J("appSort",e.ChwsDataInfos$.detail),t.xp6(2),t.Q6J("appSort",e.ChwsDataInfos$.detail),t.xp6(2),t.Q6J("appSort",e.ChwsDataInfos$.detail),t.xp6(2),t.Q6J("appSort",e.ChwsDataInfos$.detail),t.xp6(2),t.Q6J("appSort",e.ChwsDataInfos$.detail),t.xp6(2),t.Q6J("appSort",e.ChwsDataInfos$.detail),t.xp6(3),t.Q6J("ngForOf",e.ChwsDataInfos$.detail)}}const Lt=[{path:"",redirectTo:"dash1",pathMatch:"full"},{path:"dash1",component:G,canActivate:[D.a],data:{href:"dashboard1",icon:"fa fa-user",label:"Dashboard-1",title:"Dashboard-1"}},{path:"dash2",component:_t,canActivate:[D.a],data:{href:"dashboard2",icon:"fa fa-user",label:"Dashboard-2",title:"Dashboard-2"}},{path:"dash3",component:(()=>{class a{constructor(e,i,s,d){this.store=e,this.auth=i,this.db=s,this.sync=d,this.roles=new x.G(this.store),this.chwOU=null,this.allAggragateData=[],this.Districts$=[],this.Sites$=[],this.Chws$=[],this.Zones$=[],this.Patients$=[],this.Families$=[],this.chws$=[],this.sites$=[],this.districtsChwsCount=0,this.sitesChwsCount=0,this.zonesChwsCount=0,this.patientsChwsCount=0,this.patientsCibleChwsCount=0,this.familiesChwsCount=0,this.chwsCount=0,!this.roles.isSupervisorMentor()&&!this.roles.isChws()&&(location.href=this.auth.userValue()?.defaultRedirectUrl)}createDataFilterFormGroup(){return new l.cw({districts:new l.NI("",this.roles.isChws()?[]:[l.kI.required]),sites:new l.NI("",this.roles.isChws()?[]:[l.kI.required]),chws:new l.NI("")})}identifyAggragateData(e,i){return i.label}ngOnInit(){this.chwOU=this.auth.chwsOrgUnit(),this.roles.isChws()&&(null==this.chwOU||!(0,o.Nf)(this.chwOU))&&(location.href="chws/select_orgunit"),this.isLoading=!1,this.aggradateDataForm=this.createDataFilterFormGroup(),this.roles.isChws()?this.initAllData(!1):this.initAllData(!0)}initAllData(e=!1){var i=this;return(0,g.Z)(function*(){i.isLoading=!0;const s=i.ParamsToFilter();i.initMsg="Chargement des Districts ...",i.sync.getDistrictsList(s).subscribe(function(){var d=(0,g.Z)(function*(r){200==r.status&&(i.Districts$=r.data),i.initMsg="Chargement des Sites ...",i.sync.getSitesList(s).subscribe(function(){var c=(0,g.Z)(function*(p){200==p.status&&(i.Sites$=p.data),i.initMsg="Chargement des ASC ...",i.sync.getChwsList(s).subscribe(function(){var _=(0,g.Z)(function*(Z){200==Z.status&&(i.Chws$=Z.data),0==e?(i.initMsg="Chargement des Zones ...",i.sync.getZonesList(s).subscribe(function(){var w=(0,g.Z)(function*(v){200==v.status&&(i.Zones$=v.data),i.initMsg="Chargement des Familles ...",i.sync.getFamilyList(s).subscribe(function(){var C=(0,g.Z)(function*(b){200==b.status&&(i.Families$=b.data),i.initMsg="Chargement des Patients ...",i.sync.getPatientsList(s).subscribe(function(){var u=(0,g.Z)(function*(h){200==h.status&&(i.Patients$=h.data),i.initDataFilted(s)});return function(h){return u.apply(this,arguments)}}(),u=>{i.isLoading=!1,console.log(u)})});return function(b){return C.apply(this,arguments)}}(),C=>{i.isLoading=!1,console.log(C.error)})});return function(v){return w.apply(this,arguments)}}(),w=>{i.isLoading=!1,console.log(w.error)})):i.isLoading=!1});return function(Z){return _.apply(this,arguments)}}(),_=>{i.isLoading=!1,console.log(_.error)})});return function(p){return c.apply(this,arguments)}}(),c=>{i.isLoading=!1,console.log(c.error)})});return function(r){return d.apply(this,arguments)}}(),d=>{i.isLoading=!1,console.log(d.error)})})()}formatHostName(e){return e.replace(".org","").replace("-",".").trim()}genarateSites(){this.sites$=[],this.chws$=[];const e=o.FI.returnEmptyArrayIfNul(this.aggradateDataForm.value.districts);if(this.aggradateDataForm.value.sites="",this.aggradateDataForm.value.chws=[],(0,o.Nf)(e))for(let i=0;i<this.Sites$.length;i++){const s=this.Sites$[i];(0,o.Nf)(s)&&e.includes(s.district.id)&&this.sites$.push(s)}else this.sites$=[]}genarateChws(){const e=o.FI.returnEmptyArrayIfNul(this.aggradateDataForm.value.sites);if(this.chws$=[],this.aggradateDataForm.value.chws=[],(0,o.Nf)(e))for(let i=0;i<this.Chws$.length;i++){const s=this.Chws$[i];(0,o.Nf)(s)&&e.includes(s.site.id)&&this.chws$.push(s)}else this.chws$=[]}ParamsToFilter(){var e=[],i=[],s=[];return this.roles.isChws()?null!=this.chwOU&&(0,o.Nf)(this.chwOU)&&(e=o.FI.returnDataAsArray(this.chwOU.site.district.id),i=o.FI.returnDataAsArray(this.chwOU.site.id),s=o.FI.returnDataAsArray(this.chwOU.id)):(e=o.FI.returnEmptyArrayIfNul(this.aggradateDataForm.value.districts),i=o.FI.returnEmptyArrayIfNul(this.aggradateDataForm.value.sites),s=o.FI.returnEmptyArrayIfNul(this.aggradateDataForm.value.chws)),{districts:e,sites:i,chws:s,withDhis2Data:!1}}initDataFilted(e){this.isLoading=!0;const{chws:d,sites:r,districts:c}=e??this.ParamsToFilter();if(this.districtsChwsCount=0,this.sitesChwsCount=0,this.familiesChwsCount=0,this.patientsChwsCount=0,this.patientsCibleChwsCount=0,this.zonesChwsCount=0,this.chwsCount=0,this.allAggragateData=[],!this.roles.isChws()){for(let u=0;u<this.Districts$.length;u++){const h=this.Districts$[u];(0,o.Nf)(c)?c?.includes(h.id)&&this.districtsChwsCount++:this.districtsChwsCount++}for(let u=0;u<this.Sites$.length;u++){const h=this.Sites$[u];(0,o.Nf)(c)&&(0,o.Nf)(r)?c?.includes(h.district.id)&&r?.includes(h.id)&&this.sitesChwsCount++:(0,o.Nf)(c)&&!(0,o.Nf)(r)?c?.includes(h.district.id)&&this.sitesChwsCount++:this.sitesChwsCount++}for(let u=0;u<this.Zones$.length;u++){const h=this.Zones$[u];(0,o.Nf)(c)&&(0,o.Nf)(r)&&(0,o.Nf)(d)?c?.includes(h.site.district.id)&&r?.includes(h.site.id)&&d?.includes(h.chw_id)&&this.zonesChwsCount++:(0,o.Nf)(c)&&(0,o.Nf)(r)&&!(0,o.Nf)(d)?c?.includes(h.site.district.id)&&r?.includes(h.site.id)&&this.zonesChwsCount++:(!(0,o.Nf)(c)||(0,o.Nf)(r)||(0,o.Nf)(d)||c?.includes(h.site.district.id))&&this.zonesChwsCount++}for(let u=0;u<this.Chws$.length;u++){const h=this.Chws$[u];(0,o.Nf)(c)&&(0,o.Nf)(r)&&(0,o.Nf)(d)?c?.includes(h.site.district.id)&&r?.includes(h.site.id)&&d?.includes(h.zone.chw_id)&&this.chwsCount++:(0,o.Nf)(c)&&(0,o.Nf)(r)&&!(0,o.Nf)(d)?c?.includes(h.site.district.id)&&r?.includes(h.site.id)&&this.chwsCount++:(!(0,o.Nf)(c)||(0,o.Nf)(r)||(0,o.Nf)(d)||c?.includes(h.site.district.id))&&this.chwsCount++}}for(let u=0;u<this.Families$.length;u++){const h=this.Families$[u];(0,o.Nf)(c)&&(0,o.Nf)(r)&&(0,o.Nf)(d)?c?.includes(h.site.district.id)&&r?.includes(h.site.id)&&d?.includes(h.zone.chw_id)&&this.familiesChwsCount++:(0,o.Nf)(c)&&(0,o.Nf)(r)&&!(0,o.Nf)(d)?c?.includes(h.site.district.id)&&r?.includes(h.site.id)&&this.familiesChwsCount++:(!(0,o.Nf)(c)||(0,o.Nf)(r)||(0,o.Nf)(d)||c?.includes(h.site.district.id))&&this.familiesChwsCount++}for(let u=0;u<this.Patients$.length;u++){const h=this.Patients$[u],F=(0,o.mP)(h).is_in_cible;(0,o.Nf)(c)&&(0,o.Nf)(r)&&(0,o.Nf)(d)?c?.includes(h.site.district.id)&&r?.includes(h.site.id)&&d?.includes(h.zone.chw_id)&&(this.patientsChwsCount++,F&&this.patientsCibleChwsCount++):(0,o.Nf)(c)&&(0,o.Nf)(r)&&!(0,o.Nf)(d)?c?.includes(h.site.district.id)&&r?.includes(h.site.id)&&(this.patientsChwsCount++,F&&this.patientsCibleChwsCount++):(!(0,o.Nf)(c)||(0,o.Nf)(r)||(0,o.Nf)(d)||c?.includes(h.site.district.id))&&(this.patientsChwsCount++,F&&this.patientsCibleChwsCount++)}let p={label:o.FI.capitaliseDataGiven("total_district_enregistre","_"," "),count:this.districtsChwsCount,icon:"ion-stats-bars",color:"bg-info",detailUrl:"/dashboards/dash1"},_={label:o.FI.capitaliseDataGiven("total_site_enregistre","_"," "),count:this.sitesChwsCount,icon:"ion-stats-bars",color:"bg-info",detailUrl:"/dashboards/dash1"},Z={label:o.FI.capitaliseDataGiven("total_ASC_enregistre","_"," "),count:this.chwsCount,icon:"ion-pie-graph",color:"bg-primary",detailUrl:"/dashboards/dash1"},w={label:o.FI.capitaliseDataGiven("total_zone_enregistre","_"," "),count:this.zonesChwsCount,icon:"ion-pie-graph",color:"bg-primary",detailUrl:"/dashboards/dash1"},v={label:o.FI.capitaliseDataGiven("total_famille_enregistre","_"," "),count:this.familiesChwsCount,icon:"ion-person-add",color:"bg-danger",detailUrl:"/dashboards/dash1"},C={label:o.FI.capitaliseDataGiven("total_patient_enregistre","_"," "),count:this.patientsChwsCount,icon:"ion-person-add",color:"bg-success",detailUrl:"/dashboards/dash1"},b={label:o.FI.capitaliseDataGiven("total_patient_cible","_"," "),count:this.patientsCibleChwsCount,icon:"ion-person-add",color:"bg-warning",detailUrl:"/dashboards/dash1"};this.roles.isChws()||this.allAggragateData.push(p),this.roles.isChws()||this.allAggragateData.push(_),this.roles.isChws()||this.allAggragateData.push(Z),this.roles.isChws()||this.allAggragateData.push(w),this.allAggragateData.push(v),this.allAggragateData.push(C),this.allAggragateData.push(b),this.initMsg="",this.isLoading=!1}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(T.u),t.Y36(A.e),t.Y36(mt.p),t.Y36(U._))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-dashboard-3"]],decls:12,vars:4,consts:[[1,"content-header"],[1,"container-fluid"],[1,"card","card-warning"],[2,"text-align","center"],[1,"overlay-wrapper"],["class","overlay",4,"ngIf"],["class","card-header",4,"ngIf"],[1,"row","card-body"],["class","col-sm-3 col-6",4,"ngFor","ngForOf","ngForTrackBy"],[1,"overlay"],[1,"fas","fa-3x","fa-sync-alt","fa-spin"],[1,"text-bold","pt-2"],[1,"card-header"],["novalidate","",3,"formGroup","ngSubmit"],[1,"row"],[1,"col-sm-2","col-6"],[1,"form-group"],["class","form-control","multiple","multiple","formControlName","districts",3,"change",4,"ngIf"],["class","form-control",4,"ngIf"],["class","form-control","multiple","multiple","formControlName","sites",3,"change","click",4,"ngIf"],[1,"col-sm-3","col-6"],["class","form-control","multiple","multiple","formControlName","chws",4,"ngIf"],[1,"col-sm-1","col-6"],["type","submit",1,"btn","btn-warning","form-control",3,"disabled"],[1,"nav-icon","fas","fa-search"],["multiple","multiple","formControlName","districts",1,"form-control",3,"change"],["value",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"form-control"],["multiple","multiple","formControlName","sites",1,"form-control",3,"change","click"],["multiple","multiple","formControlName","chws",1,"form-control"],[1,"inner"],[2,"font-size","40px"],[1,"icon"]],template:function(e,i){1&e&&(t.TgZ(0,"section",0)(1,"div",1)(2,"div",2)(3,"h1",3),t._uU(4,"Effectifs des patients"),t.qZA(),t.TgZ(5,"div",4),t.YNc(6,Zt,4,1,"div",5),t.YNc(7,Ft,27,8,"div",6),t.qZA()(),t.TgZ(8,"div",7),t.YNc(9,qt,10,8,"div",8),t.qZA(),t._UZ(10,"br")(11,"br"),t.qZA()()),2&e&&(t.xp6(6),t.Q6J("ngIf",i.isLoading),t.xp6(1),t.Q6J("ngIf",!i.roles.isChws()),t.xp6(2),t.Q6J("ngForOf",i.allAggragateData)("ngForTrackBy",i.identifyAggragateData))},dependencies:[m.sg,m.O5,l._Y,l.YN,l.Kr,l.K7,l.JJ,l.JL,l.sg,l.u],encapsulation:2}),a})(),canActivate:[D.a],data:{href:"dashboard3",icon:"fa fa-user",label:"Dashboard-3",title:"Dashboard-3"}},{path:"dash4",component:(()=>{class a{constructor(e,i,s){this.store=e,this.auth=i,this.sync=s,this.roles=new x.G(this.store),this.Districts$=[],this.Zones$=[],this.Sites$=[],this.zones$=[],this.sites$=[],this.responseMessage="",this.chwOU=null,!this.roles.isSupervisorMentor()&&!this.roles.isChws()&&(location.href=this.auth.userValue()?.defaultRedirectUrl)}createDataFilterFormGroup(){return new l.cw({start_date:new l.NI(this.initDate.start_date,[l.kI.required,l.kI.minLength(7)]),end_date:new l.NI(this.initDate.end_date,[l.kI.required,l.kI.minLength(7)]),districts:new l.NI("",[l.kI.required]),sites:new l.NI(""),zones:new l.NI("")})}ngOnInit(){this.chwOU=this.auth.chwsOrgUnit(),this.roles.isChws()&&(null==this.chwOU||!(0,o.Nf)(this.chwOU))&&(location.href="chws/select_orgunit"),this.isLoading=!1,this.initDate=o.ED.startEnd21and20Date(),this.aggradateDataForm=this.createDataFilterFormGroup(),this.roles.isChws()?this.initDataFilted():this.initAllData()}initAllData(){var e=this;return(0,g.Z)(function*(){e.isLoading=!0,e.initMsg="Chargement des Districts ...",e.sync.getDistrictsList().subscribe(function(){var i=(0,g.Z)(function*(s){200==s.status&&(e.Districts$=s.data),e.initMsg="Chargement des Sites ...",e.sync.getSitesList().subscribe(function(){var d=(0,g.Z)(function*(r){200==r.status&&(e.Sites$=r.data),e.initMsg="Chargement des Zones ...",e.sync.getZonesList().subscribe(function(){var c=(0,g.Z)(function*(p){200==p.status&&(e.Zones$=p.data),e.isLoading=!1,e.initMsg=""});return function(p){return c.apply(this,arguments)}}(),c=>{e.isLoading=!1,console.log(c.error)})});return function(r){return d.apply(this,arguments)}}(),d=>{e.isLoading=!1,console.log(d.error)})});return function(s){return i.apply(this,arguments)}}(),i=>{e.isLoading=!1,console.log(i.error)})})()}generateSites(){this.sites$=[],this.zones$=[];const e=this.aggradateDataForm.value.districts;if(this.aggradateDataForm.value.sites="",this.aggradateDataForm.value.zones=[],(0,o.Nf)(e))for(let i=0;i<this.Sites$.length;i++){const s=this.Sites$[i];(0,o.Nf)(s)&&e.includes(s.district.id)&&this.sites$.push(s)}else this.sites$=[]}generateZones(){const e=o.FI.returnDataAsArray(this.aggradateDataForm.value.sites);if(this.zones$=[],this.aggradateDataForm.value.zones=[],(0,o.Nf)(e))for(let i=0;i<this.Zones$.length;i++){const s=this.Zones$[i];(0,o.Nf)(s)&&e.includes(s.site.id)&&this.zones$.push(s)}else this.zones$=[]}ParamsToFilter(){const e=this.aggradateDataForm.value.start_date,i=this.aggradateDataForm.value.end_date;var s=[],d=[],r=[];return this.roles.isChws()?null!=this.chwOU&&(0,o.Nf)(this.chwOU)&&(s=o.FI.returnDataAsArray(this.chwOU.site.district.id),d=o.FI.returnDataAsArray(this.chwOU.site.id),r=o.FI.returnDataAsArray(this.chwOU.zone.id)):(s=o.FI.returnDataAsArray(this.aggradateDataForm.value.districts),d=o.FI.returnDataAsArray(this.aggradateDataForm.value.sites),r=o.FI.returnDataAsArray(this.aggradateDataForm.value.zones)),{start_date:e,end_date:i,districts:s,sites:d,zones:r,withDhis2Data:!1}}initDataFilted(e){this.initMsg="Loading Data ...",this.isLoading=!0,this.ChwsDataInfos$=void 0,this.sync.getDataInformations(e??this.ParamsToFilter()).subscribe(i=>{200==i.status?this.ChwsDataInfos$=i.data:this.responseMessage=i.data,this.isLoading=!1},i=>{this.isLoading=!1,console.log(i)})}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(T.u),t.Y36(A.e),t.Y36(U._))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-dashboard-4"]],decls:31,vars:7,consts:[[1,"content-header"],[1,"container-fluid"],[1,"card","card-info"],[2,"text-align","center"],[1,"overlay-wrapper"],["class","overlay",4,"ngIf"],[1,"card-header"],["novalidate","",3,"formGroup","ngSubmit"],[1,"row"],[1,"col-sm-2","col-6"],[1,"form-group"],["type","date","formControlName","start_date",1,"form-control"],["type","date","formControlName","end_date",1,"form-control"],["class","col-sm-2 col-6",4,"ngIf"],["type","submit",1,"btn","btn-warning","form-control",3,"disabled"],[1,"fa","fa-floppy-o","fa-right"],["class","content",4,"ngIf"],[1,"overlay"],[1,"fas","fa-3x","fa-sync-alt","fa-spin"],[1,"text-bold","pt-2"],["formControlName","districts",1,"form-control",3,"change"],["value",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["formControlName","sites",1,"form-control",3,"change"],["formControlName","zones",1,"form-control"],[1,"content"],[1,"card",2,"overflow-y","scroll!important"],[1,"card-title"],[1,"row",2,"margin-top","15px","padding","0px 40px"],[1,"col-sm-4","col-12",2,"font-weight","bold","padding","10px 20px","background-color","rgb(233, 189, 131)"],[2,"font-size","20px"],[1,"col-sm-4","col-12",2,"font-weight","bold","padding","10px 20px","background-color","antiquewhite"],[2,"font-size","16px"],[1,"col-sm-4","col-12",2,"font-weight","bold","padding","10px 20px","background-color","rgb(218, 177, 235)"],[2,"font-size","18px"],[1,"card-body"],["border","1 solid","id","export_table",1,"table","table-bordered"],[1,"bg-info"],["data-order","desc","data-name","family.name",2,"width","50px",3,"appSort"],["data-order","desc","data-name","family.zone.name",2,"width","150px",3,"appSort"],["data-order","desc","data-name","data.visit_in_day",2,"width","40px",3,"appSort"],["data-order","desc","data-name","data.death",2,"width","40px",3,"appSort"],["data-order","desc","data-name","data.child_visit",2,"width","40px",3,"appSort"],["data-order","desc","data-name","data.women_visit",2,"width","40px",3,"appSort"],["data-order","desc","data-name","data.home_visit",2,"width","40px",3,"appSort"],["data-order","desc","data-name","data.all_visit",2,"width","40px",3,"appSort"],["data-order","desc","data-name","data.isVisited",2,"width","40px",3,"appSort"],[4,"ngFor","ngForOf"]],template:function(e,i){1&e&&(t.TgZ(0,"section",0)(1,"div",1)(2,"div",2)(3,"h1",3),t._uU(4,"D\xe9tails Visite M\xe9nages"),t.qZA(),t.TgZ(5,"div",4),t.YNc(6,Nt,4,1,"div",5),t.TgZ(7,"div",6)(8,"form",7),t.NdJ("ngSubmit",function(){return i.initDataFilted()}),t.TgZ(9,"div",8)(10,"div",9)(11,"div",10)(12,"label"),t._uU(13,"Date D\xe9but"),t.qZA(),t._UZ(14,"input",11),t.qZA()(),t.TgZ(15,"div",9)(16,"div",10)(17,"label"),t._uU(18,"Date Fin"),t.qZA(),t._UZ(19,"input",12),t.qZA()(),t.YNc(20,$t,7,1,"div",13),t.YNc(21,St,7,1,"div",13),t.YNc(22,Qt,7,1,"div",13),t.TgZ(23,"div",9)(24,"div",10)(25,"label"),t._uU(26,"."),t.qZA(),t.TgZ(27,"button",14),t._uU(28," OK "),t._UZ(29,"span",15),t.qZA()()()()()()()()()(),t.YNc(30,Yt,44,14,"section",16)),2&e&&(t.xp6(6),t.Q6J("ngIf",i.isLoading),t.xp6(2),t.Q6J("formGroup",i.aggradateDataForm),t.xp6(12),t.Q6J("ngIf",!i.roles.isChws()),t.xp6(1),t.Q6J("ngIf",!i.roles.isChws()),t.xp6(1),t.Q6J("ngIf",!i.roles.isChws()),t.xp6(5),t.Q6J("disabled",!i.aggradateDataForm.valid),t.xp6(3),t.Q6J("ngIf",null!=i.ChwsDataInfos$&&null!=i.ChwsDataInfos$&&i.roles.isSupervisorMentor()))},dependencies:[m.sg,m.O5,l._Y,l.YN,l.Kr,l.Fj,l.EJ,l.JJ,l.JL,l.sg,l.u,N,O],styles:[".info[_ngcontent-%COMP%]{color:#00f;font-weight:bolder}.warning[_ngcontent-%COMP%]{color:orange;font-size:large;font-weight:bolder}.primary[_ngcontent-%COMP%]{color:purple;font-size:large;font-weight:bolder}.secondary[_ngcontent-%COMP%]{color:#09e4bf;font-size:large;font-weight:bolder}.success[_ngcontent-%COMP%]{color:green;font-size:large;font-weight:bolder}.success0[_ngcontent-%COMP%]{color:green;font-weight:bolder}.danger[_ngcontent-%COMP%]{color:red;font-size:large;font-weight:bolder}.danger0[_ngcontent-%COMP%]{color:red;font-weight:bolder}.line[_ngcontent-%COMP%]{color:#000;font-size:large;font-weight:bolder}"]}),a})(),canActivate:[D.a],data:{href:"dashboard4",icon:"fa fa-user",label:"Dashboard-4",title:"Dashboard-4"}}];let Pt=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[y.Bz.forChild(Lt),y.Bz]}),a})(),zt=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[m.ez,l.UX,Pt]}),a})()}}]);