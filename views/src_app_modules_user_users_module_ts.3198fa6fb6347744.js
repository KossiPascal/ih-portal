"use strict";(self.webpackChunkih_portal=self.webpackChunkih_portal||[]).push([["src_app_modules_user_users_module_ts"],{9460:(O,p,a)=>{a.r(p),a.d(p,{UsersModule:()=>I});var m=a(8692),c=a(3580),f=a(8239),i=a(92),h=a(5128),g=a(8629),d=a(574),e=a(4537),Z=a(1383),U=a(7556),v=a(1815);function _(s,r){if(1&s){const t=e.EpF();e.TgZ(0,"tbody")(1,"tr")(2,"td"),e._uU(3),e.qZA(),e.TgZ(4,"td"),e._uU(5),e.qZA(),e.TgZ(6,"td"),e._uU(7),e.qZA(),e.TgZ(8,"td"),e._uU(9),e.qZA(),e.TgZ(10,"td"),e._uU(11),e.qZA(),e.TgZ(12,"td"),e._uU(13),e.qZA(),e.TgZ(14,"td")(15,"i",51),e.NdJ("click",function(){const l=e.CHM(t).$implicit,u=e.oxw();return e.KtG(u.EditUser(l))}),e.qZA()(),e.TgZ(16,"td")(17,"i",52),e.NdJ("click",function(){const l=e.CHM(t).$implicit,u=e.oxw();return e.KtG(u.UserSelected(l))}),e.qZA()(),e.TgZ(18,"td")(19,"span",53),e._uU(20),e.qZA()(),e.TgZ(21,"td")(22,"span",53),e._uU(23),e.qZA()()()()}if(2&s){const t=r.$implicit,o=r.index;e.xp6(3),e.Oqu(t.id),e.xp6(2),e.Oqu(o+1),e.xp6(2),e.Oqu(t.username),e.xp6(2),e.Oqu(t.fullname),e.xp6(2),e.Oqu(t.email),e.xp6(2),e.Oqu(t.roles),e.xp6(7),e.Oqu(t.isActive?"":"\u2713"),e.xp6(3),e.Oqu(t.isSuperAdmin?"\u2713":"")}}function T(s,r){1&s&&(e.TgZ(0,"label",54),e._uU(1,"Username"),e.qZA())}function A(s,r){1&s&&(e.TgZ(0,"label",55),e._uU(1,"Full Name"),e.qZA())}function b(s,r){1&s&&(e.TgZ(0,"label",56),e._uU(1,"R\xf4les"),e.qZA())}function q(s,r){if(1&s&&(e.TgZ(0,"option",57),e._uU(1),e.qZA()),2&s){const t=r.$implicit;e.s9C("value",t.id),e.xp6(1),e.hij(" ",t.name," ")}}function C(s,r){1&s&&(e.TgZ(0,"label",56),e._uU(1,"Groupes"),e.qZA())}function M(s,r){if(1&s&&(e.TgZ(0,"option",57),e._uU(1),e.qZA()),2&s){const t=r.$implicit;e.s9C("value",t.id),e.xp6(1),e.hij(" ",t.name," ")}}function y(s,r){1&s&&(e.TgZ(0,"label",56),e._uU(1,"Mettingteam"),e.qZA())}function F(s,r){if(1&s&&(e.TgZ(0,"option",57),e._uU(1),e.qZA()),2&s){const t=r.$implicit;e.s9C("value",t.id),e.xp6(1),e.hij(" ",t.name," ")}}const N=[{path:"",component:(()=>{class s{constructor(t,o,n,l){this.store=t,this.auth=o,this.sync=n,this.router=l,this.users$=[],this.roles$=(0,d.vE)(),this.groups$=(0,d._)(),this.isLoginForm=!1,this.isLoading=!1,this.LoadingMsg="Loading...",this.isEditMode=!1,this.message="",this.APP_LOGO=h.z.APP_LOGO,this.roles=new d.G7(this.store),this.roles.isSuperUser()||(location.href=this.auth.userValue()?.defaultRedirectUrl??"")}activeSave(){throw new Error("Method not implemented.")}ngOnInit(){this.getUsers(),this.GetTeams(),this.userForm=this.createFormGroup()}GetTeams(){var t=this;this.sync.GetTeams().subscribe(function(){var o=(0,f.Z)(function*(n){200==n.status&&(t.MeetingReport$=n.data.sort((l,u)=>l.name.localeCompare(u.name)))});return function(n){return o.apply(this,arguments)}}(),o=>{})}getUsers(){this.auth.getAllUsers().subscribe(t=>{if(200===t.status){this.users$=[];const o=t.data;for(let n=0;n<o.length;n++){const l=o[n];l.isSuperAdmin=l.roles.includes((0,d.i4)().SuperUser.id),this.users$.push(l)}}else console.log(t.data)},t=>{console.log(t.error)})}EditUser(t){this.isEditMode=!0,t.roles=t.roles.toString().replace("[","").replace("]","").split(","),t.groups=t.groups.toString().replace("[","").replace("]","").split(","),this.userForm=this.createFormGroup(t),this.UserSelected(t)}UserSelected(t){this.selectedUser=t}DeleteUser(){this.isEditMode=!1,this.selectedUser&&this.auth.deleteUser(this.selectedUser).subscribe(t=>{200===t.status?(this.showModalToast("success","Supprim\xe9 avec success"),console.log("successfully deleted!"),this.getUsers(),this.selectedUser=null,this.isLoading=!1):this.message=t.data,console.log(this.message)},t=>{this.message=t,this.isLoading=!1,console.log(this.message)})}CreateUser(){this.isEditMode=!1,this.userForm=this.createFormGroup(),this.selectedUser=null}createFormGroup(t){return new i.cw({username:new i.NI(null!=t?t.username:"",[i.kI.required,i.kI.minLength(4)]),fullname:new i.NI(null!=t?t.fullname:"",[i.kI.required,i.kI.minLength(4)]),roles:new i.NI(null!=t?t.roles:"",[i.kI.required,i.kI.minLength(1)]),groups:new i.NI(null!=t?t.groups:"",[i.kI.required,i.kI.minLength(1)]),meeting_report:new i.NI(null!=t?t.meeting_report:"",[i.kI.required,i.kI.minLength(1)]),isActive:new i.NI(null!=t&&t.isActive)},[this.MatchValidator("password","passwordConfirm")])}passwordMatchError(){return this.userForm.getError("password")&&this.userForm.get("passwordConfirm")?.touched}showModalToast(t,o){showToast(t,o),this.closeModal("close-delete-modal")}closeModal(t="close-modal"){$("#"+t).trigger("click")}MatchValidator(t,o){return n=>{const l=n.get(t),u=n.get(o);if(l&&u){if(l.value!==u.value)return{mismatch:!0};if(this.isEditMode&&((0,g.Nf)(l.value)&&l.value.length<8||(0,g.Nf)(u.value)&&u.value.length<8))return{mismatch:!0}}return null}}register(){var t;if(this.auth.isLoggedIn()){if(this.isEditMode?this.selectedUser&&(this.selectedUser.groups=this.userForm.value.groups,this.selectedUser.roles=this.userForm.value.roles,this.selectedUser.meeting_report=this.userForm.value.meeting_report,t=this.auth.updateUser(this.selectedUser)):t=this.auth.register(this.userForm.value),t)return t.subscribe(o=>{200===o.status?(this.message="Registed successfully !",this.closeModal(),console.log("successfully !"),this.getUsers()):this.message=o.data,console.log(this.message),this.isLoading=!1},o=>{this.isLoading=!1})}else this.auth.logout()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Z.u),e.Y36(U.e),e.Y36(v._),e.Y36(c.F0))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-user"]],decls:114,vars:22,consts:[[1,"page-title","card","card-primary","card-outline"],[1,"card-body"],[1,"fas","fa-user",2,"float","left"],["type","button","data-toggle","modal","data-target","#modal-default",1,"btn","btn-default",2,"float","right",3,"click"],[1,"page-content-wrap"],[1,"row"],[1,"col-md-12"],[1,"panel","panel-default"],[1,"panel-heading"],[1,"panel-body"],[1,"table","datatable"],["colspan","2"],[4,"ngFor","ngForOf"],["id","modal-default",1,"modal","fade"],[1,"modal-dialog"],["novalidate","",1,"form-horizontal",3,"formGroup","ngSubmit"],[1,"modal-content"],[1,"modal-header"],["height","30","alt","","srcset","",1,"modal-title",3,"src"],[1,"login-box-msg",2,"text-align","center"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body"],[1,"login-box-msg"],["for","username",4,"ngIf"],[1,"input-group","mb-3"],["id","username","type","text","placeholder","Username","formControlName","username",1,"form-control"],[1,"input-group-append"],[1,"input-group-text"],[1,"fas","fa-user"],["for","fullname",4,"ngIf"],["id","fullname","type","text","placeholder","Full Name","formControlName","fullname",1,"form-control"],["for","",4,"ngIf"],["multiple","multiple","formControlName","roles",1,"form-control"],[3,"value",4,"ngFor","ngForOf"],[1,"fas","fa-lock"],["multiple","multiple","formControlName","groups",1,"form-control"],["multiple","multiple","formControlName","meeting_report",1,"form-control"],[1,"col-6"],[1,"icheck-primary"],["type","checkbox","id","isActive","formControlName","isActive"],["for","isActive"],[1,"modal-footer","justify-content-between"],["id","close-modal","type","button","data-dismiss","modal",1,"btn","btn-default"],["type","submit",3,"disabled"],["id","modal-danger",1,"modal","fade"],[1,"modal-content","bg-danger"],[1,"modal-title"],["id","close-delete-modal","type","button","data-dismiss","modal","aria-label","Close",1,"close"],["type","button","data-dismiss","modal",1,"btn","btn-default"],["type","button",1,"btn","btn-danger","swalDefaultSuccess",3,"click"],["data-toggle","modal","data-target","#modal-default",1,"btn-warning","fas","fa-edit",3,"click"],["data-toggle","modal","data-target","#modal-danger",1,"btn-danger","fas","fa-trash-alt",3,"click"],[2,"font-size","20px"],["for","username"],["for","fullname"],["for",""],[3,"value"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"span",2),e._uU(3," Users List"),e.qZA(),e.TgZ(4,"button",3),e.NdJ("click",function(){return o.CreateUser()}),e._uU(5," Add User "),e.qZA()()(),e.TgZ(6,"div",4)(7,"div",5)(8,"div",6)(9,"div",7),e._UZ(10,"div",8),e.TgZ(11,"div",9)(12,"table",10)(13,"thead")(14,"tr")(15,"th"),e._uU(16,"id"),e.qZA(),e.TgZ(17,"th"),e._uU(18,"N\xb0"),e.qZA(),e.TgZ(19,"th"),e._uU(20,"Username"),e.qZA(),e.TgZ(21,"th"),e._uU(22,"Full name"),e.qZA(),e.TgZ(23,"th"),e._uU(24,"Email"),e.qZA(),e.TgZ(25,"th"),e._uU(26,"Role"),e.qZA(),e.TgZ(27,"th",11),e._uU(28,"Actions"),e.qZA(),e.TgZ(29,"th"),e._uU(30,"InActifs"),e.qZA(),e.TgZ(31,"th"),e._uU(32,"IsSuperAdmin"),e.qZA()()(),e.YNc(33,_,24,8,"tbody",12),e.qZA()()()()()(),e.TgZ(34,"div",13)(35,"div",14)(36,"form",15),e.NdJ("ngSubmit",function(){return o.register()}),e.TgZ(37,"div",16)(38,"div",17),e._UZ(39,"img",18),e.TgZ(40,"strong",19)(41,"span"),e._uU(42),e.qZA()(),e.TgZ(43,"button",20)(44,"span",21),e._uU(45,"\xd7"),e.qZA()()(),e.TgZ(46,"div",22)(47,"p",23)(48,"strong"),e._uU(49),e.qZA()(),e.YNc(50,T,2,0,"label",24),e.TgZ(51,"div",25),e._UZ(52,"input",26),e.TgZ(53,"div",27)(54,"div",28),e._UZ(55,"span",29),e.qZA()()(),e.YNc(56,A,2,0,"label",30),e.TgZ(57,"div",25),e._UZ(58,"input",31),e.TgZ(59,"div",27)(60,"div",28),e._UZ(61,"span",29),e.qZA()()(),e.YNc(62,b,2,0,"label",32),e.TgZ(63,"div",25)(64,"select",33),e.YNc(65,q,2,2,"option",34),e.qZA(),e.TgZ(66,"div",27)(67,"div",28),e._UZ(68,"span",35),e.qZA()()(),e.YNc(69,C,2,0,"label",32),e.TgZ(70,"div",25)(71,"select",36),e.YNc(72,M,2,2,"option",34),e.qZA(),e.TgZ(73,"div",27)(74,"div",28),e._UZ(75,"span",35),e.qZA()()(),e.YNc(76,y,2,0,"label",32),e.TgZ(77,"div",25)(78,"select",37),e.YNc(79,F,2,2,"option",34),e.qZA(),e.TgZ(80,"div",27)(81,"div",28),e._UZ(82,"span",35),e.qZA()()(),e.TgZ(83,"div",5)(84,"div",38)(85,"div",25)(86,"div",39),e._UZ(87,"input",40),e.TgZ(88,"label",41),e._uU(89,"Activer"),e.qZA()()()()()(),e.TgZ(90,"div",42)(91,"button",43),e._uU(92,"Close"),e.qZA(),e.TgZ(93,"button",44),e._uU(94),e.qZA()()()()()(),e.TgZ(95,"div",45)(96,"div",14)(97,"div",46)(98,"div",17)(99,"h4",47),e._uU(100,"Suppression d'utilisateur"),e.qZA(),e.TgZ(101,"button",48)(102,"span",21),e._uU(103,"\xd7"),e.qZA()()(),e.TgZ(104,"div",22),e._uU(105," Cette action est ir\xe9versible! \xcates vous s\xfbr de proc\xe9der \xe0 la suppression ? "),e.TgZ(106,"p",23)(107,"strong"),e._uU(108),e.qZA()()(),e.TgZ(109,"div",42)(110,"button",49),e._uU(111,"Annuler"),e.qZA(),e.TgZ(112,"button",50),e.NdJ("click",function(){return o.DeleteUser()}),e._uU(113,"Oui Supprimer !"),e.qZA()()()()()),2&t&&(e.xp6(33),e.Q6J("ngForOf",o.users$),e.xp6(3),e.Q6J("formGroup",o.userForm),e.xp6(3),e.s9C("src",o.APP_LOGO,e.LSH),e.xp6(2),e.Gre(" btn-",o.isEditMode?"warning":"success",""),e.xp6(1),e.Oqu(o.isEditMode?"Modifier un utilisateur":"Ajouter un utilisateur"),e.xp6(7),e.Oqu(o.message),e.xp6(1),e.Q6J("ngIf",o.isEditMode),e.xp6(6),e.Q6J("ngIf",o.isEditMode),e.xp6(6),e.Q6J("ngIf",o.isEditMode),e.xp6(3),e.Q6J("ngForOf",o.roles$),e.xp6(4),e.Q6J("ngIf",o.isEditMode),e.xp6(3),e.Q6J("ngForOf",o.groups$),e.xp6(4),e.Q6J("ngIf",o.isEditMode),e.xp6(3),e.Q6J("ngForOf",o.MeetingReport$),e.xp6(14),e.Gre("btn btn-",o.isEditMode?"warning":"success",""),e.Q6J("disabled",!o.userForm.valid),e.xp6(1),e.Oqu(o.isEditMode?"Modifier":"Sauvegarder"),e.xp6(14),e.Oqu(o.message))},dependencies:[m.sg,m.O5,i._Y,i.YN,i.Kr,i.Fj,i.Wl,i.K7,i.JJ,i.JL,i.sg,i.u],encapsulation:2}),s})(),data:{href:"user",icon:"fa fa-user",label:"Users",title:"Users"}}];let x=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[c.Bz.forChild(N),c.Bz]}),s})(),I=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[m.ez,i.UX,x]}),s})()}}]);