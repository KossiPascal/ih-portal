"use strict";(self.webpackChunkih_portal=self.webpackChunkih_portal||[]).push([[583],{9583:(de,O,b)=>{b.r(O),b.d(O,{DashboardsModule:()=>ce});var T=b(8692),f=b(92),$=b(9841),N=b(8968),x=b(8239);let y=(()=>{class i{}return i.home_actions_forms=["pcime_c_asc","pcime_c_referral","pcime_c_followup","usp_pcime_followup","malnutrition_followup","pregnancy_family_planning","delivery","prenatal_followup","postnatal_followup","newborn_followup","home_visit","death_report","women_emergency_followup","fp_followup_danger_sign_check","fp_follow_up_renewal"],i.vaccination_forms=["vaccination"],i.consultations_followup_forms=["pcime_c_asc","pregnancy_family_planning","delivery","pcime_c_followup","usp_pcime_followup","pcime_c_referral","malnutrition_followup","prenatal_followup","postnatal_followup","newborn_followup","women_emergency_followup","fp_followup_danger_sign_check","fp_follow_up_renewal"],i.consultations_forms=["pcime_c_asc","pregnancy_family_planning","delivery"],i.mum_fp_forms=["pregnancy_family_planning","delivery","prenatal_followup","postnatal_followup","women_emergency_followup","fp_followup_danger_sign_check","fp_follow_up_renewal"],i.fp_forms=["pregnancy_family_planning","fp_followup_danger_sign_check","fp_follow_up_renewal"],i.mum_forms=["pregnancy_family_planning","delivery","prenatal_followup","postnatal_followup","women_emergency_followup"],i.followup_forms=["pcime_c_followup","usp_pcime_followup","pcime_c_referral","malnutrition_followup","prenatal_followup","postnatal_followup","newborn_followup","women_emergency_followup","fp_followup_danger_sign_check","fp_follow_up_renewal"],i.child_forms=["pcime_c_asc","pcime_c_followup","usp_pcime_followup","newborn_followup","pcime_c_referral","malnutrition_followup"],i.child_followup_forms=["pcime_c_followup","usp_pcime_followup","newborn_followup","pcime_c_referral","malnutrition_followup"],i.allForms=["vaccination_followup","pcime_c_asc","pcime_c_referral","pcime_c_followup","usp_pcime_followup","malnutrition_followup","pregnancy_family_planning","delivery","prenatal_followup","postnatal_followup","newborn_followup","home_visit","death_report","women_emergency_followup","fp_followup_danger_sign_check","fp_follow_up_renewal"],i})();var o=b(8629),U=b(574),t=b(4537),q=b(1383),I=b(7556),F=b(1815);function Q(i,a){if(1&i&&(t.TgZ(0,"div",18),t._UZ(1,"i",19),t.TgZ(2,"div",20),t._uU(3),t.qZA()()),2&i){const e=t.oxw();t.xp6(3),t.hij(" ",e.initMsg,"")}}function S(i,a){if(1&i&&(t.TgZ(0,"option",24),t._uU(1),t.qZA()),2&i){const e=a.$implicit;t.s9C("value",e.id),t.xp6(1),t.hij(" ",e.name," ")}}function Y(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div",9)(1,"div",10)(2,"label"),t._uU(3,"District"),t.qZA(),t.TgZ(4,"select",21),t.NdJ("change",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.genarateSites())}),t._UZ(5,"option",22),t.YNc(6,S,2,2,"option",23),t.qZA()()()}if(2&i){const e=t.oxw();t.xp6(6),t.Q6J("ngForOf",e.Districts$)}}function R(i,a){if(1&i&&(t.TgZ(0,"option",24),t._uU(1),t.qZA()),2&i){const e=a.$implicit;t.s9C("value",e.id),t.xp6(1),t.hij(" ",e.name," ")}}function M(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div",9)(1,"div",10)(2,"label"),t._uU(3,"Site"),t.qZA(),t.TgZ(4,"select",25),t.NdJ("change",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.genarateChws())}),t._UZ(5,"option",22),t.YNc(6,R,2,2,"option",23),t.qZA()()()}if(2&i){const e=t.oxw();t.xp6(6),t.Q6J("ngForOf",e.sites$)}}function L(i,a){1&i&&(t.TgZ(0,"div",8)(1,"div",26)(2,"div",10)(3,"label"),t._uU(4,"."),t.qZA(),t.TgZ(5,"div",27),t._UZ(6,"input",28),t.TgZ(7,"label",29)(8,"b"),t._uU(9,"Avec Ratio"),t.qZA()()()()()())}function k(i,a){1&i&&(t.TgZ(0,"th",44),t._uU(1,"Pcime"),t.qZA())}function E(i,a){1&i&&(t.TgZ(0,"th",45),t._uU(1,"Pcime"),t.qZA())}function z(i,a){1&i&&(t.TgZ(0,"th",44),t._uU(1,"Maternel"),t.qZA())}function G(i,a){1&i&&(t.TgZ(0,"th",45),t._uU(1,"Maternel"),t.qZA())}function j(i,a){1&i&&(t.TgZ(0,"th",44),t._uU(1,"PF"),t.qZA())}function B(i,a){1&i&&(t.TgZ(0,"th",45),t._uU(1,"PF"),t.qZA())}function H(i,a){1&i&&(t.TgZ(0,"th",44),t._uU(1,"Recherche"),t.qZA())}function K(i,a){1&i&&(t.TgZ(0,"th",45),t._uU(1,"Recherche"),t.qZA())}function W(i,a){1&i&&(t.TgZ(0,"th",44),t._uU(1,"Total"),t.qZA())}function V(i,a){1&i&&(t.TgZ(0,"th",45),t._uU(1,"Total"),t.qZA())}function X(i,a){1&i&&(t.TgZ(0,"th",41),t._uU(1,"Diff"),t.qZA())}function tt(i,a){1&i&&(t.TgZ(0,"th",41),t._uU(1,"Ratio"),t.qZA())}function et(i,a){1&i&&(t.TgZ(0,"th",41),t._uU(1,"Diff"),t.qZA())}function it(i,a){1&i&&(t.TgZ(0,"th",41),t._uU(1,"Ratio"),t.qZA())}function st(i,a){1&i&&(t.TgZ(0,"th",41),t._uU(1,"Diff"),t.qZA())}function ot(i,a){1&i&&(t.TgZ(0,"th",41),t._uU(1,"Ratio"),t.qZA())}function nt(i,a){1&i&&(t.TgZ(0,"th",41),t._uU(1,"Diff"),t.qZA())}function at(i,a){1&i&&(t.TgZ(0,"th",41),t._uU(1,"Ratio"),t.qZA())}function rt(i,a){1&i&&(t.TgZ(0,"th",41),t._uU(1,"Diff"),t.qZA())}function _t(i,a){1&i&&(t.TgZ(0,"th",41),t._uU(1,"Ratio"),t.qZA())}function lt(i,a){if(1&i&&(t.TgZ(0,"td",52)(1,"strong"),t._uU(2),t.qZA()()),2&i){const e=t.oxw().$implicit,s=t.oxw(2);t.xp6(2),t.Oqu(s.getRatio(e.Pcime,e.PcimeDhis2,!1).value)}}function ct(i,a){if(1&i&&(t.TgZ(0,"td"),t._uU(1),t.qZA()),2&i){const e=t.oxw().$implicit,s=t.oxw(2);t.Gre("bg-",s.getRatio(e.Pcime,e.PcimeDhis2).color,""),t.xp6(1),t.hij("",s.getRatio(e.Pcime,e.PcimeDhis2).value," %")}}function ut(i,a){if(1&i&&(t.TgZ(0,"td",52)(1,"strong"),t._uU(2),t.qZA()()),2&i){const e=t.oxw().$implicit,s=t.oxw(2);t.xp6(2),t.Oqu(s.getRatio(e.Maternelle,e.MaternelleDhis2,!1).value)}}function ht(i,a){if(1&i&&(t.TgZ(0,"td"),t._uU(1),t.qZA()),2&i){const e=t.oxw().$implicit,s=t.oxw(2);t.Gre("bg-",s.getRatio(e.Maternelle,e.MaternelleDhis2).color,""),t.xp6(1),t.hij("",s.getRatio(e.Maternelle,e.MaternelleDhis2).value," %")}}function pt(i,a){if(1&i&&(t.TgZ(0,"td",52)(1,"strong"),t._uU(2),t.qZA()()),2&i){const e=t.oxw().$implicit,s=t.oxw(2);t.xp6(2),t.Oqu(s.getRatio(e.Pf,e.PfDhis2,!1).value)}}function ft(i,a){if(1&i&&(t.TgZ(0,"td"),t._uU(1),t.qZA()),2&i){const e=t.oxw().$implicit,s=t.oxw(2);t.Gre("bg-",s.getRatio(e.Pf,e.PfDhis2).color,""),t.xp6(1),t.hij("",s.getRatio(e.Pf,e.PfDhis2).value," %")}}function dt(i,a){if(1&i&&(t.TgZ(0,"td",52)(1,"strong"),t._uU(2),t.qZA()()),2&i){const e=t.oxw().$implicit,s=t.oxw(2);t.xp6(2),t.Oqu(s.getRatio(e.Recherche,e.RechercheDhis,!1).value)}}function mt(i,a){if(1&i&&(t.TgZ(0,"td"),t._uU(1),t.qZA()),2&i){const e=t.oxw().$implicit,s=t.oxw(2);t.Gre("bg-",s.getRatio(e.Recherche,e.RechercheDhis).color,""),t.xp6(1),t.hij("",s.getRatio(e.Recherche,e.RechercheDhis).value," %")}}function gt(i,a){if(1&i&&(t.TgZ(0,"td",52)(1,"strong"),t._uU(2),t.qZA()()),2&i){const e=t.oxw().$implicit,s=t.oxw(2);t.xp6(2),t.Oqu(s.getRatio(e.Total,e.TotalDhis,!1).value)}}function wt(i,a){if(1&i&&(t.TgZ(0,"td"),t._uU(1),t.qZA()),2&i){const e=t.oxw().$implicit,s=t.oxw(2);t.Gre("bg-",s.getRatio(e.Total,e.TotalDhis).color,""),t.xp6(1),t.hij("",s.getRatio(e.Total,e.TotalDhis).value," %")}}function vt(i,a){if(1&i&&(t.TgZ(0,"tr")(1,"td",46),t._uU(2),t.qZA(),t.TgZ(3,"td",46),t._uU(4),t.qZA(),t.TgZ(5,"td",47),t._uU(6),t.qZA(),t.TgZ(7,"td",47),t._uU(8),t.qZA(),t.YNc(9,lt,3,1,"td",48),t.YNc(10,ct,2,4,"td",49),t.TgZ(11,"td",50),t._uU(12),t.qZA(),t.TgZ(13,"td",50),t._uU(14),t.qZA(),t.YNc(15,ut,3,1,"td",48),t.YNc(16,ht,2,4,"td",49),t.TgZ(17,"td",47),t._uU(18),t.qZA(),t.TgZ(19,"td",47),t._uU(20),t.qZA(),t.YNc(21,pt,3,1,"td",48),t.YNc(22,ft,2,4,"td",49),t.TgZ(23,"td",50),t._uU(24),t.qZA(),t.TgZ(25,"td",50),t._uU(26),t.qZA(),t.YNc(27,dt,3,1,"td",48),t.YNc(28,mt,2,4,"td",49),t.TgZ(29,"td",51),t._uU(30),t.qZA(),t.TgZ(31,"td",51),t._uU(32),t.qZA(),t.YNc(33,gt,3,1,"td",48),t.YNc(34,wt,2,4,"td",49),t.qZA()),2&i){const e=a.$implicit,s=t.oxw(2);t.xp6(2),t.Oqu(e.Code),t.xp6(2),t.Oqu(e.Name),t.xp6(2),t.Oqu(e.Pcime),t.xp6(2),t.Oqu(e.PcimeDhis2),t.xp6(1),t.Q6J("ngIf",s.isRatioChecked()),t.xp6(1),t.Q6J("ngIf",s.isRatioChecked()),t.xp6(2),t.Oqu(e.Maternelle),t.xp6(2),t.Oqu(e.MaternelleDhis2),t.xp6(1),t.Q6J("ngIf",s.isRatioChecked()),t.xp6(1),t.Q6J("ngIf",s.isRatioChecked()),t.xp6(2),t.Oqu(e.Pf),t.xp6(2),t.Oqu(e.PfDhis2),t.xp6(1),t.Q6J("ngIf",s.isRatioChecked()),t.xp6(1),t.Q6J("ngIf",s.isRatioChecked()),t.xp6(2),t.Oqu(e.Recherche),t.xp6(2),t.Oqu(e.RechercheDhis),t.xp6(1),t.Q6J("ngIf",s.isRatioChecked()),t.xp6(1),t.Q6J("ngIf",s.isRatioChecked()),t.xp6(2),t.Oqu(e.Total),t.xp6(2),t.Oqu(e.TotalDhis),t.xp6(1),t.Q6J("ngIf",s.isRatioChecked()),t.xp6(1),t.Q6J("ngIf",s.isRatioChecked())}}function Ct(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"section",30)(1,"div",31)(2,"div",6)(3,"h3",32)(4,"button",33),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.initTable())}),t._uU(5,"Generate Table"),t.qZA()()(),t.TgZ(6,"div",34)(7,"table",35)(8,"thead")(9,"tr",36)(10,"th",37),t._uU(11,"Code ASC"),t.qZA(),t.TgZ(12,"th",38),t._uU(13,"Nom ASC"),t.qZA(),t.YNc(14,k,2,0,"th",39),t.YNc(15,E,2,0,"th",40),t.YNc(16,z,2,0,"th",39),t.YNc(17,G,2,0,"th",40),t.YNc(18,j,2,0,"th",39),t.YNc(19,B,2,0,"th",40),t.YNc(20,H,2,0,"th",39),t.YNc(21,K,2,0,"th",40),t.YNc(22,W,2,0,"th",39),t.YNc(23,V,2,0,"th",40),t.qZA(),t.TgZ(24,"tr",36)(25,"th",41),t._uU(26,"APPLI"),t.qZA(),t.TgZ(27,"th",41),t._uU(28,"DHIS2"),t.qZA(),t.YNc(29,X,2,0,"th",42),t.YNc(30,tt,2,0,"th",42),t.TgZ(31,"th",41),t._uU(32,"APPLI"),t.qZA(),t.TgZ(33,"th",41),t._uU(34,"DHIS2"),t.qZA(),t.YNc(35,et,2,0,"th",42),t.YNc(36,it,2,0,"th",42),t.TgZ(37,"th",41),t._uU(38,"APPLI"),t.qZA(),t.TgZ(39,"th",41),t._uU(40,"DHIS2"),t.qZA(),t.YNc(41,st,2,0,"th",42),t.YNc(42,ot,2,0,"th",42),t.TgZ(43,"th",41),t._uU(44,"APPLI"),t.qZA(),t.TgZ(45,"th",41),t._uU(46,"DHIS2"),t.qZA(),t.YNc(47,nt,2,0,"th",42),t.YNc(48,at,2,0,"th",42),t.TgZ(49,"th",41),t._uU(50,"APPLI"),t.qZA(),t.TgZ(51,"th",41),t._uU(52,"DHIS2"),t.qZA(),t.YNc(53,rt,2,0,"th",42),t.YNc(54,_t,2,0,"th",42),t.qZA()(),t.TgZ(55,"tbody"),t.YNc(56,vt,35,22,"tr",43),t.qZA()()()()()}if(2&i){const e=t.oxw();t.xp6(14),t.Q6J("ngIf",!e.isRatioChecked()),t.xp6(1),t.Q6J("ngIf",e.isRatioChecked()),t.xp6(1),t.Q6J("ngIf",!e.isRatioChecked()),t.xp6(1),t.Q6J("ngIf",e.isRatioChecked()),t.xp6(1),t.Q6J("ngIf",!e.isRatioChecked()),t.xp6(1),t.Q6J("ngIf",e.isRatioChecked()),t.xp6(1),t.Q6J("ngIf",!e.isRatioChecked()),t.xp6(1),t.Q6J("ngIf",e.isRatioChecked()),t.xp6(1),t.Q6J("ngIf",!e.isRatioChecked()),t.xp6(1),t.Q6J("ngIf",e.isRatioChecked()),t.xp6(6),t.Q6J("ngIf",e.isRatioChecked()),t.xp6(1),t.Q6J("ngIf",e.isRatioChecked()),t.xp6(5),t.Q6J("ngIf",e.isRatioChecked()),t.xp6(1),t.Q6J("ngIf",e.isRatioChecked()),t.xp6(5),t.Q6J("ngIf",e.isRatioChecked()),t.xp6(1),t.Q6J("ngIf",e.isRatioChecked()),t.xp6(5),t.Q6J("ngIf",e.isRatioChecked()),t.xp6(1),t.Q6J("ngIf",e.isRatioChecked()),t.xp6(5),t.Q6J("ngIf",e.isRatioChecked()),t.xp6(1),t.Q6J("ngIf",e.isRatioChecked()),t.xp6(2),t.Q6J("ngForOf",e.bodyData)("ngForTrackBy",e.identifyBodyData)}}function Zt(i,a){if(1&i&&(t.TgZ(0,"tbody")(1,"tr")(2,"th",53),t._uU(3),t.qZA()(),t.TgZ(4,"tr",36)(5,"th",54),t._uU(6," Pcime"),t.qZA(),t.TgZ(7,"th",55),t._uU(8,"Application"),t.qZA(),t.TgZ(9,"th",56),t._uU(10),t.qZA()(),t.TgZ(11,"tr",36)(12,"td"),t._uU(13,"Fiche r\xe9cape"),t.qZA(),t.TgZ(14,"th",56),t._uU(15),t.qZA()(),t.TgZ(16,"tr",57)(17,"th",54),t._uU(18," Maternel"),t.qZA(),t.TgZ(19,"th"),t._uU(20,"Application"),t.qZA(),t.TgZ(21,"th",56),t._uU(22),t.qZA()(),t.TgZ(23,"tr",57)(24,"td"),t._uU(25,"Fiche r\xe9cape"),t.qZA(),t.TgZ(26,"th",56),t._uU(27),t.qZA()(),t.TgZ(28,"tr",58)(29,"th",54),t._uU(30," PF"),t.qZA(),t.TgZ(31,"th"),t._uU(32,"Application"),t.qZA(),t.TgZ(33,"th",56),t._uU(34),t.qZA()(),t.TgZ(35,"tr",58)(36,"td"),t._uU(37,"Fiche r\xe9cape"),t.qZA(),t.TgZ(38,"th",56),t._uU(39),t.qZA()(),t.TgZ(40,"tr",59)(41,"th",54),t._uU(42," Recherche"),t.qZA(),t.TgZ(43,"th"),t._uU(44,"Application"),t.qZA(),t.TgZ(45,"th",56),t._uU(46),t.qZA()(),t.TgZ(47,"tr",59)(48,"td"),t._uU(49,"Fiche r\xe9cape"),t.qZA(),t.TgZ(50,"th",56),t._uU(51),t.qZA()(),t.TgZ(52,"tr",60)(53,"th",54),t._uU(54," Total"),t.qZA(),t.TgZ(55,"th"),t._uU(56,"Application"),t.qZA(),t.TgZ(57,"th",56),t._uU(58),t.qZA()(),t.TgZ(59,"tr",60)(60,"td"),t._uU(61,"Fiche r\xe9cape"),t.qZA(),t.TgZ(62,"th",56),t._uU(63),t.qZA()()()),2&i){const e=a.$implicit;t.xp6(3),t.AsE(" ",e.Name," ( ",e.Code," )"),t.xp6(7),t.Oqu(e.Pcime),t.xp6(5),t.Oqu(e.PcimeDhis2),t.xp6(7),t.Oqu(e.Maternelle),t.xp6(5),t.Oqu(e.MaternelleDhis2),t.xp6(7),t.Oqu(e.Pf),t.xp6(5),t.Oqu(e.PfDhis2),t.xp6(7),t.Oqu(e.Recherche),t.xp6(5),t.Oqu(e.RechercheDhis),t.xp6(7),t.Oqu(e.Total),t.xp6(5),t.Oqu(e.TotalDhis)}}function xt(i,a){if(1&i&&(t.TgZ(0,"section",30)(1,"div",31)(2,"div",34)(3,"table",35),t.YNc(4,Zt,64,12,"tbody",43),t.qZA()()()()),2&i){const e=t.oxw();t.xp6(4),t.Q6J("ngForOf",e.bodyData)("ngForTrackBy",e.identifyBodyData)}}let bt=(()=>{class i{constructor(e,s,r){this.store=e,this.auth=s,this.sync=r,this.roles=new U.G(this.store),this.chwOU=null,this.bodyData=[],this.ChwsDataFromDb$=[],this.Districts$=[],this.Chws$=[],this.Sites$=[],this.chws$=[],this.sites$=[],this.responseMessage="",!this.roles.isSupervisorMentor()&&!this.roles.isChws()&&(location.href=this.auth.userValue()?.defaultRedirectUrl)}createDataFilterFormGroup(){return new f.cw({start_date:new f.NI(this.initDate.start_date,[f.kI.required,f.kI.minLength(7)]),end_date:new f.NI(this.initDate.end_date,[f.kI.required,f.kI.minLength(7)]),districts:new f.NI(""),sites:new f.NI(""),withRatio:new f.NI(!1,[f.kI.required])})}identifyBodyData(e,s){return s.Code}ngOnInit(){this.chwOU=this.auth.chwsOrgUnit(),this.roles.isChws()&&(null==this.chwOU||!(0,o.Nf)(this.chwOU))&&(location.href="chws/select_orgunit"),this.isLoading=!1,this.initDate=o.ED.startEnd21and20Date(),this.aggradateDataForm=this.createDataFilterFormGroup(),this.roles.isChws()?this.initDataFilted():this.initAllData()}initAllData(){var e=this;return(0,x.Z)(function*(){e.isLoading=!0,e.initMsg="Chargement des Districts ...",e.sync.getDistrictsList().subscribe(function(){var s=(0,x.Z)(function*(r){200==r.status&&(e.Districts$=r.data),e.initMsg="Chargement des Sites ...",e.sync.getSitesList().subscribe(function(){var l=(0,x.Z)(function*(p){200==p.status&&(e.Sites$=p.data),e.genarateSites(),e.initMsg="Chargement des ASC ...",e.sync.getChwsList().subscribe(function(){var _=(0,x.Z)(function*(u){200==u.status&&(e.Chws$=u.data),e.genarateChws(),e.isLoading=!1});return function(u){return _.apply(this,arguments)}}(),_=>{e.isLoading=!1,console.log(_.error)})});return function(p){return l.apply(this,arguments)}}(),l=>{e.isLoading=!1,console.log(l.error)})});return function(r){return s.apply(this,arguments)}}(),s=>{e.isLoading=!1,console.log(s.error)})})()}genarateSites(){this.sites$=[],this.chws$=[];const e=this.aggradateDataForm.value.districts;if(this.aggradateDataForm.value.sites="",this.aggradateDataForm.value.chws=[],(0,o.Nf)(e))for(let s=0;s<this.Sites$.length;s++){const r=this.Sites$[s];(0,o.Nf)(r)&&e.includes(r.district.id)&&this.sites$.push(r)}else this.sites$=[]}genarateChws(){const e=o.FI.returnDataAsArray(this.aggradateDataForm.value.sites);if(this.chws$=[],this.aggradateDataForm.value.chws=[],(0,o.Nf)(e))for(let s=0;s<this.Chws$.length;s++){const r=this.Chws$[s];(0,o.Nf)(r)&&e.includes(r.site.id)&&this.chws$.push(r)}else this.chws$=this.Chws$}ParamsToFilter(){const e=this.aggradateDataForm.value.start_date,s=this.aggradateDataForm.value.end_date;var r=[],l=[],p=[];return this.roles.isChws()?null!=this.chwOU&&(0,o.Nf)(this.chwOU)&&(r=o.FI.returnDataAsArray(this.chwOU.site.district.id),l=o.FI.returnDataAsArray(this.chwOU.site.id),p=o.FI.returnDataAsArray(this.chwOU.id)):(r=o.FI.returnDataAsArray(this.aggradateDataForm.value.districts),l=o.FI.returnDataAsArray(this.aggradateDataForm.value.sites)),{start_date:e,end_date:s,districts:r,sites:l,chws:p}}initDataFilted(e){this.initMsg="Loading Data ...",this.isLoading=!0,this.genarateChws(),this.sync.getAllChwsDataWithParams(e??this.ParamsToFilter()).subscribe(s=>{200==s.status?(this.ChwsDataFromDb$=s.data,this.getAllAboutData(e??this.ParamsToFilter())):(this.isLoading=!1,this.responseMessage=s.data)},s=>{this.isLoading=!1,console.log(s)})}getAllAboutData(e){const{start_date:s,end_date:r,sites:l}=e,p=this.roles.isChws()&&null!=this.chwOU?[this.chwOU]:this.chws$;var _={};for(let C=0;C<p.length;C++){const w=p[C].id;(0,o.Nf)(w)&&(_.hasOwnProperty(w)||(_[w]={chwId:w,app_total_child_followup:0,dhis_total_child_followup:0,app_total_mum_fp_followup:0,dhis_total_mum_fp_followup:0,app_total_mum_followup:0,dhis_total_mum_followup:0,app_total_fp_followup:0,dhis_total_fp_followup:0,app_total_active_research:0,dhis_total_active_research:0,app_total_consultation_followup:0,dhis_total_consultation_followup:0,app_total_home_visit:0,dhis_total_home_visit:0}))}for(let C=0;C<this.ChwsDataFromDb$.length;C++){const w=this.ChwsDataFromDb$[C];if(null!=w){const d=w.form,c=w.fields,v=null!=w.chw&&(0,o.Nf)(w.chw.id)?w.chw.id:"",A=null!=w.site&&(0,o.Nf)(w.site.id)?w.site.id:"",m=(0,o.Nf)(A)&&(0,o.Nf)(l)&&l?.includes(A)||!(0,o.Nf)(l),n=!(!(0,o.Nf)(s)||!(0,o.Nf)(r))&&o.ED.isBetween(`${s}`,w.reported_date,`${r}`);if(m&&n&&_.hasOwnProperty(v))if("dhis2"==w.source)"PCIME"===d&&(_[v].dhis_total_child_followup+=1),"Maternelle"===d&&(_[v].dhis_total_mum_followup+=1),"PF"===d&&(_[v].dhis_total_fp_followup+=1),("Maternelle"===d||"PF"===d)&&(_[v].dhis_total_mum_fp_followup+=1),"Recherche"===d&&(_[v].dhis_total_active_research+=1),"Recherche"!==d&&(_[v].dhis_total_consultation_followup+=1),_[v].dhis_total_home_visit+=1;else if("Tonoudayo"==w.source){if(y.child_forms.includes(d)&&(_[v].app_total_child_followup+=1),y.mum_forms.includes(d)&&"pregnancy_family_planning"!=d&&(_[v].app_total_mum_followup+=1),y.fp_forms.includes(d)&&"pregnancy_family_planning"!=d&&(_[v].app_total_fp_followup+=1),"pregnancy_family_planning"==d)if(w.fields.hasOwnProperty("s_reg_pregnancy_screen")){var u=!1;w.fields.s_reg_pregnancy_screen.hasOwnProperty("s_reg_urine_result")&&(u="positive"==c.s_reg_pregnancy_screen.s_reg_urine_result),w.fields.s_reg_pregnancy_screen.hasOwnProperty("s_reg_why_urine_test_not_done")&&(u="already_pregnant"==c.s_reg_pregnancy_screen.s_reg_why_urine_test_not_done),u?_[v].app_total_mum_followup+=1:_[v].app_total_fp_followup+=1}else _[v].app_total_fp_followup+=1;y.mum_fp_forms.includes(d)&&(_[v].app_total_mum_fp_followup+=1),["death_report","home_visit"].includes(d)&&(_[v].app_total_active_research+=1),y.consultations_followup_forms.includes(d)&&(_[v].app_total_consultation_followup+=1),y.home_actions_forms.includes(d)&&(_[v].app_total_home_visit+=1)}}}this.bodyData=[],Object.entries(_).map(([C,w])=>{const d=w;this.bodyData.push({Code:this.getChwInfos(d.chwId).external_id,Name:this.getChwInfos(d.chwId).name,Pcime:d.app_total_child_followup,PcimeDhis2:d.dhis_total_child_followup,Maternelle:d.app_total_mum_followup,MaternelleDhis2:d.dhis_total_mum_followup,Pf:d.app_total_fp_followup,PfDhis2:d.dhis_total_fp_followup,MaternellePf:d.app_total_mum_fp_followup,MaternellePfDhis2:d.dhis_total_mum_fp_followup,Recherche:d.app_total_active_research,RechercheDhis:d.dhis_total_active_research,Consultation:d.app_total_consultation_followup,ConsultationDhis:d.dhis_total_consultation_followup,Total:d.app_total_home_visit,TotalDhis:d.dhis_total_home_visit})}),this.isLoading=!1}getDataValuesElements(e){for(let s=0;s<e.dataValues.length;s++){const r=e.dataValues[s];if(r.dataElement==e.dataElement&&r.value==e.value)return!0}return!1}isRatioChecked(){return 1==this.aggradateDataForm.value.withRatio}getRatio(e,s,r=!0){var l=0,p="success",_=e-s;if(r){const u=100*(e>0?_/e:s/100);(l=+(u<0?-1*u:u).toFixed(2))>0&&l<=5&&(p="warning"),l>5&&(p="danger")}else l=+(_<0?-1*_:_).toFixed(2);return{value:l,color:p}}initTable(){initDataTable("compare_data",!1)}getChwInfos(e,s=!1){const l=this.roles.isChws()&&null!=this.chwOU?[this.chwOU]:this.chws$;for(let p=0;p<l.length;p++){const _=l[p];if((0,o.Nf)(_))if(1==s){if((0,o.Nf)(_.external_id)&&_.external_id==e)return _}else if((0,o.Nf)(_.id)&&_.id==e)return _}}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(q.u),t.Y36(I.e),t.Y36(F._))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-dashboard-1"]],decls:32,vars:8,consts:[[1,"content-header"],[1,"container-fluid"],[1,"card","card-info"],[2,"text-align","center","text-transform","uppercase"],[1,"overlay-wrapper"],["class","overlay",4,"ngIf"],[1,"card-header"],["novalidate","",3,"formGroup","ngSubmit"],[1,"row"],[1,"col-sm-2","col-6"],[1,"form-group"],["type","date","formControlName","start_date",1,"form-control"],["type","date","formControlName","end_date",1,"form-control"],["class","col-sm-2 col-6",4,"ngIf"],["type","submit",1,"btn","btn-warning","form-control",3,"disabled"],[1,"fa","fa-floppy-o","fa-right"],["class","row",4,"ngIf"],["class","content",4,"ngIf"],[1,"overlay"],[1,"fas","fa-3x","fa-sync-alt","fa-spin"],[1,"text-bold","pt-2"],["formControlName","districts",1,"form-control",3,"change"],["value",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["formControlName","sites",1,"form-control",3,"change"],[1,"col-sm-4"],[1,"form-check"],["id","withRatio","type","checkbox","formControlName","withRatio",1,"form-check-input",2,"font-size","20px"],["for","withRatio",1,"form-check-label"],[1,"content"],[1,"card"],[1,"card-title"],["type","button",3,"click"],[1,"card-body"],["id","compare_data",1,"table","table-bordered","table-hover"],[1,"bg-primary"],["rowspan","2",2,"width","50px"],["rowspan","2",2,"width","150px"],["colspan","2","style","width: 50px",4,"ngIf"],["colspan","4","style","width: 50px",4,"ngIf"],[2,"width","50px"],["style","width: 50px",4,"ngIf"],[4,"ngFor","ngForOf","ngForTrackBy"],["colspan","2",2,"width","50px"],["colspan","4",2,"width","50px"],[1,"info"],[1,"warning"],["class","line","class","",4,"ngIf"],[3,"class",4,"ngIf"],[1,"primary"],[1,"final"],[1,""],["colspan","3"],["rowspan","2",2,"width","100px","padding-top","35px"],[2,"width","150px"],[2,"font-size","25px","text-align","center"],[1,"bg-warning"],[1,"bg-info"],[1,"bg-danger"],[1,"bg-success"]],template:function(e,s){1&e&&(t.TgZ(0,"section",0)(1,"div",1)(2,"div",2)(3,"h1",3),t._uU(4,"Activit\xe9 Des ASC"),t.qZA(),t.TgZ(5,"div",4),t.YNc(6,Q,4,1,"div",5),t.TgZ(7,"div",6)(8,"form",7),t.NdJ("ngSubmit",function(){return s.initDataFilted()}),t.TgZ(9,"div",8)(10,"div",9)(11,"div",10)(12,"label"),t._uU(13,"Date D\xe9but"),t.qZA(),t._UZ(14,"input",11),t.qZA()(),t.TgZ(15,"div",9)(16,"div",10)(17,"label"),t._uU(18,"Date Fin"),t.qZA(),t._UZ(19,"input",12),t.qZA()(),t.YNc(20,Y,7,1,"div",13),t.YNc(21,M,7,1,"div",13),t.TgZ(22,"div",9)(23,"div",10)(24,"label"),t._uU(25,"."),t.qZA(),t.TgZ(26,"button",14),t._uU(27," OK "),t._UZ(28,"span",15),t.qZA()()()(),t.YNc(29,L,10,0,"div",16),t.qZA()()()()()(),t.YNc(30,Ct,57,22,"section",17),t.YNc(31,xt,5,2,"section",17)),2&e&&(t.xp6(6),t.Q6J("ngIf",s.isLoading),t.xp6(2),t.Q6J("formGroup",s.aggradateDataForm),t.xp6(12),t.Q6J("ngIf",!s.roles.isChws()),t.xp6(1),t.Q6J("ngIf",!s.roles.isChws()),t.xp6(5),t.Q6J("disabled",!s.aggradateDataForm.valid),t.xp6(3),t.Q6J("ngIf",!s.roles.isChws()),t.xp6(1),t.Q6J("ngIf",s.bodyData.length>0&&s.roles.isSupervisorMentor()),t.xp6(1),t.Q6J("ngIf",s.bodyData.length>0&&s.roles.isChws()))},dependencies:[T.sg,T.O5,f._Y,f.YN,f.Kr,f.Fj,f.Wl,f.EJ,f.JJ,f.JL,f.sg,f.u],styles:[".info[_ngcontent-%COMP%]{color:#00f;font-weight:bolder}.warning[_ngcontent-%COMP%]{color:orange;font-size:large;font-weight:bolder}.primary[_ngcontent-%COMP%]{color:purple;font-size:large;font-weight:bolder}.final[_ngcontent-%COMP%]{color:green;font-size:large;font-weight:bolder}.line[_ngcontent-%COMP%]{color:#000;font-size:large;font-weight:bolder}"]}),i})();function At(i,a){if(1&i&&(t.TgZ(0,"div",21),t._UZ(1,"i",22),t.TgZ(2,"div",23),t._uU(3),t.qZA()()),2&i){const e=t.oxw();t.xp6(3),t.hij(" ",e.initMsg,"")}}function Tt(i,a){if(1&i&&(t.TgZ(0,"option",28),t._uU(1),t.qZA()),2&i){const e=a.$implicit;t.s9C("value",e.id),t.xp6(1),t.hij(" ",e.name," ")}}function yt(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"select",26),t.NdJ("change",function(){t.CHM(e);const r=t.oxw(2);return t.KtG(r.genarateSites())}),t.YNc(1,Tt,2,2,"option",27),t.qZA()}if(2&i){const e=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",e.Districts$)}}function Dt(i,a){1&i&&t._UZ(0,"select",29)}function Nt(i,a){if(1&i&&(t.TgZ(0,"div",9)(1,"div",10)(2,"label"),t._uU(3,"District"),t.qZA(),t.YNc(4,yt,2,1,"select",24),t.YNc(5,Dt,1,0,"select",25),t.qZA()()),2&i){const e=t.oxw();t.xp6(4),t.Q6J("ngIf",e.Districts$.length>0),t.xp6(1),t.Q6J("ngIf",0==e.Districts$.length)}}function Ut(i,a){if(1&i&&(t.TgZ(0,"option",28),t._uU(1),t.qZA()),2&i){const e=a.$implicit;t.s9C("value",e.id),t.xp6(1),t.hij(" ",e.name," ")}}function qt(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"select",31),t.NdJ("change",function(){t.CHM(e);const r=t.oxw(2);return t.KtG(r.genarateChws())}),t.YNc(1,Ut,2,2,"option",27),t.qZA()}if(2&i){const e=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",e.sites$)}}function It(i,a){1&i&&t._UZ(0,"select",29)}function Ft(i,a){if(1&i&&(t.TgZ(0,"div",9)(1,"div",10)(2,"label"),t._uU(3,"Site"),t.qZA(),t.YNc(4,qt,2,1,"select",30),t.YNc(5,It,1,0,"select",25),t.qZA()()),2&i){const e=t.oxw();t.xp6(4),t.Q6J("ngIf",e.sites$.length>0),t.xp6(1),t.Q6J("ngIf",0==e.sites$.length)}}function Ot(i,a){if(1&i&&(t.TgZ(0,"option",28),t._uU(1),t.qZA()),2&i){const e=a.$implicit;t.s9C("value",e.id),t.xp6(1),t.hij(" ",e.name," ")}}function $t(i,a){if(1&i&&(t.TgZ(0,"select",33),t.YNc(1,Ot,2,2,"option",27),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",e.chws$)}}function Pt(i,a){1&i&&t._UZ(0,"select",29)}function Jt(i,a){if(1&i&&(t.TgZ(0,"div",9)(1,"div",10)(2,"label"),t._uU(3,"ASC"),t.qZA(),t.YNc(4,$t,2,1,"select",32),t.YNc(5,Pt,1,0,"select",25),t.qZA()()),2&i){const e=t.oxw();t.xp6(4),t.Q6J("ngIf",e.chws$.length>0),t.xp6(1),t.Q6J("ngIf",0==e.chws$.length)}}function Qt(i,a){if(1&i&&(t.TgZ(0,"option",28),t._uU(1),t.qZA()),2&i){const e=a.$implicit;t.s9C("value",e),t.xp6(1),t.hij(" ",e," ")}}function St(i,a){if(1&i&&(t.TgZ(0,"div",9)(1,"div",10)(2,"label"),t._uU(3,"Source"),t.qZA(),t.TgZ(4,"select",34)(5,"option",35),t._uU(6,"Tout"),t.qZA(),t.YNc(7,Qt,2,2,"option",27),t.qZA()()()),2&i){const e=t.oxw();t.xp6(7),t.Q6J("ngForOf",e.Sources$)}}function Yt(i,a){if(1&i&&(t.TgZ(0,"option",28),t._uU(1),t.qZA()),2&i){const e=a.$implicit;t.s9C("value",e),t.xp6(1),t.hij(" ",e," ")}}function Rt(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div",9)(1,"div",10)(2,"label"),t._uU(3,"Nbre Jour d'activit\xe9"),t.qZA(),t.TgZ(4,"select",36),t.NdJ("change",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.initDataFilted())}),t.YNc(5,Yt,2,2,"option",27),t.qZA()()()}if(2&i){const e=t.oxw();t.xp6(5),t.Q6J("ngForOf",e.days$)}}function Mt(i,a){if(1&i&&(t.TgZ(0,"h2")(1,"div",2)(2,"div",37),t._uU(3),t.qZA()()()),2&i){const e=t.oxw();t.xp6(3),t.hij(" ",e.data_error_messages," ")}}function Lt(i,a){1&i&&(t.TgZ(0,"h2")(1,"div",2)(2,"div",37),t._uU(3," Pas de donn\xe9es trouv\xe9e avec les paramettres renseign\xe9s ! "),t.qZA()()())}function kt(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"tr")(1,"td")(2,"span",43)(3,"b"),t._uU(4),t.qZA()(),t._UZ(5,"br"),t.TgZ(6,"span",44),t._uU(7),t.qZA(),t._UZ(8,"br"),t.TgZ(9,"span",45)(10,"small"),t._uU(11,"Total Action: "),t.qZA(),t.TgZ(12,"b"),t._uU(13),t.qZA()()(),t.TgZ(14,"td")(15,"span",46),t._uU(16,"~ "),t.qZA(),t.TgZ(17,"span",47),t._uU(18),t.qZA(),t._UZ(19,"br"),t.TgZ(20,"span",48)(21,"strong"),t._uU(22,"Actions/Jr"),t.qZA()()(),t.TgZ(23,"td")(24,"button",49),t.NdJ("click",function(){const l=t.CHM(e).$implicit,p=t.oxw(2);return t.KtG(p.seeSelectedChwData(l))}),t._uU(25,"D\xe9tails"),t.qZA()()()}if(2&i){const e=a.$implicit,s=t.oxw(2);t.xp6(4),t.Oqu(e.chw.name),t.xp6(3),t.Oqu(e.chw.external_id),t.xp6(6),t.Oqu(e.data.total_vad),t.xp6(4),t.Gre("custom-action badge ",s.getVadPerDay(e).class,""),t.xp6(1),t.hij(" ",s.getVadPerDay(e).val," ")}}function Et(i,a){if(1&i&&(t.TgZ(0,"div",2)(1,"div",38)(2,"div",6)(3,"h3",39),t._uU(4,"Donn\xe9es par ASC"),t.qZA()(),t.TgZ(5,"div",40)(6,"table",41)(7,"thead")(8,"tr")(9,"th"),t._uU(10,"ASC"),t.qZA(),t.TgZ(11,"th"),t._uU(12,"Nbre Action/Jour"),t.qZA()()(),t.TgZ(13,"tbody"),t.YNc(14,kt,26,7,"tr",42),t.qZA()()()()()),2&i){const e=t.oxw();t.xp6(14),t.Q6J("ngForOf",e.FinalChwsOutputData$)}}function zt(i,a){if(1&i&&(t.TgZ(0,"div",61)(1,"div",62)(2,"div",63)(3,"h3",64),t._uU(4),t.qZA(),t.TgZ(5,"p")(6,"strong"),t._uU(7),t.qZA()()(),t.TgZ(8,"div",65),t._UZ(9,"i",66),t.qZA()()()),2&i){const e=a.$implicit,s=t.oxw(2);t.xp6(4),t.Oqu(e.value),t.xp6(3),t.Oqu(s.capitaliseDataGiven(e.key,"_"," "))}}function Gt(i,a){if(1&i&&(t.TgZ(0,"div",50)(1,"div",51)(2,"div",52)(3,"div",53)(4,"h2"),t._uU(5),t._UZ(6,"br"),t.TgZ(7,"small"),t._uU(8),t.qZA()(),t.TgZ(9,"button",54)(10,"span",55),t._uU(11,"\xd7"),t.qZA()()(),t.TgZ(12,"div",56)(13,"div",57),t.YNc(14,zt,10,2,"div",58),t.ALo(15,"keyvalue"),t.qZA()(),t.TgZ(16,"div",59)(17,"button",60),t._uU(18,"Fermer"),t.qZA()()()()()),2&i){const e=t.oxw();t.xp6(5),t.hij(" ",e.selectedChwData.chw.name," "),t.xp6(3),t.Oqu(e.selectedChwData.chw.external_id),t.xp6(6),t.Q6J("ngForOf",t.lcZ(15,3,e.selectedChwData.data))}}let jt=(()=>{class i{constructor(e,s,r){this.store=e,this.auth=s,this.sync=r,this.roles=new U.G(this.store),this.chwOU=null,this.allAggragateData=[],this.options={Chart:{type:"area",height:700},title:{text:"Donn\xe9es par ASC"},credits:{enabled:!1},xAxis:{categories:["ASC1","ASC2","ASC3","ASC4","ASC5","ASC6","ASC7"],tickmarkPlacement:"on",title:{enabled:!0}},yAxis:{categories:[],max:5268,min:0,tickmarkPlacement:"on",title:{enabled:!1}},series:[{name:"Recherche Active",data:[502,635,809,947,1402,3634,5268]},{name:"Pcime",data:[163,203,276,408,547,729,628]},{name:"Maternel",data:[18,31,54,156,339,818,1201]}]},this.data_error_messages="",this.data_no_data_found=!1,this.FinalChwsOutputData$=[],this.selectedChwData=null,this.ChwsDataFromDbError="",this.Sources$=[],this.Districts$=[],this.Sites$=[],this.Chws$=[],this.Zones$=[],this.Patients$=[],this.Families$=[],this.chws$=[],this.sites$=[],this.days$=o.FI.range(18,1),this.day=18,!this.roles.isSupervisorMentor()&&!this.roles.isChws()&&(location.href=this.auth.userValue()?.defaultRedirectUrl)}createDataFilterFormGroup(){return new f.cw({start_date:new f.NI(this.initDate.start_date,[f.kI.required,f.kI.minLength(7)]),end_date:new f.NI(this.initDate.end_date,[f.kI.required,f.kI.minLength(7)]),sources:new f.NI(""),districts:new f.NI("",this.roles.isChws()?[]:[f.kI.required]),sites:new f.NI("",this.roles.isChws()?[]:[f.kI.required]),chws:new f.NI(""),day:new f.NI(this.day,[f.kI.required])})}identifyAggragateData(e,s){return s.total_vad}ngOnInit(){this.chwOU=this.auth.chwsOrgUnit(),this.roles.isChws()&&(null==this.chwOU||!(0,o.Nf)(this.chwOU))&&(location.href="chws/select_orgunit"),this.isLoading=!1,this.initDate=o.ED.startEnd21and20Date(),this.aggradateDataForm=this.createDataFilterFormGroup(),this.roles.isChws()?this.initDataFilted():this.initAllData()}initAllData(){var e=this;return(0,x.Z)(function*(){e.isLoading=!0;const s=e.ParamsToFilter();e.initMsg="Chargement des Districts ...",e.sync.getDistrictsList(s).subscribe(function(){var r=(0,x.Z)(function*(l){200==l.status&&(e.Districts$=l.data),e.initMsg="Chargement des Sites ...",e.sync.getSitesList(s).subscribe(function(){var p=(0,x.Z)(function*(_){200==_.status&&(e.Sites$=_.data),e.genarateSites(),e.initMsg="Chargement des ASC ...",e.sync.getChwsList(s).subscribe(function(){var u=(0,x.Z)(function*(C){200==C.status&&(e.Chws$=C.data),e.genarateChws(),e.isLoading=!1});return function(C){return u.apply(this,arguments)}}(),u=>{e.isLoading=!1,console.log(u.error)})});return function(_){return p.apply(this,arguments)}}(),p=>{e.isLoading=!1,console.log(p.error)})});return function(l){return r.apply(this,arguments)}}(),r=>{e.isLoading=!1,console.log(r.error)})})()}capitaliseDataGiven(e,s,r){return o.FI.capitaliseDataGiven(e,s,r)}seeSelectedChwData(e){this.selectedChwData=e}genarateSites(){this.sites$=[],this.chws$=[];const e=o.FI.returnEmptyArrayIfNul(this.aggradateDataForm.value.districts);if(this.aggradateDataForm.value.sites=[],this.aggradateDataForm.value.chws=[],(0,o.Nf)(e))for(let s=0;s<this.Sites$.length;s++){const r=this.Sites$[s];(0,o.Nf)(r)&&e.includes(r.district.id)&&this.sites$.push(r)}else this.sites$=[]}genarateChws(){const e=o.FI.returnEmptyArrayIfNul(this.aggradateDataForm.value.sites);if(this.chws$=[],this.aggradateDataForm.value.chws=[],(0,o.Nf)(e))for(let s=0;s<this.Chws$.length;s++){const r=this.Chws$[s];(0,o.Nf)(r)&&e.includes(r.site.id)&&this.chws$.push(r)}else this.chws$=[]}ParamsToFilter(){const e=this.aggradateDataForm.value.start_date,s=this.aggradateDataForm.value.end_date,r=this.aggradateDataForm.value.sources,l=(0,o.Nf)(r)?o.FI.returnDataAsArray(r):[];var p=[],_=[],u=[];return this.roles.isChws()?null!=this.chwOU&&(0,o.Nf)(this.chwOU)&&(p=o.FI.returnDataAsArray(this.chwOU.site.district.id),_=o.FI.returnDataAsArray(this.chwOU.site.id),u=o.FI.returnDataAsArray(this.chwOU.id),this.chws$=[this.chwOU]):(p=o.FI.returnEmptyArrayIfNul(this.aggradateDataForm.value.districts),_=o.FI.returnEmptyArrayIfNul(this.aggradateDataForm.value.sites),u=o.FI.returnEmptyArrayIfNul(this.aggradateDataForm.value.chws)),{start_date:e,end_date:s,sources:l,districts:p,sites:_,chws:u}}returnEmptyArrayIfNul(e){return(0,o.Nf)(e)?e:[]}getVadPerDay(e){const s=e.data.total_vad/this.day;var r=s.toFixed(s<1?1:0);if(e.chw.name.includes("(R)")&&e.data.total_vad<=0)return{val:r,class:""};var l="bg-success";return e.data.total_vad>0&&s<10*this.day/this.day&&s>=5*this.day/this.day&&(l="bg-warning"),(0==e.data.total_vad||e.data.total_vad>0&&s<5*this.day/this.day)&&(l="bg-danger"),{val:r,class:l}}initDataFilted(e){this.isLoading=!0,this.selectedChwData=null,this.day=this.aggradateDataForm.value.day;const s=e??this.ParamsToFilter();this.defaultParams?.start_date!=s.start_date||this.defaultParams?.end_date!=s.end_date||this.defaultParams?.districts!=s.districts||this.defaultParams?.sites!=s.sites?(this.FinalChwsOutputData$=[],this.data_error_messages="",this.data_no_data_found=!1,this.ChwsDataFromDbError="",this.sync.getAllChwsDataWithParams(s).subscribe(r=>{this.response$=r,this.startTraitement(s)},r=>{this.isLoading=!1,this.ChwsDataFromDbError=r.toString()})):this.startTraitement(s)}startTraitement(e){this.isLoading=!0;const s=e??this.ParamsToFilter();200==this.response$.status?(this.FinalChwsOutputData$=this.getAllAboutData(this.response$.data,this.chws$,s),this.defaultParams=s,this.data_no_data_found=this.FinalChwsOutputData$.length<=0):(this.data_error_messages=this.response$.data.toString(),this.data_no_data_found=!0),this.isLoading=!1}getAllAboutData(e,s,r){const l=r??this.ParamsToFilter(),{start_date:p,end_date:_,sources:u,districts:C,sites:w,chws:d}=l;for(let m=0;m<e.length;m++){const n=e[m];this.Sources$.includes(n.source)||this.Sources$.push(n.source)}var c={total_home_visit:{},total_pcime_soins:{},total_pcime_suivi:{},total_reference_pcime_suivi:{},total_reference_pcime_soins:{},total_diarrhee_pcime_soins:{},total_paludisme_pcime_soins:{},total_pneumonie_pcime_soins:{},total_malnutrition_pcime_soins:{},prompt_diarrhee_24h_pcime_soins:{},prompt_diarrhee_48h_pcime_soins:{},prompt_diarrhee_72h_pcime_soins:{},prompt_paludisme_24h_pcime_soins:{},prompt_paludisme_48h_pcime_soins:{},prompt_paludisme_72h_pcime_soins:{},prompt_pneumonie_24h_pcime_soins:{},prompt_pneumonie_48h_pcime_soins:{},prompt_pneumonie_72h_pcime_soins:{},total_pregnancy_family_planning:{},total_reference_family_planning_soins:{},total_reference_femme_enceinte_soins:{},total_vad_femme_enceinte_soins:{},total_vad_femme_enceinte_NC_soins:{},total_test_de_grossesse_domicile:{},total_newborn_suivi:{},total_reference_newborn:{},total_malnutrition_suivi:{},total_reference_malnutrition_suivi:{},total_prenatal_suivi:{},total_reference_prenatal_suivi:{},total_postnatal_suivi:{},total_reference_postnatal_suivi:{},total_vad_femme_postpartum_NC:{},total_vad_women_emergency_suivi:{},total_reference_women_emergency_suivi:{},total_femme_enceinte_women_emergency_suivi:{},total_femme_postpartum_women_emergency_suivi:{},total_family_planning_renewal_suivi:{},total_reference_family_planning_renewal_suivi:{},total_vad_family_planning_NC:{}};for(let m=0;m<s.length;m++){const n=s[m].id;null!=n&&""!=n&&Object.entries(c).map(([Z,g])=>{const D=g;D.hasOwnProperty(n)||(D[n]={chwId:n,count:0})})}for(let m=0;m<e.length;m++){const n=e[m];if(n){const Z=n.form,g=n.fields,D=null!=n.source&&""!=n.source?n.source:"",P=null!=n.district.id&&null!=n.district.id&&""!=n.district.id?n.district.id:"",J=null!=n.site&&null!=n.site.id&&""!=n.site.id?n.site.id:"",h=null!=n.chw&&null!=n.chw.id&&""!=n.chw.id?n.chw.id:"",ue=(0,o.Nf)(D)&&(0,o.Nf)(u)&&u?.includes(D)||!(0,o.Nf)(u),he=(0,o.Nf)(P)&&(0,o.Nf)(C)&&C?.includes(P)||!(0,o.Nf)(C),pe=(0,o.Nf)(J)&&(0,o.Nf)(w)&&w?.includes(J)||!(0,o.Nf)(w),fe=(0,o.Nf)(h)&&(0,o.Nf)(d)&&d?.includes(h)||!(0,o.Nf)(d);if((0,o.Nf)(p)&&(0,o.Nf)(_)&&o.ED.isBetween(`${p}`,n.reported_date,`${_}`)&&ue&&he&&pe&&fe)if("Tonoudayo"==n.source){if(null!=Z&&["death_report","home_visit"].includes(Z)&&(c.total_home_visit[h].count+=1),"pcime_c_asc"===Z&&(c.total_pcime_soins[h].count+=1,"yes"==g["group_review.s_have_you_refer_child"]&&(c.total_reference_pcime_soins[h].count+=1),"true"==g.has_diarrhea&&(c.total_diarrhee_pcime_soins[h].count+=1,"true"==g.within_24h&&(c.prompt_diarrhee_24h_pcime_soins[h].count+=1),("true"==g.within_24h||"true"==g.within_48h)&&(c.prompt_diarrhee_48h_pcime_soins[h].count+=1),("true"==g.within_24h||"true"==g.within_48h||"true"==g.within_72h)&&(c.prompt_diarrhee_72h_pcime_soins[h].count+=1)),"true"==g.fever_with_malaria&&(c.total_paludisme_pcime_soins[h].count+=1,"true"==g.within_24h&&(c.prompt_paludisme_24h_pcime_soins[h].count+=1),("true"==g.within_24h||"true"==g.within_48h)&&(c.prompt_paludisme_48h_pcime_soins[h].count+=1),("true"==g.within_24h||"true"==g.within_48h||"true"==g.within_72h)&&(c.prompt_paludisme_72h_pcime_soins[h].count+=1)),"true"==g.has_pneumonia&&(c.total_pneumonie_pcime_soins[h].count+=1,"true"==g.within_24h&&(c.prompt_pneumonie_24h_pcime_soins[h].count+=1),("true"==g.within_24h||"true"==g.within_48h)&&(c.prompt_pneumonie_48h_pcime_soins[h].count+=1),("true"==g.within_24h||"true"==g.within_48h||"true"==g.within_72h)&&(c.prompt_pneumonie_72h_pcime_soins[h].count+=1)),"true"==g.has_malnutrition&&(c.total_malnutrition_pcime_soins[h].count+=1)),"pcime_c_followup"===Z&&(c.total_pcime_suivi[h].count+=1,"yes"==g["group_review.s_have_you_refer_child"]&&(c.total_reference_pcime_suivi[h].count+=1)),"newborn_followup"===Z&&(c.total_newborn_suivi[h].count+=1,"yes"==g["group_summary.s_have_you_refer_child"]&&(c.total_reference_newborn[h].count+=1)),"malnutrition_followup"===Z&&(c.total_malnutrition_suivi[h].count+=1,"yes"==g["results_page.s_have_you_refer_child"]&&(c.total_reference_malnutrition_suivi[h].count+=1)),"prenatal_followup"===Z&&(c.total_prenatal_suivi[h].count+=1,"yes"==g["group_summary.s_have_you_refer_child"]&&(c.total_reference_prenatal_suivi[h].count+=1)),"postnatal_followup"===Z&&(c.total_postnatal_suivi[h].count+=1,"yes"==g["group_summary.s_have_you_refer_child"]&&(c.total_reference_postnatal_suivi[h].count+=1),"1"==g.follow_up_count&&(c.total_vad_femme_postpartum_NC[h].count+=1)),"pregnancy_family_planning"===Z){c.total_pregnancy_family_planning[h].count+=1;var v="positive"==g["s_reg_pregnancy_screen.s_reg_urine_result"],A="already_pregnant"==g["s_reg_pregnancy_screen.s_reg_why_urine_test_not_done"];"yes"==g["s_reg_pregnancy_screen.s_reg_urine_test"]&&(c.total_test_de_grossesse_domicile[h].count+=1),"yes"==g["s_summary.s_have_you_refer_child"]&&!v&&!A&&(c.total_reference_family_planning_soins[h].count+=1),(v||A)&&(c.total_vad_femme_enceinte_soins[h].count+=1,"fp_followup"!=g["s_reg_mode.s_reg_how_found"]&&(c.total_vad_femme_enceinte_NC_soins[h].count+=1),"yes"==g["s_summary.s_have_you_refer_child"]&&(c.total_reference_femme_enceinte_soins[h].count+=1)),"yes"==g["s_fam_plan_screen.agreed_to_fp"]&&(c.total_vad_family_planning_NC[h].count+=1)}"women_emergency_followup"===Z&&(c.total_vad_women_emergency_suivi[h].count+=1,"yes"==g["group_summary.s_have_you_refer_child"]&&(c.total_reference_women_emergency_suivi[h].count+=1),"pregnant"==g["initial.woman_status"]&&(c.total_femme_enceinte_women_emergency_suivi[h].count+=1),"postpartum"==g["initial.woman_status"]&&(c.total_femme_postpartum_women_emergency_suivi[h].count+=1)),"fp_follow_up_renewal"===Z&&(c.total_family_planning_renewal_suivi[h].count+=1,"true"==g["checklist2.s_refer_for_health_state"]&&(c.total_reference_family_planning_renewal_suivi[h].count+=1))}else"dhis2"==n.source&&(console.log(n.fields),"PCIME"===Z&&("Soins"==n.fields.zNldrz5EUPR&&365*n.fields.BLWjEQQdBFi>=60&&(c.total_pcime_soins[h].count+=1,"Oui"==n.fields.pMjjh6JLEz2&&(c.total_reference_pcime_soins[h].count+=1),"true"==n.fields.NPHYf8WAR9l&&(c.total_diarrhee_pcime_soins[h].count+=1,"\u226424"==n.fields.U3c13SP8AQz&&(c.prompt_diarrhee_24h_pcime_soins[h].count+=1),("\u226424"==n.fields.U3c13SP8AQz||"\u226448"==n.fields.U3c13SP8AQz)&&(c.prompt_diarrhee_48h_pcime_soins[h].count+=1),("\u226424"==n.fields.U3c13SP8AQz||"\u226448"==n.fields.U3c13SP8AQz||"\u226472"==n.fields.U3c13SP8AQz)&&(c.prompt_diarrhee_72h_pcime_soins[h].count+=1)),"true"==n.fields.Gl7HGePuIi3&&(c.total_paludisme_pcime_soins[h].count+=1,"\u226424"==n.fields.U3c13SP8AQz&&(c.prompt_paludisme_24h_pcime_soins[h].count+=1),("\u226424"==n.fields.U3c13SP8AQz||"\u226448"==n.fields.U3c13SP8AQz)&&(c.prompt_paludisme_48h_pcime_soins[h].count+=1),("\u226424"==n.fields.U3c13SP8AQz||"\u226448"==n.fields.U3c13SP8AQz||"\u226472"==n.fields.U3c13SP8AQz)&&(c.prompt_paludisme_72h_pcime_soins[h].count+=1)),"true"==n.fields.LP33fMJRWrT&&(c.total_pneumonie_pcime_soins[h].count+=1,"\u226424"==n.fields.U3c13SP8AQz&&(c.prompt_pneumonie_24h_pcime_soins[h].count+=1),("\u226424"==n.fields.U3c13SP8AQz||"\u226448"==n.fields.U3c13SP8AQz)&&(c.prompt_pneumonie_48h_pcime_soins[h].count+=1),("\u226424"==n.fields.U3c13SP8AQz||"\u226448"==n.fields.U3c13SP8AQz||"\u226472"==n.fields.U3c13SP8AQz)&&(c.prompt_pneumonie_72h_pcime_soins[h].count+=1)),"true"==n.fields.y84NNODZ705&&(c.total_malnutrition_pcime_soins[h].count+=1)),"Suivi"==n.fields.zNldrz5EUPR&&365*n.fields.BLWjEQQdBFi>=60&&(c.total_pcime_suivi[h].count+=1,"Oui"==n.fields.pMjjh6JLEz2&&(c.total_reference_pcime_suivi[h].count+=1)),365*n.fields.BLWjEQQdBFi<60&&(c.total_newborn_suivi[h].count+=1,"Oui"==n.fields.pMjjh6JLEz2&&(c.total_reference_newborn[h].count+=1))),"Maternelle"===Z&&(c.total_pregnancy_family_planning[h].count+=1,"CPN1"==n.fields.rFlbd27poqd&&(c.total_prenatal_suivi[h].count+=1,"Oui"==n.fields.pMjjh6JLEz2&&(c.total_reference_prenatal_suivi[h].count+=1)),"CPON1"==n.fields.WRwCp1UsW3b&&"Post_Partum"==n.fields.reULiF7LW3w&&(c.total_postnatal_suivi[h].count+=1,"Oui"==n.fields.pMjjh6JLEz2&&(c.total_reference_postnatal_suivi[h].count+=1),"NC"==n.fields.WaN8nOieIhs&&(c.total_vad_femme_postpartum_NC[h].count+=1)),"true"==n.fields.DNzefvCYfZz&&(c.total_test_de_grossesse_domicile[h].count+=1),(n.fields.reULiF7LW3w="Enceinte")&&(c.total_vad_femme_enceinte_soins[h].count+=1,"Oui"==n.fields.pMjjh6JLEz2&&(c.total_reference_femme_enceinte_soins[h].count+=1),"NC"==n.fields.WaN8nOieIhs&&(c.total_vad_femme_enceinte_NC_soins[h].count+=1))),"PF"===Z&&(c.total_pregnancy_family_planning[h].count+=1,"NC"==n.fields.WaN8nOieIhs&&(c.total_vad_family_planning_NC[h].count+=1),"AC"==n.fields.WaN8nOieIhs&&(c.total_family_planning_renewal_suivi[h].count+=1),"Oui"==n.fields.pMjjh6JLEz2&&("NC"==n.fields.WaN8nOieIhs&&(c.total_reference_family_planning_soins[h].count+=1),"AC"==n.fields.WaN8nOieIhs&&(c.total_reference_family_planning_renewal_suivi[h].count+=1))),"Recherche"===Z&&(c.total_home_visit[h].count+=1))}}return this.transformChwsData(c,s)}transformChwsData(e,s){var r=[];for(let p=0;p<s.length;p++){const _=s[p],u=_.id;var l={total_vad:0,total_vad_pcime_c:0,total_suivi_pcime_c:0,total_vad_femmes_enceinte:0,total_vad_femmes_postpartum:0,total_recherche_active:0,total_vad_family_planning:0,reference_femmes_pf:0,reference_pcime:0,reference_femmes_enceinte_postpartum:0,total_diarrhee_pcime_soins:0,total_paludisme_pcime_soins:0,total_pneumonie_pcime_soins:0,total_malnutrition_pcime_soins:0,prompt_diarrhee_24h_pcime_soins:0,prompt_diarrhee_48h_pcime_soins:0,prompt_diarrhee_72h_pcime_soins:0,prompt_paludisme_24h_pcime_soins:0,prompt_paludisme_48h_pcime_soins:0,prompt_paludisme_72h_pcime_soins:0,prompt_pneumonie_24h_pcime_soins:0,prompt_pneumonie_48h_pcime_soins:0,prompt_pneumonie_72h_pcime_soins:0,total_vad_femmes_enceintes_NC:0,total_vad_femme_postpartum_NC:0,total_test_de_grossesse_domicile:0};const C=e.total_home_visit[u].count+e.total_pcime_soins[u].count+e.total_pregnancy_family_planning[u].count+e.total_pcime_suivi[u].count+e.total_newborn_suivi[u].count+e.total_prenatal_suivi[u].count+e.total_postnatal_suivi[u].count+e.total_malnutrition_suivi[u].count+e.total_vad_women_emergency_suivi[u].count+e.total_family_planning_renewal_suivi[u].count,w=e.total_pcime_soins[u].count+e.total_pcime_suivi[u].count+e.total_newborn_suivi[u].count+e.total_malnutrition_suivi[u].count,d=e.total_pcime_suivi[u].count+e.total_newborn_suivi[u].count+e.total_malnutrition_suivi[u].count,c=e.total_reference_family_planning_soins[u].count+e.total_reference_family_planning_renewal_suivi[u].count,v=e.total_reference_pcime_soins[u].count+e.total_reference_pcime_suivi[u].count+e.total_reference_newborn[u].count+e.total_reference_malnutrition_suivi[u].count,A=e.total_reference_femme_enceinte_soins[u].count+e.total_reference_prenatal_suivi[u].count+e.total_reference_postnatal_suivi[u].count+e.total_reference_women_emergency_suivi[u].count,m=e.total_vad_femme_enceinte_soins[u].count+e.total_prenatal_suivi[u].count+e.total_femme_enceinte_women_emergency_suivi[u].count,n=e.total_postnatal_suivi[u].count+e.total_femme_postpartum_women_emergency_suivi[u].count,Z=C-(w+m+n+e.total_home_visit[u].count);l.total_vad+=C,l.total_vad_pcime_c+=w,l.total_suivi_pcime_c+=d,l.total_vad_femmes_enceinte+=m,l.total_vad_femmes_postpartum+=n,l.total_recherche_active+=e.total_home_visit[u].count,l.total_vad_family_planning=Z,l.reference_femmes_pf+=c,l.reference_pcime+=v,l.reference_femmes_enceinte_postpartum=A,l.total_diarrhee_pcime_soins+=e.total_diarrhee_pcime_soins[u].count,l.total_paludisme_pcime_soins+=e.total_paludisme_pcime_soins[u].count,l.total_pneumonie_pcime_soins+=e.total_pneumonie_pcime_soins[u].count,l.total_malnutrition_pcime_soins+=e.total_malnutrition_pcime_soins[u].count,l.prompt_diarrhee_24h_pcime_soins+=e.prompt_diarrhee_24h_pcime_soins[u].count,l.prompt_diarrhee_48h_pcime_soins+=e.prompt_diarrhee_48h_pcime_soins[u].count,l.prompt_diarrhee_72h_pcime_soins+=e.prompt_diarrhee_72h_pcime_soins[u].count,l.prompt_paludisme_24h_pcime_soins+=e.prompt_paludisme_24h_pcime_soins[u].count,l.prompt_paludisme_48h_pcime_soins+=e.prompt_paludisme_48h_pcime_soins[u].count,l.prompt_paludisme_72h_pcime_soins+=e.prompt_paludisme_72h_pcime_soins[u].count,l.prompt_pneumonie_24h_pcime_soins+=e.prompt_pneumonie_24h_pcime_soins[u].count,l.prompt_pneumonie_48h_pcime_soins+=e.prompt_pneumonie_48h_pcime_soins[u].count,l.prompt_pneumonie_72h_pcime_soins+=e.prompt_pneumonie_72h_pcime_soins[u].count,l.total_vad_femmes_enceintes_NC+=e.total_vad_femme_enceinte_NC_soins[u].count,l.total_vad_femme_postpartum_NC+=e.total_vad_femme_postpartum_NC[u].count,l.total_test_de_grossesse_domicile+=e.total_test_de_grossesse_domicile[u].count,r.push({chw:_,data:l})}return r}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(q.u),t.Y36(I.e),t.Y36(F._))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-dashboard-2"]],decls:41,vars:12,consts:[[1,"content-header"],[1,"container-fluid"],[1,"card","card-info"],[2,"text-align","center","text-transform","uppercase"],[1,"overlay-wrapper"],["class","overlay",4,"ngIf"],[1,"card-header"],["novalidate","",3,"formGroup","ngSubmit"],[1,"row"],[1,"col-sm-2","col-6"],[1,"form-group"],["type","date","formControlName","start_date",1,"form-control"],["type","date","formControlName","end_date",1,"form-control"],["class","col-sm-2 col-6",4,"ngIf"],["type","submit",1,"btn","btn-warning","form-control",3,"disabled"],[1,"fa","fa-floppy-o","fa-right"],[1,"content"],[1,"col-sm-5"],[4,"ngIf"],["class","card card-info",4,"ngIf"],["class","modal fade","id","modal-default",4,"ngIf"],[1,"overlay"],[1,"fas","fa-3x","fa-sync-alt","fa-spin"],[1,"text-bold","pt-2"],["class","form-control","multiple","multiple","formControlName","districts",3,"change",4,"ngIf"],["class","form-control",4,"ngIf"],["multiple","multiple","formControlName","districts",1,"form-control",3,"change"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"form-control"],["class","form-control","multiple","multiple","formControlName","sites",3,"change",4,"ngIf"],["multiple","multiple","formControlName","sites",1,"form-control",3,"change"],["class","form-control","multiple","multiple","formControlName","chws",4,"ngIf"],["multiple","multiple","formControlName","chws",1,"form-control"],["formControlName","sources",1,"form-control"],["value",""],["formControlName","day",1,"form-control",2,"font-size","20px",3,"change"],[1,"card-body"],[1,"card"],[1,"card-title"],[1,"card-body","p-0"],[1,"table","table-sm","table-striped",2,"margin","auto"],[4,"ngFor","ngForOf"],[1,"custom-badge",2,"font-size","18px"],[1,"custom-badge"],[1,"info",2,"font-size","14px"],[2,"font-size","20px"],[2,"font-size","35px","padding","1px"],[1,"info"],["data-toggle","modal","data-target","#modal-default",1,"btn","btn-info",2,"margin-top","10px",3,"click"],["id","modal-default",1,"modal","fade"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body"],[1,"row","card-body"],["class","col-sm-6 col-6",4,"ngFor","ngForOf"],[1,"modal-footer","justify-content-between"],["id","close-modal","type","button","data-dismiss","modal",1,"btn","btn-default"],[1,"col-sm-6","col-6"],[1,"small-box","bg-info",2,"border","1px solid black"],[1,"inner"],[2,"font-size","40px"],[1,"icon"],[1,"ion","ion-stats-bars"]],template:function(e,s){1&e&&(t.TgZ(0,"section",0)(1,"div",1)(2,"div",2)(3,"h1",3),t._uU(4,"Donn\xe9es D\xe9taill\xe9es Par ASC"),t.qZA(),t.TgZ(5,"div",4),t.YNc(6,At,4,1,"div",5),t.TgZ(7,"div",6)(8,"form",7),t.NdJ("ngSubmit",function(){return s.initDataFilted()}),t.TgZ(9,"div",8)(10,"div",9)(11,"div",10)(12,"label"),t._uU(13,"Date D\xe9but"),t.qZA(),t._UZ(14,"input",11),t.qZA()(),t.TgZ(15,"div",9)(16,"div",10)(17,"label"),t._uU(18,"Date Fin"),t.qZA(),t._UZ(19,"input",12),t.qZA()(),t.YNc(20,Nt,6,2,"div",13),t.YNc(21,Ft,6,2,"div",13),t.YNc(22,Jt,6,2,"div",13),t.YNc(23,St,8,1,"div",13),t.YNc(24,Rt,6,1,"div",13),t.TgZ(25,"div",9)(26,"div",10)(27,"label"),t._uU(28,"."),t.qZA(),t.TgZ(29,"button",14),t._uU(30," OK "),t._UZ(31,"span",15),t.qZA()()()()()()()(),t.TgZ(32,"section",16)(33,"div",1)(34,"div",17),t.YNc(35,Mt,4,1,"h2",18),t.YNc(36,Lt,4,0,"h2",18),t.qZA(),t.YNc(37,Et,15,1,"div",19),t.qZA()(),t.YNc(38,Gt,19,5,"div",20),t._UZ(39,"br")(40,"br"),t.qZA()()),2&e&&(t.xp6(6),t.Q6J("ngIf",s.isLoading),t.xp6(2),t.Q6J("formGroup",s.aggradateDataForm),t.xp6(12),t.Q6J("ngIf",!s.roles.isChws()),t.xp6(1),t.Q6J("ngIf",!s.roles.isChws()),t.xp6(1),t.Q6J("ngIf",!s.roles.isChws()),t.xp6(1),t.Q6J("ngIf",s.Sources$.length>0&&!s.roles.isChws()),t.xp6(1),t.Q6J("ngIf",s.days$.length>0),t.xp6(5),t.Q6J("disabled",!s.aggradateDataForm.valid),t.xp6(6),t.Q6J("ngIf",""!=s.data_error_messages),t.xp6(1),t.Q6J("ngIf",1==s.data_no_data_found),t.xp6(1),t.Q6J("ngIf",""==s.data_error_messages&&s.FinalChwsOutputData$.length>0),t.xp6(1),t.Q6J("ngIf",null!=s.selectedChwData))},dependencies:[T.sg,T.O5,f._Y,f.YN,f.Kr,f.Fj,f.EJ,f.K7,f.JJ,f.JL,f.sg,f.u,T.Nd],styles:[".custom-badge[_ngcontent-%COMP%]{font-size:18px;color:#000}.custom-action[_ngcontent-%COMP%]{font-size:25px;color:#000;text-align:center!important}.info[_ngcontent-%COMP%]{text-align:center!important}.box[_ngcontent-%COMP%]{width:600px;height:300px;border:1px solid black;padding:2px 4px;overflow-y:scroll;overflow-x:auto}.log[_ngcontent-%COMP%]{margin-top:8px;font-family:monospace}"]}),i})();var Bt=b(8171);function Ht(i,a){if(1&i&&(t.TgZ(0,"div",9),t._UZ(1,"i",10),t.TgZ(2,"div",11),t._uU(3),t.qZA()()),2&i){const e=t.oxw();t.xp6(3),t.hij(" ",e.initMsg,"")}}function Kt(i,a){if(1&i&&(t.TgZ(0,"option",28),t._uU(1),t.qZA()),2&i){const e=a.$implicit;t.s9C("value",e.id),t.xp6(1),t.hij(" ",e.name," ")}}function Wt(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"select",25),t.NdJ("change",function(){t.CHM(e);const r=t.oxw(2);return t.KtG(r.genarateSites())}),t._UZ(1,"option",26),t.YNc(2,Kt,2,2,"option",27),t.qZA()}if(2&i){const e=t.oxw(2);t.xp6(2),t.Q6J("ngForOf",e.Districts$)}}function Vt(i,a){1&i&&t._UZ(0,"select",29)}function Xt(i,a){if(1&i&&(t.TgZ(0,"option",28),t._uU(1),t.qZA()),2&i){const e=a.$implicit;t.s9C("value",e.id),t.xp6(1),t.hij(" ",e.name," ")}}function te(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"select",30),t.NdJ("change",function(){t.CHM(e);const r=t.oxw(2);return t.KtG(r.genarateChws())})("click",function(){t.CHM(e);const r=t.oxw(2);return t.KtG(r.genarateChws())}),t._UZ(1,"option",26),t.YNc(2,Xt,2,2,"option",27),t.qZA()}if(2&i){const e=t.oxw(2);t.xp6(2),t.Q6J("ngForOf",e.sites$)}}function ee(i,a){1&i&&t._UZ(0,"select",29)}function ie(i,a){if(1&i&&(t.TgZ(0,"option",28),t._uU(1),t.qZA()),2&i){const e=a.$implicit;t.s9C("value",e.id),t.xp6(1),t.hij(" ",e.name," ")}}function se(i,a){if(1&i&&(t.TgZ(0,"select",31),t._UZ(1,"option",26),t.YNc(2,ie,2,2,"option",27),t.qZA()),2&i){const e=t.oxw(2);t.xp6(2),t.Q6J("ngForOf",e.chws$)}}function oe(i,a){1&i&&t._UZ(0,"select",29)}function ne(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div",12)(1,"form",13),t.NdJ("ngSubmit",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.initAllData())}),t.TgZ(2,"div",14)(3,"div",15)(4,"div",16)(5,"label"),t._uU(6,"District"),t.qZA(),t.YNc(7,Wt,3,1,"select",17),t.qZA(),t.YNc(8,Vt,1,0,"select",18),t.qZA(),t.TgZ(9,"div",15)(10,"div",16)(11,"label"),t._uU(12,"Site"),t.qZA(),t.YNc(13,te,3,1,"select",19),t.qZA(),t.YNc(14,ee,1,0,"select",18),t.qZA(),t.TgZ(15,"div",20)(16,"div",16)(17,"label"),t._uU(18,"ASC"),t.qZA(),t.YNc(19,se,3,1,"select",21),t.YNc(20,oe,1,0,"select",18),t.qZA()(),t.TgZ(21,"div",22)(22,"div",16)(23,"label"),t._uU(24,"."),t.qZA(),t.TgZ(25,"button",23),t._UZ(26,"i",24),t.qZA()()()()()()}if(2&i){const e=t.oxw();t.xp6(1),t.Q6J("formGroup",e.aggradateDataForm),t.xp6(6),t.Q6J("ngIf",e.Districts$.length>0),t.xp6(1),t.Q6J("ngIf",0==e.Districts$.length),t.xp6(5),t.Q6J("ngIf",e.sites$.length>0),t.xp6(1),t.Q6J("ngIf",0==e.sites$.length),t.xp6(5),t.Q6J("ngIf",e.chws$.length>0),t.xp6(1),t.Q6J("ngIf",0==e.chws$.length),t.xp6(5),t.Q6J("disabled",!e.aggradateDataForm.valid)}}function ae(i,a){if(1&i&&(t.TgZ(0,"div",20)(1,"div")(2,"div",32)(3,"h3",33),t._uU(4),t.qZA(),t.TgZ(5,"p")(6,"strong"),t._uU(7),t.qZA()()(),t.TgZ(8,"div",34),t._UZ(9,"i"),t.qZA()()()),2&i){const e=a.$implicit;t.xp6(1),t.Gre("small-box ",e.color,""),t.xp6(3),t.Oqu(e.count),t.xp6(3),t.Oqu(e.label),t.xp6(2),t.Gre("ion ",e.icon,"")}}const _e=[{path:"",redirectTo:"dash1",pathMatch:"full"},{path:"dash1",component:bt,canActivate:[N.a],data:{href:"dashboard1",icon:"fa fa-user",label:"Dashboard-1",title:"Dashboard-1"}},{path:"dash2",component:jt,canActivate:[N.a],data:{href:"dashboard2",icon:"fa fa-user",label:"Dashboard-2",title:"Dashboard-2"}},{path:"dash3",component:(()=>{class i{constructor(e,s,r,l){this.store=e,this.auth=s,this.db=r,this.sync=l,this.roles=new U.G(this.store),this.chwOU=null,this.allAggragateData=[],this.Districts$=[],this.Sites$=[],this.Chws$=[],this.Zones$=[],this.Patients$=[],this.Families$=[],this.chws$=[],this.sites$=[],this.districtsChwsCount=0,this.sitesChwsCount=0,this.zonesChwsCount=0,this.patientsChwsCount=0,this.patientsCibleChwsCount=0,this.familiesChwsCount=0,this.chwsCount=0,!this.roles.isSupervisorMentor()&&!this.roles.isChws()&&(location.href=this.auth.userValue()?.defaultRedirectUrl)}createDataFilterFormGroup(){return new f.cw({districts:new f.NI("",this.roles.isChws()?[]:[f.kI.required]),sites:new f.NI("",this.roles.isChws()?[]:[f.kI.required]),chws:new f.NI("")})}identifyAggragateData(e,s){return s.label}ngOnInit(){this.chwOU=this.auth.chwsOrgUnit(),this.roles.isChws()&&(null==this.chwOU||!(0,o.Nf)(this.chwOU))&&(location.href="chws/select_orgunit"),this.isLoading=!1,this.aggradateDataForm=this.createDataFilterFormGroup(),this.roles.isChws()?this.initAllData(!1):this.initAllData(!0)}initAllData(e=!1){var s=this;return(0,x.Z)(function*(){s.isLoading=!0;const r=s.ParamsToFilter();s.initMsg="Chargement des Districts ...",s.sync.getDistrictsList(r).subscribe(function(){var l=(0,x.Z)(function*(p){200==p.status&&(s.Districts$=p.data),s.initMsg="Chargement des Sites ...",s.sync.getSitesList(r).subscribe(function(){var _=(0,x.Z)(function*(u){200==u.status&&(s.Sites$=u.data),s.initMsg="Chargement des ASC ...",s.sync.getChwsList(r).subscribe(function(){var C=(0,x.Z)(function*(w){200==w.status&&(s.Chws$=w.data),0==e?(s.initMsg="Chargement des Zones ...",s.sync.getZonesList(r).subscribe(function(){var d=(0,x.Z)(function*(c){200==c.status&&(s.Zones$=c.data),s.initMsg="Chargement des Familles ...",s.sync.getFamilyList(r).subscribe(function(){var v=(0,x.Z)(function*(A){200==A.status&&(s.Families$=A.data),s.initMsg="Chargement des Patients ...",s.sync.getPatientsList(r).subscribe(function(){var m=(0,x.Z)(function*(n){200==n.status&&(s.Patients$=n.data),s.initDataFilted(r)});return function(n){return m.apply(this,arguments)}}(),m=>{s.isLoading=!1,console.log(m)})});return function(A){return v.apply(this,arguments)}}(),v=>{s.isLoading=!1,console.log(v.error)})});return function(c){return d.apply(this,arguments)}}(),d=>{s.isLoading=!1,console.log(d.error)})):s.isLoading=!1});return function(w){return C.apply(this,arguments)}}(),C=>{s.isLoading=!1,console.log(C.error)})});return function(u){return _.apply(this,arguments)}}(),_=>{s.isLoading=!1,console.log(_.error)})});return function(p){return l.apply(this,arguments)}}(),l=>{s.isLoading=!1,console.log(l.error)})})()}formatHostName(e){return e.replace(".org","").replace("-",".").trim()}genarateSites(){this.sites$=[],this.chws$=[];const e=o.FI.returnEmptyArrayIfNul(this.aggradateDataForm.value.districts);if(this.aggradateDataForm.value.sites="",this.aggradateDataForm.value.chws=[],(0,o.Nf)(e))for(let s=0;s<this.Sites$.length;s++){const r=this.Sites$[s];(0,o.Nf)(r)&&e.includes(r.district.id)&&this.sites$.push(r)}else this.sites$=[]}genarateChws(){const e=o.FI.returnEmptyArrayIfNul(this.aggradateDataForm.value.sites);if(this.chws$=[],this.aggradateDataForm.value.chws=[],(0,o.Nf)(e))for(let s=0;s<this.Chws$.length;s++){const r=this.Chws$[s];(0,o.Nf)(r)&&e.includes(r.site.id)&&this.chws$.push(r)}else this.chws$=[]}ParamsToFilter(){var e=[],s=[],r=[];return this.roles.isChws()?null!=this.chwOU&&(0,o.Nf)(this.chwOU)&&(e=o.FI.returnDataAsArray(this.chwOU.site.district.id),s=o.FI.returnDataAsArray(this.chwOU.site.id),r=o.FI.returnDataAsArray(this.chwOU.id)):(e=o.FI.returnEmptyArrayIfNul(this.aggradateDataForm.value.districts),s=o.FI.returnEmptyArrayIfNul(this.aggradateDataForm.value.sites),r=o.FI.returnEmptyArrayIfNul(this.aggradateDataForm.value.chws)),{districts:e,sites:s,chws:r}}initDataFilted(e){this.isLoading=!0;const{chws:l,sites:p,districts:_}=e??this.ParamsToFilter();if(this.districtsChwsCount=0,this.sitesChwsCount=0,this.familiesChwsCount=0,this.patientsChwsCount=0,this.patientsCibleChwsCount=0,this.zonesChwsCount=0,this.chwsCount=0,this.allAggragateData=[],!this.roles.isChws()){for(let m=0;m<this.Districts$.length;m++){const n=this.Districts$[m];(0,o.Nf)(_)?_?.includes(n.id)&&this.districtsChwsCount++:this.districtsChwsCount++}for(let m=0;m<this.Sites$.length;m++){const n=this.Sites$[m];(0,o.Nf)(_)&&(0,o.Nf)(p)?_?.includes(n.district.id)&&p?.includes(n.id)&&this.sitesChwsCount++:(0,o.Nf)(_)&&!(0,o.Nf)(p)?_?.includes(n.district.id)&&this.sitesChwsCount++:this.sitesChwsCount++}for(let m=0;m<this.Zones$.length;m++){const n=this.Zones$[m];(0,o.Nf)(_)&&(0,o.Nf)(p)&&(0,o.Nf)(l)?_?.includes(n.site.district.id)&&p?.includes(n.site.id)&&l?.includes(n.chw_id)&&this.zonesChwsCount++:(0,o.Nf)(_)&&(0,o.Nf)(p)&&!(0,o.Nf)(l)?_?.includes(n.site.district.id)&&p?.includes(n.site.id)&&this.zonesChwsCount++:(!(0,o.Nf)(_)||(0,o.Nf)(p)||(0,o.Nf)(l)||_?.includes(n.site.district.id))&&this.zonesChwsCount++}for(let m=0;m<this.Chws$.length;m++){const n=this.Chws$[m];(0,o.Nf)(_)&&(0,o.Nf)(p)&&(0,o.Nf)(l)?_?.includes(n.site.district.id)&&p?.includes(n.site.id)&&l?.includes(n.zone.chw_id)&&this.chwsCount++:(0,o.Nf)(_)&&(0,o.Nf)(p)&&!(0,o.Nf)(l)?_?.includes(n.site.district.id)&&p?.includes(n.site.id)&&this.chwsCount++:(!(0,o.Nf)(_)||(0,o.Nf)(p)||(0,o.Nf)(l)||_?.includes(n.site.district.id))&&this.chwsCount++}}for(let m=0;m<this.Families$.length;m++){const n=this.Families$[m];(0,o.Nf)(_)&&(0,o.Nf)(p)&&(0,o.Nf)(l)?_?.includes(n.site.district.id)&&p?.includes(n.site.id)&&l?.includes(n.zone.chw_id)&&this.familiesChwsCount++:(0,o.Nf)(_)&&(0,o.Nf)(p)&&!(0,o.Nf)(l)?_?.includes(n.site.district.id)&&p?.includes(n.site.id)&&this.familiesChwsCount++:(!(0,o.Nf)(_)||(0,o.Nf)(p)||(0,o.Nf)(l)||_?.includes(n.site.district.id))&&this.familiesChwsCount++}for(let m=0;m<this.Patients$.length;m++){const n=this.Patients$[m],Z=o.ED.isInCible({birth_date:n.date_of_birth,sex:n.sex});(0,o.Nf)(_)&&(0,o.Nf)(p)&&(0,o.Nf)(l)?_?.includes(n.site.district.id)&&p?.includes(n.site.id)&&l?.includes(n.zone.chw_id)&&(this.patientsChwsCount++,Z&&this.patientsCibleChwsCount++):(0,o.Nf)(_)&&(0,o.Nf)(p)&&!(0,o.Nf)(l)?_?.includes(n.site.district.id)&&p?.includes(n.site.id)&&(this.patientsChwsCount++,Z&&this.patientsCibleChwsCount++):(!(0,o.Nf)(_)||(0,o.Nf)(p)||(0,o.Nf)(l)||_?.includes(n.site.district.id))&&(this.patientsChwsCount++,Z&&this.patientsCibleChwsCount++)}let u={label:o.FI.capitaliseDataGiven("total_district_enregistre","_"," "),count:this.districtsChwsCount,icon:"ion-stats-bars",color:"bg-info",detailUrl:"/dashboards/dash1"},C={label:o.FI.capitaliseDataGiven("total_site_enregistre","_"," "),count:this.sitesChwsCount,icon:"ion-stats-bars",color:"bg-info",detailUrl:"/dashboards/dash1"},w={label:o.FI.capitaliseDataGiven("total_ASC_enregistre","_"," "),count:this.chwsCount,icon:"ion-pie-graph",color:"bg-primary",detailUrl:"/dashboards/dash1"},d={label:o.FI.capitaliseDataGiven("total_zone_enregistre","_"," "),count:this.zonesChwsCount,icon:"ion-pie-graph",color:"bg-primary",detailUrl:"/dashboards/dash1"},c={label:o.FI.capitaliseDataGiven("total_famille_enregistre","_"," "),count:this.familiesChwsCount,icon:"ion-person-add",color:"bg-danger",detailUrl:"/dashboards/dash1"},v={label:o.FI.capitaliseDataGiven("total_patient_enregistre","_"," "),count:this.patientsChwsCount,icon:"ion-person-add",color:"bg-success",detailUrl:"/dashboards/dash1"},A={label:o.FI.capitaliseDataGiven("total_patient_cible","_"," "),count:this.patientsCibleChwsCount,icon:"ion-person-add",color:"bg-warning",detailUrl:"/dashboards/dash1"};this.roles.isChws()||this.allAggragateData.push(u),this.roles.isChws()||this.allAggragateData.push(C),this.roles.isChws()||this.allAggragateData.push(w),this.roles.isChws()||this.allAggragateData.push(d),this.allAggragateData.push(c),this.allAggragateData.push(v),this.allAggragateData.push(A),this.initMsg="",this.isLoading=!1}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(q.u),t.Y36(I.e),t.Y36(Bt.p),t.Y36(F._))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-dashboard-3"]],decls:12,vars:4,consts:[[1,"content-header"],[1,"container-fluid"],[1,"card","card-warning"],[2,"text-align","center","text-transform","uppercase"],[1,"overlay-wrapper"],["class","overlay",4,"ngIf"],["class","card-header",4,"ngIf"],[1,"row","card-body"],["class","col-sm-3 col-6",4,"ngFor","ngForOf","ngForTrackBy"],[1,"overlay"],[1,"fas","fa-3x","fa-sync-alt","fa-spin"],[1,"text-bold","pt-2"],[1,"card-header"],["novalidate","",3,"formGroup","ngSubmit"],[1,"row"],[1,"col-sm-2","col-6"],[1,"form-group"],["class","form-control","multiple","multiple","formControlName","districts",3,"change",4,"ngIf"],["class","form-control",4,"ngIf"],["class","form-control","multiple","multiple","formControlName","sites",3,"change","click",4,"ngIf"],[1,"col-sm-3","col-6"],["class","form-control","multiple","multiple","formControlName","chws",4,"ngIf"],[1,"col-sm-1","col-6"],["type","submit",1,"btn","btn-warning","form-control",3,"disabled"],[1,"nav-icon","fas","fa-search"],["multiple","multiple","formControlName","districts",1,"form-control",3,"change"],["value",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"form-control"],["multiple","multiple","formControlName","sites",1,"form-control",3,"change","click"],["multiple","multiple","formControlName","chws",1,"form-control"],[1,"inner"],[2,"font-size","40px"],[1,"icon"]],template:function(e,s){1&e&&(t.TgZ(0,"section",0)(1,"div",1)(2,"div",2)(3,"h1",3),t._uU(4,"Effectifs Des Patients"),t.qZA(),t.TgZ(5,"div",4),t.YNc(6,Ht,4,1,"div",5),t.YNc(7,ne,27,8,"div",6),t.qZA()(),t.TgZ(8,"div",7),t.YNc(9,ae,10,8,"div",8),t.qZA(),t._UZ(10,"br")(11,"br"),t.qZA()()),2&e&&(t.xp6(6),t.Q6J("ngIf",s.isLoading),t.xp6(1),t.Q6J("ngIf",!s.roles.isChws()),t.xp6(2),t.Q6J("ngForOf",s.allAggragateData)("ngForTrackBy",s.identifyAggragateData))},dependencies:[T.sg,T.O5,f._Y,f.YN,f.Kr,f.K7,f.JJ,f.JL,f.sg,f.u],encapsulation:2}),i})(),canActivate:[N.a],data:{href:"dashboard3",icon:"fa fa-user",label:"Dashboard-3",title:"Dashboard-3"}}];let le=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[$.Bz.forChild(_e),$.Bz]}),i})(),ce=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[T.ez,f.UX,le]}),i})()}}]);