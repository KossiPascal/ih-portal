"use strict";(self.webpackChunkih_portal=self.webpackChunkih_portal||[]).push([["src_app_modules_chws_chws_module_ts"],{4186:(rt,x,g)=>{g.r(x),g.d(x,{ChwsModule:()=>ot});var m=g(8692),o=g(92),w=g(3580),u=g(8239),T=g(8527),n=g(8629),t=g(4537),F=g(3406),C=g(7556),v=g(3395);function y(e,c){if(1&e&&(t.TgZ(0,"b",26)(1,"strong"),t._uU(2),t.qZA()()),2&e){const i=t.oxw();t.xp6(2),t.Oqu(i.message)}}function A(e,c){if(1&e&&(t.TgZ(0,"div",27),t._UZ(1,"i",28),t.TgZ(2,"div",29),t._uU(3),t.qZA()()),2&e){const i=t.oxw();t.xp6(3),t.Oqu(i.LoadingMsg)}}function O(e,c){if(1&e&&(t.TgZ(0,"option",30),t._uU(1),t.qZA()),2&e){const i=c.$implicit;t.s9C("value",i.id),t.xp6(1),t.hij(" ",i.name," ")}}function $(e,c){if(1&e&&(t.TgZ(0,"option",30),t._uU(1),t.qZA()),2&e){const i=c.$implicit;t.s9C("value",i.id),t.xp6(1),t.hij(" ",i.name," ")}}function q(e,c){if(1&e&&(t.TgZ(0,"option",30),t._uU(1),t.qZA()),2&e){const i=c.$implicit;t.s9C("value",i.id),t.xp6(1),t.hij(" ",i.name," ")}}let N=(()=>{class e{constructor(i,s,a,r){this.db=i,this.auth=s,this.sync=a,this.router=r,this.District$=[],this.Sites$=[],this.Chws$=[],this.district$=[],this.sites$=[],this.chws$=[],this.isLoading=!1,this.LoadingMsg="Loading...",this.message="",this.roles=new T.G(this.auth)}activeSave(){throw new Error("Method not implemented.")}ngOnInit(){this.currentUser=this.auth.currentUser(),this.chwOU=this.currentUser?.chw_found,this.initAllData(),this.orgUnitForm=this.createFilterFormGroup()}initAllData(){var i=this;return(0,u.Z)(function*(){i.isLoading=!0,i.sync.getDistrictsList().subscribe(s=>{200==s.status&&(i.District$=s.data),i.sync.getSitesList().subscribe(a=>{200==s.status&&(i.Sites$=a.data),i.sync.getChwsList().subscribe(r=>{200==r.status&&(i.Chws$=r.data),null!=i.chwOU&&(i.genarateSites(!0),i.genarateChws(!0)),i.isLoading=!1},r=>{console.log(r),i.isLoading=!1})},a=>{console.log(a),i.isLoading=!1})},s=>{console.log(s),i.isLoading=!1})})()}createFilterFormGroup(){return new o.cw({districts:new o.NI(null!=this.chwOU?this.chwOU.site.district.id:"",[o.kI.required]),sites:new o.NI(null!=this.chwOU?this.chwOU.site.id:"",[o.kI.required]),chws:new o.NI(null!=this.chwOU?this.chwOU.id:"",[o.kI.required])})}genarateSites(i=!1){const a=(0,n.pb)(i&&null!=this.chwOU?this.chwOU.site.district.id:this.orgUnitForm.value.districts);if(this.sites$=[],(0,n.Nf)(a))for(let r=0;r<this.Sites$.length;r++){const d=this.Sites$[r];(0,n.Nf)(d)&&a.includes(d.district.id)&&this.sites$.push(d)}else this.sites$=[]}genarateChws(i=!1){const a=(0,n.pb)(i&&null!=this.chwOU?this.chwOU.site.id:this.orgUnitForm.value.sites);if(this.chws$=[],this.orgUnitForm.value.chws="",(0,n.Nf)(a))for(let r=0;r<this.Chws$.length;r++){const d=this.Chws$[r];(0,n.Nf)(d)&&a.includes(d.site.id)&&this.chws$.push(d)}else this.chws$=[]}getChwInfo(i){for(let s=0;s<this.chws$.length;s++){const a=this.chws$[s];if(i.includes(a.id))return a}return null}updateChwsOrgUnit(){const i=this.orgUnitForm.value.chws,s=this.getChwInfo((0,n.pb)((0,n.Nf)(i)?i:this.chwOU.id));if(null!=s&&(0,n.Nf)(s)){if(this.currentUser){this.currentUser.chw_found=s,this.auth.setUser(this.currentUser);const a=(0,n.F2)();return a&&(0,n.Nf)(a)?void this.router.navigate([a]):void this.auth.GoToDefaultPage()}return this.auth.logout()}this.message="Erreur, veullez r\xe9\xe9ssayer ou contacter le superviseur!"}}return e.\u0275fac=function(i){return new(i||e)(t.Y36(F.W),t.Y36(C.e),t.Y36(v._),t.Y36(w.F0))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-chw_select_orgunit"]],decls:52,vars:7,consts:[[1,"page-title","card","card-primary","card-outline"],[1,"card-body"],[2,"text-align","center","font-weight","bold","font-size","large"],["class","login-box-msg",4,"ngIf"],[1,"overlay-wrapper"],["class","overlay",4,"ngIf"],["novalidate","",3,"formGroup","ngSubmit"],[1,"row"],[1,"col-sm-3","col-1"],[1,"col-sm-6","col-10"],[1,"col-sm-12","col-12"],[1,"form-group"],["formControlName","districts",1,"form-control",3,"change"],["value",""],[3,"value",4,"ngFor","ngForOf"],["formControlName","sites",1,"form-control",3,"change"],["formControlName","chws",1,"form-control"],[1,"col-sm-3","col-3"],[1,"col-sm-6","col-6"],["type","submit",1,"btn","btn-warning","form-control",3,"disabled"],[1,"fa","fa-floppy-o","fa-right"],[1,"page-content-wrap"],[1,"col-md-12"],[1,"panel","panel-default"],[1,"panel-heading"],[1,"panel-body"],[1,"login-box-msg"],[1,"overlay"],[1,"fas","fa-3x","fa-sync-alt","fa-spin"],[1,"text-bold","pt-2"],[3,"value"]],template:function(i,s){1&i&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2),t._uU(3,"Choisir district, site et code "),t.qZA(),t._UZ(4,"br")(5,"br"),t.YNc(6,y,3,1,"b",3),t.TgZ(7,"div",4),t.YNc(8,A,4,1,"div",5),t.TgZ(9,"form",6),t.NdJ("ngSubmit",function(){return s.updateChwsOrgUnit()}),t.TgZ(10,"div",7),t._UZ(11,"div",8),t.TgZ(12,"div",9)(13,"div",7)(14,"div",10)(15,"div",11)(16,"label"),t._uU(17,"District"),t.qZA(),t.TgZ(18,"select",12),t.NdJ("change",function(){return s.genarateSites()}),t._UZ(19,"option",13),t.YNc(20,O,2,2,"option",14),t.qZA()()(),t.TgZ(21,"div",10)(22,"div",11)(23,"label"),t._uU(24,"Site"),t.qZA(),t.TgZ(25,"select",15),t.NdJ("change",function(){return s.genarateChws()}),t._UZ(26,"option",13),t.YNc(27,$,2,2,"option",14),t.qZA()()(),t.TgZ(28,"div",10)(29,"div",11)(30,"label"),t._uU(31,"Asc"),t.qZA(),t.TgZ(32,"select",16),t._UZ(33,"option",13),t.YNc(34,q,2,2,"option",14),t.qZA()()(),t.TgZ(35,"div",10)(36,"div",7),t._UZ(37,"div",17),t.TgZ(38,"div",18)(39,"div",11),t._UZ(40,"br"),t.TgZ(41,"button",19),t._uU(42," Valider "),t._UZ(43,"span",20),t.qZA()()(),t._UZ(44,"div",17),t.qZA()()()(),t._UZ(45,"div",8),t.qZA()()()()(),t.TgZ(46,"div",21)(47,"div",7)(48,"div",22)(49,"div",23),t._UZ(50,"div",24)(51,"div",25),t.qZA()()()()),2&i&&(t.xp6(6),t.Q6J("ngIf",""!=s.message),t.xp6(2),t.Q6J("ngIf",s.isLoading),t.xp6(1),t.Q6J("formGroup",s.orgUnitForm),t.xp6(11),t.Q6J("ngForOf",s.District$),t.xp6(7),t.Q6J("ngForOf",s.sites$),t.xp6(7),t.Q6J("ngForOf",s.chws$),t.xp6(7),t.Q6J("disabled",!s.orgUnitForm.valid))},dependencies:[m.sg,m.O5,o._Y,o.YN,o.Kr,o.EJ,o.JJ,o.JL,o.sg,o.u],encapsulation:2}),e})();var U=g(926);function L(e,c){if(1&e&&(t.TgZ(0,"div",17),t._UZ(1,"i",18),t.TgZ(2,"div",19),t._uU(3),t.qZA()()),2&e){const i=t.oxw();t.xp6(3),t.hij(" ",i.initMsg,"")}}function I(e,c){if(1&e&&(t.TgZ(0,"thead")(1,"tr",27)(2,"th",28),t._uU(3),t.qZA()()()),2&e){const i=c.$implicit;t.xp6(3),t.AsE(" ",i.chw.name," ( ",i.chw.external_id," )")}}function S(e,c){if(1&e&&(t.TgZ(0,"tbody")(1,"tr")(2,"th",26),t._uU(3," Pcime"),t.qZA(),t.TgZ(4,"th",29),t._uU(5),t.qZA(),t.TgZ(6,"th",29),t._uU(7),t.qZA()(),t.TgZ(8,"tr")(9,"th",26),t._uU(10," Maternel"),t.qZA(),t.TgZ(11,"th",29),t._uU(12),t.qZA(),t.TgZ(13,"th",29),t._uU(14),t.qZA()(),t.TgZ(15,"tr")(16,"th",26),t._uU(17," PF"),t.qZA(),t.TgZ(18,"th",29),t._uU(19),t.qZA(),t.TgZ(20,"th",29),t._uU(21),t.qZA()(),t.TgZ(22,"tr")(23,"th",26),t._uU(24," Recherche"),t.qZA(),t.TgZ(25,"th",29),t._uU(26),t.qZA(),t.TgZ(27,"th",29),t._uU(28),t.qZA()(),t.TgZ(29,"tr")(30,"th",26),t._uU(31," Total"),t.qZA(),t.TgZ(32,"th",29),t._uU(33),t.qZA(),t.TgZ(34,"th",29),t._uU(35),t.qZA()(),t.TgZ(36,"tr")(37,"th",30),t._uU(38),t.qZA()()()),2&e){const i=c.$implicit;t.xp6(5),t.Oqu(i.data.sum_soins_suivi.tonoudayo),t.xp6(2),t.Oqu(i.data.sum_soins_suivi.dhis2),t.xp6(5),t.Oqu(i.data.sum_enceinte_postpartum.tonoudayo),t.xp6(2),t.Oqu(i.data.sum_enceinte_postpartum.dhis2),t.xp6(5),t.Oqu(i.data.pf.tonoudayo),t.xp6(2),t.Oqu(i.data.pf.dhis2),t.xp6(5),t.Oqu(i.data.home_visit.tonoudayo),t.xp6(2),t.Oqu(i.data.home_visit.dhis2),t.xp6(5),t.Oqu(i.data.total_vad.tonoudayo),t.xp6(2),t.Oqu(i.data.total_vad.dhis2),t.xp6(3),t.hij(" Total Action: ",i.data.sum_total_vad," ")}}function M(e,c){if(1&e&&(t.TgZ(0,"section",20)(1,"div",21)(2,"div",22)(3,"table",23),t.YNc(4,I,4,2,"thead",24),t.TgZ(5,"thead")(6,"tr",25)(7,"th",26),t._uU(8,"Type"),t.qZA(),t.TgZ(9,"th",26),t._uU(10,"Application"),t.qZA(),t.TgZ(11,"th",26),t._uU(12,"Fiche r\xe9cape"),t.qZA()()(),t.YNc(13,S,39,11,"tbody",24),t.qZA()()()()),2&e){const i=t.oxw();t.xp6(4),t.Q6J("ngForOf",i.FinalChwsOutputData$),t.xp6(9),t.Q6J("ngForOf",i.FinalChwsOutputData$)}}let P=(()=>{class e{constructor(i,s,a){this.auth=i,this.sync=s,this.router=a,this.FinalChwsOutputData$=[],this.Districts$=[],this.Chws$=[],this.Sites$=[],this.chws$=[],this.sites$=[],this.responseMessage=""}createDataFilterFormGroup(){return new o.cw({start_date:new o.NI(this.initDate.start_date,[o.kI.required,o.kI.minLength(7)]),end_date:new o.NI(this.initDate.end_date,[o.kI.required,o.kI.minLength(7)]),districts:new o.NI(""),sites:new o.NI(""),withRatio:new o.NI(!1,[o.kI.required])})}identifyBodyData(i,s){return s.Code}ngOnInit(){this.currentUser=this.auth.currentUser(),this.chwOU=this.currentUser?.chw_found,(null==this.chwOU||!(0,n.Nf)(this.chwOU))&&this.router.navigate(["chws/select_orgunit"]),this.isLoading=!1,this.initDate=(0,U.vW)(),this.aggradateDataForm=this.createDataFilterFormGroup(),this.initDataFilted()}initAllData(){var i=this;return(0,u.Z)(function*(){i.isLoading=!0,i.initMsg="Chargement des Districts ...",i.sync.getDistrictsList().subscribe(function(){var s=(0,u.Z)(function*(a){200==a.status&&(i.Districts$=a.data),i.initMsg="Chargement des Sites ...",i.sync.getSitesList().subscribe(function(){var r=(0,u.Z)(function*(d){200==d.status&&(i.Sites$=d.data),i.genarateSites(),i.initMsg="Chargement des ASC ...",i.sync.getChwsList().subscribe(function(){var l=(0,u.Z)(function*(h){200==h.status&&(i.Chws$=h.data),i.genarateChws(),i.isLoading=!1});return function(h){return l.apply(this,arguments)}}(),l=>{i.isLoading=!1,console.log(l.error)})});return function(d){return r.apply(this,arguments)}}(),r=>{i.isLoading=!1,console.log(r.error)})});return function(a){return s.apply(this,arguments)}}(),s=>{i.isLoading=!1,console.log(s.error)})})()}genarateSites(){this.sites$=[],this.chws$=[];const i=this.aggradateDataForm.value.districts;if(this.aggradateDataForm.value.sites="",this.aggradateDataForm.value.chws=[],(0,n.Nf)(i))for(let s=0;s<this.Sites$.length;s++){const a=this.Sites$[s];(0,n.Nf)(a)&&i.includes(a.district.id)&&this.sites$.push(a)}else this.sites$=[]}genarateChws(){const i=(0,n.pb)(this.aggradateDataForm.value.sites);if(this.chws$=[],this.aggradateDataForm.value.chws=[],(0,n.Nf)(i))for(let s=0;s<this.Chws$.length;s++){const a=this.Chws$[s];(0,n.Nf)(a)&&i.includes(a.site.id)&&this.chws$.push(a)}else this.chws$=this.Chws$}ParamsToFilter(){return{start_date:this.aggradateDataForm.value.start_date,end_date:this.aggradateDataForm.value.end_date,districts:(0,n.pb)(this.chwOU?.site.district.id),sites:(0,n.pb)(this.chwOU?.site.id),chws:(0,n.pb)(this.chwOU?.id),withDhis2Data:!0}}initDataFilted(i){this.initMsg="Loading Data ...",this.isLoading=!0,this.genarateChws(),this.sync.ihChtDataPerChw(i??this.ParamsToFilter()).subscribe(s=>{200==s.status?this.FinalChwsOutputData$=s.data:this.responseMessage=s.data,this.isLoading=!1},s=>{this.isLoading=!1,console.log(s)})}isRatioChecked(){return 1==this.aggradateDataForm.value.withRatio}getRatio(i,s,a=!0){var r=0,d="success",l=i-s;if(a){const h=100*(i>0?l/i:s/100);(r=+(h<0?-1*h:h).toFixed(2))>0&&r<=5&&(d="warning"),r>5&&(d="danger")}else r=+(l<0?-1*l:l).toFixed(2);return{value:r,color:d}}}return e.\u0275fac=function(i){return new(i||e)(t.Y36(C.e),t.Y36(v._),t.Y36(w.F0))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-dashboard-1"]],decls:28,vars:4,consts:[[1,"content-header"],[1,"container-fluid"],[1,"card","card-info"],[1,"title",2,"text-align","center","color","purple"],[1,"overlay-wrapper"],["class","overlay",4,"ngIf"],[1,"card-header"],["novalidate","",3,"formGroup","ngSubmit"],[1,"row"],[1,"col-sm-2","col-6"],[1,"form-group"],["type","date","formControlName","start_date",1,"form-control"],["type","date","formControlName","end_date",1,"form-control"],[2,"color","white"],["type","submit",1,"btn","btn-warning","form-control",3,"disabled"],[1,"fa","fa-floppy-o","fa-right"],["class","content",4,"ngIf"],[1,"overlay"],[1,"fas","fa-3x","fa-sync-alt","fa-spin"],[1,"text-bold","pt-2"],[1,"content"],[1,"card"],[1,"card-body"],["id","compare_data",1,"table","table-bordered","table-hover"],[4,"ngFor","ngForOf"],[1,"bg-info"],[2,"font-size","20px"],[1,"bg-default"],["colspan","3"],[2,"font-size","20px","text-align","center"],["colspan","3",2,"font-size","20px","text-align","center"]],template:function(i,s){1&i&&(t.TgZ(0,"section",0)(1,"div",1)(2,"div",2)(3,"h2",3),t._uU(4,"Activit\xe9 des ASC"),t.qZA(),t.TgZ(5,"div",4),t.YNc(6,L,4,1,"div",5),t.TgZ(7,"div",6)(8,"form",7),t.NdJ("ngSubmit",function(){return s.initDataFilted()}),t.TgZ(9,"div",8)(10,"div",9)(11,"div",10)(12,"label"),t._uU(13,"Date D\xe9but"),t.qZA(),t._UZ(14,"input",11),t.qZA()(),t.TgZ(15,"div",9)(16,"div",10)(17,"label"),t._uU(18,"Date Fin"),t.qZA(),t._UZ(19,"input",12),t.qZA()(),t.TgZ(20,"div",9)(21,"div",10)(22,"label",13),t._uU(23,"."),t.qZA(),t.TgZ(24,"button",14),t._uU(25," OK "),t._UZ(26,"span",15),t.qZA()()()()()()()()()(),t.YNc(27,M,14,2,"section",16)),2&i&&(t.xp6(6),t.Q6J("ngIf",s.isLoading),t.xp6(2),t.Q6J("formGroup",s.aggradateDataForm),t.xp6(16),t.Q6J("disabled",!s.aggradateDataForm.valid),t.xp6(3),t.Q6J("ngIf",s.FinalChwsOutputData$.length>0))},dependencies:[m.sg,m.O5,o._Y,o.Fj,o.JJ,o.JL,o.sg,o.u],styles:[".info[_ngcontent-%COMP%]{color:#00f;font-weight:bolder}.warning[_ngcontent-%COMP%]{color:orange;font-size:large;font-weight:bolder}.primary[_ngcontent-%COMP%]{color:purple;font-size:large;font-weight:bolder}.final[_ngcontent-%COMP%]{color:green;font-size:large;font-weight:bolder}.line[_ngcontent-%COMP%]{color:#000;font-size:large;font-weight:bolder}input[_ngcontent-%COMP%], select[_ngcontent-%COMP%], label[_ngcontent-%COMP%], .submit[_ngcontent-%COMP%], .title[_ngcontent-%COMP%]{margin-bottom:-10px!important}"]}),e})();function J(e,c){if(1&e&&(t.TgZ(0,"div",22),t._UZ(1,"i",23),t.TgZ(2,"div",24),t._uU(3),t.qZA()()),2&e){const i=t.oxw();t.xp6(3),t.hij(" ",i.initMsg,"")}}function Y(e,c){if(1&e&&(t.TgZ(0,"option",27)(1,"strong"),t._uU(2),t.qZA(),t._uU(3),t.qZA()),2&e){const i=c.$implicit;t.s9C("value",i),t.xp6(2),t.hij("",i," "),t.xp6(1),t.hij(" ",i<=1?"jour":"jours"," ")}}function z(e,c){if(1&e){const i=t.EpF();t.TgZ(0,"div",9)(1,"div",10)(2,"label"),t._uU(3,"Nbr de Jour"),t.qZA(),t.TgZ(4,"select",25),t.NdJ("change",function(){t.CHM(i);const a=t.oxw();return t.KtG(a.initDataFilted())}),t.YNc(5,Y,4,3,"option",26),t.qZA()()()}if(2&e){const i=t.oxw();t.xp6(5),t.Q6J("ngForOf",i.days$)}}function E(e,c){if(1&e&&(t.TgZ(0,"h2")(1,"div",2)(2,"div",28),t._uU(3),t.qZA()()()),2&e){const i=t.oxw();t.xp6(3),t.hij(" ",i.data_error_messages," ")}}function Q(e,c){1&e&&(t.TgZ(0,"h2")(1,"div",2)(2,"div",28),t._uU(3," Pas de donn\xe9es trouv\xe9e avec les paramettres renseign\xe9s ! "),t.qZA()()())}function G(e,c){if(1&e){const i=t.EpF();t.TgZ(0,"tr")(1,"td")(2,"span",35)(3,"b"),t._uU(4),t.qZA()(),t._UZ(5,"br"),t.TgZ(6,"span",36),t._uU(7),t.qZA(),t._UZ(8,"br"),t.TgZ(9,"span",37)(10,"small"),t._uU(11,"Total Action: "),t.qZA(),t.TgZ(12,"b"),t._uU(13),t.qZA()()(),t.TgZ(14,"td")(15,"span",38),t._uU(16,"~ "),t.qZA(),t.TgZ(17,"span",39),t._uU(18),t.qZA(),t._UZ(19,"br"),t.TgZ(20,"span",40)(21,"strong"),t._uU(22,"Actions/Jr"),t.qZA()()(),t.TgZ(23,"td")(24,"button",41),t.NdJ("click",function(){const r=t.CHM(i).$implicit,d=t.oxw(2);return t.KtG(d.seeSelectedChwData(r))}),t._uU(25,"D\xe9tails"),t.qZA()()()}if(2&e){const i=c.$implicit,s=t.oxw(2);t.xp6(4),t.Oqu(i.chw.name),t.xp6(3),t.Oqu(i.chw.external_id),t.xp6(6),t.Oqu(s.sum(i.data)),t.xp6(4),t.Gre("custom-action badge ",s.getVadPerDay(i).class,""),t.xp6(1),t.hij(" ",s.getVadPerDay(i).val," ")}}function k(e,c){if(1&e){const i=t.EpF();t.TgZ(0,"div",2)(1,"div",29)(2,"div",6),t._UZ(3,"div",30),t.qZA(),t.TgZ(4,"div",31)(5,"table",32),t.NdJ("click",function(){t.CHM(i);const a=t.oxw();return t.KtG(a.sort())}),t.TgZ(6,"thead")(7,"tr",33)(8,"th"),t._uU(9,"ASC"),t.qZA(),t.TgZ(10,"th"),t._uU(11,"Nbre Action/Jour"),t.qZA(),t._UZ(12,"th"),t.qZA()(),t.TgZ(13,"tbody"),t.YNc(14,G,26,7,"tr",34),t.qZA()()()()()}if(2&e){const i=t.oxw();t.xp6(14),t.Q6J("ngForOf",i.FinalChwsOutputData$)}}function j(e,c){if(1&e&&(t.TgZ(0,"div",54)(1,"div",55)(2,"h3",56),t._uU(3),t.qZA(),t.TgZ(4,"p",57)(5,"strong"),t._uU(6),t.qZA()()(),t.TgZ(7,"div",58),t._UZ(8,"i",59),t.qZA()()),2&e){const i=t.oxw().$implicit,s=t.oxw(2);t.xp6(3),t.Oqu(s.generateCount(i.value)),t.xp6(3),t.Oqu(s.capitaliseDataGiven(i.key,"_"," "))}}function V(e,c){if(1&e&&(t.TgZ(0,"div"),t.YNc(1,j,9,2,"div",53),t.qZA()),2&e){const i=c.$implicit,s=t.oxw(2);t.Tol(s.showClass(i)),t.xp6(1),t.Q6J("ngIf",s.isNumber(i.value))}}function B(e,c){if(1&e&&(t.TgZ(0,"div",42)(1,"div",43)(2,"div",44)(3,"div",45)(4,"h2"),t._uU(5),t._UZ(6,"br"),t.TgZ(7,"small"),t._uU(8),t.qZA()(),t.TgZ(9,"button",46)(10,"span",47),t._uU(11,"\xd7"),t.qZA()()(),t.TgZ(12,"div",48)(13,"div",49),t.YNc(14,V,2,4,"div",50),t.ALo(15,"keyvalue"),t.qZA()(),t.TgZ(16,"div",51)(17,"button",52),t._uU(18,"Fermer"),t.qZA()()()()()),2&e){const i=t.oxw();t.xp6(5),t.hij(" ",i.selectedChwData.chw.name," "),t.xp6(3),t.Oqu(i.selectedChwData.chw.external_id),t.xp6(6),t.Q6J("ngForOf",t.lcZ(15,3,i.selectedChwData.data))}}let K=(()=>{class e{constructor(i,s,a){this.auth=i,this.sync=s,this.router=a,this.allAggragateData=[],this.data_error_messages="",this.data_no_data_found=!1,this.FinalChwsOutputData$=[],this.selectedChwData=null,this.ChwsDataFromDbError="",this.Sources$=[],this.Districts$=[],this.Sites$=[],this.Chws$=[],this.Zones$=[],this.Patients$=[],this.Families$=[],this.chws$=[],this.sites$=[],this.days$=(0,n.w6)(24,1),this.day=22}createDataFilterFormGroup(){return new o.cw({start_date:new o.NI(this.initDate.start_date,[o.kI.required,o.kI.minLength(7)]),end_date:new o.NI(this.initDate.end_date,[o.kI.required,o.kI.minLength(7)]),sources:new o.NI(""),districts:new o.NI("",[]),sites:new o.NI("",[]),chws:new o.NI(""),day:new o.NI(this.day,[o.kI.required])})}identifyAggragateData(i,s){return s.total_vad}generateCount(i){return i.tonoudayo+i.dhis2}isNumber(i){return!isNaN(this.generateCount(i))}showClass(i){return this.isNumber(i)?"col-sm-6 col-6":""}ngOnInit(){this.currentUser=this.auth.currentUser(),this.chwOU=this.currentUser?.chw_found,(null==this.chwOU||!(0,n.Nf)(this.chwOU))&&this.router.navigate(["chws/select_orgunit"]),this.isLoading=!1,this.initDate=(0,U.vW)(),this.aggradateDataForm=this.createDataFilterFormGroup(),this.initDataFilted()}initAllData(){var i=this;return(0,u.Z)(function*(){i.isLoading=!0;const s=i.ParamsToFilter();i.initMsg="Chargement des Districts ...",i.sync.getDistrictsList(s).subscribe(function(){var a=(0,u.Z)(function*(r){200==r.status&&(i.Districts$=r.data),i.initMsg="Chargement des Sites ...",i.sync.getSitesList(s).subscribe(function(){var d=(0,u.Z)(function*(l){200==l.status&&(i.Sites$=l.data),i.genarateSites(),i.initMsg="Chargement des ASC ...",i.sync.getChwsList(s).subscribe(function(){var h=(0,u.Z)(function*(p){200==p.status&&(i.Chws$=p.data),i.genarateChws(),i.isLoading=!1});return function(p){return h.apply(this,arguments)}}(),h=>{i.isLoading=!1,console.log(h.error)})});return function(l){return d.apply(this,arguments)}}(),d=>{i.isLoading=!1,console.log(d.error)})});return function(r){return a.apply(this,arguments)}}(),a=>{i.isLoading=!1,console.log(a.error)})})()}sort(){sortTable("export_table")}capitaliseDataGiven(i,s,a){return(0,n.Fs)(i,s,a)}seeSelectedChwData(i){this.selectedChwData=i}genarateSites(){this.sites$=[],this.chws$=[];const i=(0,n.Dk)(this.aggradateDataForm.value.districts);if(this.aggradateDataForm.value.sites=[],this.aggradateDataForm.value.chws=[],(0,n.Nf)(i))for(let s=0;s<this.Sites$.length;s++){const a=this.Sites$[s];(0,n.Nf)(a)&&i.includes(a.district.id)&&this.sites$.push(a)}else this.sites$=[]}genarateChws(){const i=(0,n.Dk)(this.aggradateDataForm.value.sites);if(this.chws$=[],this.aggradateDataForm.value.chws=[],(0,n.Nf)(i))for(let s=0;s<this.Chws$.length;s++){const a=this.Chws$[s];(0,n.Nf)(a)&&i.includes(a.site.id)&&this.chws$.push(a)}else this.chws$=[]}ParamsToFilter(){const i=this.aggradateDataForm.value.start_date,s=this.aggradateDataForm.value.end_date,a=this.aggradateDataForm.value.sources,r=(0,n.Nf)(a)?(0,n.pb)(a):[],d=(0,n.pb)(this.chwOU?.site.district.id),l=(0,n.pb)(this.chwOU?.site.id),h=(0,n.pb)(this.chwOU?.id);return this.chws$=[this.chwOU],{start_date:i,end_date:s,sources:r,districts:d,sites:l,chws:h,withDhis2Data:!0}}returnEmptyArrayIfNul(i){return(0,n.Nf)(i)?i:[]}getVadPerDay(i){const s=this.sum(i.data),a=s/this.day;var r=a.toFixed(a<1?1:0);if(i.chw.name.includes("(R)")&&s<=0)return{val:r,class:""};var d="bg-success";return s>0&&a<10*this.day/this.day&&a>=5*this.day/this.day&&(d="bg-warning"),(0==s||s>0&&a<5*this.day/this.day)&&(d="bg-danger"),{val:r,class:d}}initDataFilted(i){this.isLoading=!0,this.selectedChwData=null,this.day=this.aggradateDataForm.value.day;const s=i??this.ParamsToFilter();this.defaultParams?.start_date!=s.start_date||this.defaultParams?.end_date!=s.end_date||this.defaultParams?.districts!=s.districts||this.defaultParams?.sites!=s.sites?(this.FinalChwsOutputData$=[],this.data_error_messages="",this.data_no_data_found=!1,this.ChwsDataFromDbError="",this.sync.ihChtDataPerChw(s).subscribe(a=>{this.response$=a,this.startTraitement(s)},a=>{this.isLoading=!1,this.ChwsDataFromDbError=a.toString()})):this.startTraitement(s)}sum(i){return i.total_vad.tonoudayo+i.total_vad.dhis2}startTraitement(i){this.isLoading=!0;const s=i??this.ParamsToFilter();200==this.response$.status?(this.FinalChwsOutputData$=this.response$.data,this.defaultParams=s,this.data_no_data_found=this.FinalChwsOutputData$.length<=0):(this.data_error_messages=this.response$.data.toString(),this.data_no_data_found=!0),this.isLoading=!1}}return e.\u0275fac=function(i){return new(i||e)(t.Y36(C.e),t.Y36(v._),t.Y36(w.F0))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-dashboard-2"]],decls:37,vars:8,consts:[[1,"content-header"],[1,"container-fluid"],[1,"card","card-info"],[1,"title",2,"text-align","center","color","blue"],[1,"overlay-wrapper"],["class","overlay",4,"ngIf"],[1,"card-header"],["novalidate","",3,"formGroup","ngSubmit"],[1,"row"],[1,"col-sm-2","col-6"],[1,"form-group"],["type","date","formControlName","start_date",1,"form-control"],["type","date","formControlName","end_date",1,"form-control"],["class","col-sm-2 col-6",4,"ngIf"],[2,"color","white"],["type","submit",1,"btn","btn-warning","form-control",3,"disabled"],[1,"fa","fa-floppy-o","fa-right"],[1,"content"],[1,"col-sm-5"],[4,"ngIf"],["class","card card-info",4,"ngIf"],["class","modal fade","id","modal-default",4,"ngIf"],[1,"overlay"],[1,"fas","fa-3x","fa-sync-alt","fa-spin"],[1,"text-bold","pt-2"],["formControlName","day",1,"form-control",2,"font-size","18px",3,"change"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"card-body"],[1,"card"],[1,"card-title"],[1,"card-body","p-0",2,"overflow-y","scroll!important"],["id","export_table",1,"table","table-sm","table-striped",2,"margin","auto",3,"click"],[1,"bg-info"],[4,"ngFor","ngForOf"],[1,"custom-badge",2,"font-size","16px"],[1,"custom-badge",2,"font-size","12px","color","gray"],[1,"info",2,"font-size","16px","color","blue"],[2,"font-size","18px"],[2,"font-size","33px","padding","1px"],[1,"info"],["data-toggle","modal","data-target","#modal-default",1,"btn","btn-info",2,"margin-top","15px","padding","2px!important","font-size","10px",3,"click"],["id","modal-default",1,"modal","fade"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body"],[1,"row","card-body"],[3,"class",4,"ngFor","ngForOf"],[1,"modal-footer","justify-content-between"],["id","close-modal","type","button","data-dismiss","modal",1,"btn","btn-default"],["style","border: 1px solid black;","class","small-box bg-info",4,"ngIf"],[1,"small-box","bg-info",2,"border","1px solid black"],[1,"inner"],[2,"font-size","45px","text-align","center"],[2,"font-size","20px","text-align","center"],[1,"icon"],[1,"ion","ion-stats-bars"]],template:function(i,s){1&i&&(t.TgZ(0,"section",0)(1,"div",1)(2,"div",2)(3,"h2",3),t._uU(4,"ASC Donn\xe9es d\xe9taill\xe9es"),t.qZA(),t.TgZ(5,"div",4),t.YNc(6,J,4,1,"div",5),t.TgZ(7,"div",6)(8,"form",7),t.NdJ("ngSubmit",function(){return s.initDataFilted()}),t.TgZ(9,"div",8)(10,"div",9)(11,"div",10)(12,"label"),t._uU(13,"Date D\xe9but"),t.qZA(),t._UZ(14,"input",11),t.qZA()(),t.TgZ(15,"div",9)(16,"div",10)(17,"label"),t._uU(18,"Date Fin"),t.qZA(),t._UZ(19,"input",12),t.qZA()(),t.YNc(20,z,6,1,"div",13),t.TgZ(21,"div",9)(22,"div",10)(23,"label",14),t._uU(24,"."),t.qZA(),t.TgZ(25,"button",15),t._uU(26," Charger "),t._UZ(27,"span",16),t.qZA()()()()()()()(),t.TgZ(28,"section",17)(29,"div",1)(30,"div",18),t.YNc(31,E,4,1,"h2",19),t.YNc(32,Q,4,0,"h2",19),t.qZA(),t.YNc(33,k,15,1,"div",20),t.qZA()(),t.YNc(34,B,19,5,"div",21),t._UZ(35,"br")(36,"br"),t.qZA()()),2&i&&(t.xp6(6),t.Q6J("ngIf",s.isLoading),t.xp6(2),t.Q6J("formGroup",s.aggradateDataForm),t.xp6(12),t.Q6J("ngIf",s.days$.length>0),t.xp6(5),t.Q6J("disabled",!s.aggradateDataForm.valid),t.xp6(6),t.Q6J("ngIf",""!=s.data_error_messages),t.xp6(1),t.Q6J("ngIf",1==s.data_no_data_found),t.xp6(1),t.Q6J("ngIf",""==s.data_error_messages&&s.FinalChwsOutputData$.length>0),t.xp6(1),t.Q6J("ngIf",null!=s.selectedChwData))},dependencies:[m.sg,m.O5,o._Y,o.YN,o.Kr,o.Fj,o.EJ,o.JJ,o.JL,o.sg,o.u,m.Nd],styles:[".custom-badge[_ngcontent-%COMP%]{font-size:18px;color:#000}.custom-action[_ngcontent-%COMP%]{font-size:25px;color:#000;text-align:center!important}.info[_ngcontent-%COMP%]{text-align:center!important}.box[_ngcontent-%COMP%]{width:600px;height:300px;border:1px solid black;padding:2px 4px;overflow-y:scroll;overflow-x:auto}.log[_ngcontent-%COMP%]{margin-top:8px;font-family:monospace}input[_ngcontent-%COMP%], select[_ngcontent-%COMP%], label[_ngcontent-%COMP%], .submit[_ngcontent-%COMP%], .title[_ngcontent-%COMP%]{margin-bottom:-10px!important}"]}),e})();var R=g(6083);function X(e,c){if(1&e&&(t.TgZ(0,"div",8),t._UZ(1,"i",9),t.TgZ(2,"div",10),t._uU(3),t.qZA()()),2&e){const i=t.oxw();t.xp6(3),t.hij(" ",i.initMsg,"")}}function H(e,c){if(1&e&&(t.TgZ(0,"div",11)(1,"div")(2,"div",12)(3,"h3",13),t._uU(4),t.qZA(),t.TgZ(5,"p")(6,"strong"),t._uU(7),t.qZA()()(),t.TgZ(8,"div",14),t._UZ(9,"i"),t.qZA()()()),2&e){const i=c.$implicit;t.xp6(1),t.Gre("small-box ",i.color,""),t.xp6(3),t.Oqu(i.count),t.xp6(3),t.Oqu(i.label),t.xp6(2),t.Gre("ion ",i.icon,"")}}let W=(()=>{class e{constructor(i,s,a,r){this.auth=i,this.db=s,this.sync=a,this.router=r,this.allAggragateData=[],this.Districts$=[],this.Sites$=[],this.Chws$=[],this.Zones$=[],this.Patients$=[],this.Families$=[],this.chws$=[],this.sites$=[],this.districtsChwsCount=0,this.sitesChwsCount=0,this.zonesChwsCount=0,this.patientsChwsCount=0,this.patientsCibleChwsCount=0,this.familiesChwsCount=0,this.chwsCount=0}createDataFilterFormGroup(){return new o.cw({districts:new o.NI("",[]),sites:new o.NI("",[]),chws:new o.NI("")})}identifyAggragateData(i,s){return s.label}ngOnInit(){this.currentUser=this.auth.currentUser(),this.chwOU=this.currentUser?.chw_found,(null==this.chwOU||!(0,n.Nf)(this.chwOU))&&this.router.navigate(["chws/select_orgunit"]),this.isLoading=!1,this.aggradateDataForm=this.createDataFilterFormGroup(),this.initAllData(!1)}initAllData(i=!1){var s=this;return(0,u.Z)(function*(){const a=s.ParamsToFilter();1==i?(s.isLoading=!0,s.initMsg="Chargement des Districts ...",s.sync.getDistrictsList(a).subscribe(function(){var r=(0,u.Z)(function*(d){200==d.status&&(s.Districts$=d.data),s.initMsg="Chargement des Sites ...",s.sync.getSitesList(a).subscribe(function(){var l=(0,u.Z)(function*(h){200==h.status&&(s.Sites$=h.data),s.initMsg="Chargement des ASC ...",s.sync.getChwsList(a).subscribe(function(){var p=(0,u.Z)(function*(_){200==_.status&&(s.Chws$=_.data)});return function(_){return p.apply(this,arguments)}}(),p=>{s.isLoading=!1})});return function(h){return l.apply(this,arguments)}}(),l=>{s.isLoading=!1})});return function(d){return r.apply(this,arguments)}}(),r=>{s.isLoading=!1})):s.isLoading=!1,0==i?(s.isLoading=!0,s.initMsg="Chargement des Zones ...",s.sync.getZonesList(a).subscribe(function(){var r=(0,u.Z)(function*(d){200==d.status&&(s.Zones$=d.data),s.initMsg="Chargement des Familles ...",s.sync.getFamilyList(a).subscribe(function(){var l=(0,u.Z)(function*(h){200==h.status&&(s.Families$=h.data),s.initMsg="Chargement des Patients ...",s.sync.getPatientsList(a).subscribe(function(){var p=(0,u.Z)(function*(_){200==_.status&&(s.Patients$=_.data),s.initDataFilted(a)});return function(_){return p.apply(this,arguments)}}(),p=>{s.isLoading=!1})});return function(h){return l.apply(this,arguments)}}(),l=>{s.isLoading=!1})});return function(d){return r.apply(this,arguments)}}(),r=>{s.isLoading=!1})):s.isLoading=!1})()}formatHostName(i){return i.replace(".org","").replace("-",".").trim()}genarateSites(){this.sites$=[],this.chws$=[];const i=(0,n.Dk)(this.aggradateDataForm.value.districts);if(this.aggradateDataForm.value.sites=[],this.aggradateDataForm.value.chws=[],(0,n.Nf)(i))for(let s=0;s<this.Sites$.length;s++){const a=this.Sites$[s];(0,n.Nf)(a)&&i.includes(a.district.id)&&this.sites$.push(a)}else this.sites$=[]}genarateChws(){const i=(0,n.Dk)(this.aggradateDataForm.value.sites);if(this.chws$=[],this.aggradateDataForm.value.chws=[],(0,n.Nf)(i))for(let s=0;s<this.Chws$.length;s++){const a=this.Chws$[s];(0,n.Nf)(a)&&i.includes(a.site.id)&&this.chws$.push(a)}else this.chws$=[]}ParamsToFilter(){return{districts:(0,n.pb)(this.chwOU?.site.district.id),sites:(0,n.pb)(this.chwOU?.site.id),chws:(0,n.pb)(this.chwOU?.id),withDhis2Data:!1}}initDataFilted(i){this.isLoading=!0;const{chws:r,sites:d,districts:l}=i??this.ParamsToFilter();this.districtsChwsCount=0,this.sitesChwsCount=0,this.familiesChwsCount=0,this.patientsChwsCount=0,this.patientsCibleChwsCount=0,this.zonesChwsCount=0,this.chwsCount=0,this.allAggragateData=[];for(let b=0;b<this.Families$.length;b++){const f=this.Families$[b];(0,n.Nf)(l)&&(0,n.Nf)(d)&&(0,n.Nf)(r)?l?.includes(f.site.district.id)&&d?.includes(f.site.id)&&r?.includes(f.zone.chw_id)&&this.familiesChwsCount++:(0,n.Nf)(l)&&(0,n.Nf)(d)&&!(0,n.Nf)(r)?l?.includes(f.site.district.id)&&d?.includes(f.site.id)&&this.familiesChwsCount++:(!(0,n.Nf)(l)||(0,n.Nf)(d)||(0,n.Nf)(r)||l?.includes(f.site.district.id))&&this.familiesChwsCount++}for(let b=0;b<this.Patients$.length;b++){const f=this.Patients$[b],D=(0,n.mP)(f).is_in_cible;(0,n.Nf)(l)&&(0,n.Nf)(d)&&(0,n.Nf)(r)?l?.includes(f.site.district.id)&&d?.includes(f.site.id)&&r?.includes(f.zone.chw_id)&&(this.patientsChwsCount++,D&&this.patientsCibleChwsCount++):(0,n.Nf)(l)&&(0,n.Nf)(d)&&!(0,n.Nf)(r)?l?.includes(f.site.district.id)&&d?.includes(f.site.id)&&(this.patientsChwsCount++,D&&this.patientsCibleChwsCount++):(!(0,n.Nf)(l)||(0,n.Nf)(d)||(0,n.Nf)(r)||l?.includes(f.site.district.id))&&(this.patientsChwsCount++,D&&this.patientsCibleChwsCount++)}let h={label:(0,n.Fs)("total_famille_enregistre","_"," "),count:this.familiesChwsCount,icon:"ion-person-add",color:"bg-danger",detailUrl:"/view-chws-data/dashboard1"},p={label:(0,n.Fs)("total_patient_enregistre","_"," "),count:this.patientsChwsCount,icon:"ion-person-add",color:"bg-success",detailUrl:"/view-chws-data/dashboard1"},_={label:(0,n.Fs)("total_patient_cible","_"," "),count:this.patientsCibleChwsCount,icon:"ion-person-add",color:"bg-warning",detailUrl:"/view-chws-data/dashboard1"};this.allAggragateData.push(h),this.allAggragateData.push(p),this.allAggragateData.push(_),this.initMsg="",this.isLoading=!1}}return e.\u0275fac=function(i){return new(i||e)(t.Y36(C.e),t.Y36(R.p),t.Y36(v._),t.Y36(w.F0))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-dashboard-3"]],decls:11,vars:3,consts:[[1,"content-header"],[1,"container-fluid"],[1,"card","card-warning"],[2,"text-align","center"],[1,"overlay-wrapper"],["class","overlay",4,"ngIf"],[1,"row","card-body"],["class","col-sm-3 col-6",4,"ngFor","ngForOf","ngForTrackBy"],[1,"overlay"],[1,"fas","fa-3x","fa-sync-alt","fa-spin"],[1,"text-bold","pt-2"],[1,"col-sm-3","col-6"],[1,"inner"],[2,"font-size","40px"],[1,"icon"]],template:function(i,s){1&i&&(t.TgZ(0,"section",0)(1,"div",1)(2,"div",2)(3,"h1",3),t._uU(4,"Effectifs des patients"),t.qZA(),t.TgZ(5,"div",4),t.YNc(6,X,4,1,"div",5),t.qZA()(),t.TgZ(7,"div",6),t.YNc(8,H,10,8,"div",7),t.qZA(),t._UZ(9,"br")(10,"br"),t.qZA()()),2&i&&(t.xp6(6),t.Q6J("ngIf",s.isLoading),t.xp6(2),t.Q6J("ngForOf",s.allAggragateData)("ngForTrackBy",s.identifyAggragateData))},dependencies:[m.sg,m.O5],styles:["input[_ngcontent-%COMP%], select[_ngcontent-%COMP%], label[_ngcontent-%COMP%], .submit[_ngcontent-%COMP%], .title[_ngcontent-%COMP%]{margin-bottom:-10px!important}"]}),e})();function tt(e,c){if(1&e&&(t.TgZ(0,"div",16),t._UZ(1,"i",17),t.TgZ(2,"div",18),t._uU(3),t.qZA()()),2&e){const i=t.oxw();t.xp6(3),t.hij(" ",i.initMsg,"")}}function it(e,c){if(1&e&&(t.TgZ(0,"tr")(1,"td")(2,"b"),t._uU(3),t.qZA()(),t.TgZ(4,"td"),t._uU(5),t.qZA(),t.TgZ(6,"td"),t._uU(7),t.qZA(),t.TgZ(8,"td"),t._uU(9),t.qZA()()),2&e){const i=c.$implicit;t.xp6(3),t.Oqu(i.family.name),t.xp6(2),t.Oqu(i.data.visit_in_day),t.xp6(2),t.Oqu(i.data.all_visit),t.xp6(1),t.Tol(i.data.isVisited?"success0":"danger0"),t.xp6(1),t.hij(" ",i.data.isVisited?"Visit\xe9":"Non "," ")}}function st(e,c){if(1&e&&(t.TgZ(0,"section",19)(1,"div",20)(2,"div",6),t._UZ(3,"div",21),t.qZA(),t.TgZ(4,"div",22)(5,"div",23),t._uU(6," Total Familles: "),t.TgZ(7,"strong",24),t._uU(8),t.qZA()(),t.TgZ(9,"div",25),t._uU(10," Total Familles Visit\xe9s: "),t.TgZ(11,"strong",24),t._uU(12),t.qZA()(),t.TgZ(13,"div",26),t._uU(14," Total Famille Non Visit\xe9s: "),t.TgZ(15,"strong",24),t._uU(16),t.qZA()()(),t.TgZ(17,"div",27)(18,"table",28)(19,"thead")(20,"tr",29)(21,"th",30),t._uU(22,"Nom Famille"),t.qZA(),t.TgZ(23,"th",31),t._uU(24," Visit 1/jour"),t.qZA(),t.TgZ(25,"th",32),t._uU(26," #Action Total"),t.qZA(),t.TgZ(27,"th",33),t._uU(28," #Famille Visit\xe9"),t.qZA()()(),t.TgZ(29,"tbody"),t.YNc(30,it,10,7,"tr",34),t.qZA()()()()()),2&e){const i=t.oxw();t.xp6(8),t.Oqu(i.ChwsDataInfos$.family_count),t.xp6(4),t.Oqu(i.ChwsDataInfos$.total_visited),t.xp6(4),t.Oqu(i.ChwsDataInfos$.total_not_visited),t.xp6(14),t.Q6J("ngForOf",i.ChwsDataInfos$.detail)}}let et=(()=>{class e{constructor(i,s,a){this.auth=i,this.sync=s,this.router=a,this.Districts$=[],this.Zones$=[],this.Sites$=[],this.zones$=[],this.sites$=[],this.responseMessage=""}createDataFilterFormGroup(){return new o.cw({start_date:new o.NI(this.initDate.start_date,[o.kI.required,o.kI.minLength(7)]),end_date:new o.NI(this.initDate.end_date,[o.kI.required,o.kI.minLength(7)]),districts:new o.NI("",[]),sites:new o.NI("",[]),zones:new o.NI("",[])})}ngOnInit(){this.currentUser=this.auth.currentUser(),this.chwOU=this.currentUser?.chw_found,(null==this.chwOU||!(0,n.Nf)(this.chwOU))&&this.router.navigate(["chws/select_orgunit"]),this.isLoading=!1,this.initDate=(0,U.vW)(),this.aggradateDataForm=this.createDataFilterFormGroup(),this.initDataFilted()}initAllData(){var i=this;return(0,u.Z)(function*(){i.isLoading=!0,i.initMsg="Chargement des Districts ...",i.sync.getDistrictsList().subscribe(function(){var s=(0,u.Z)(function*(a){200==a.status&&(i.Districts$=a.data),i.initMsg="Chargement des Sites ...",i.sync.getSitesList().subscribe(function(){var r=(0,u.Z)(function*(d){200==d.status&&(i.Sites$=d.data),i.initMsg="Chargement des Zones ...",i.sync.getZonesList().subscribe(function(){var l=(0,u.Z)(function*(h){200==h.status&&(i.Zones$=h.data),i.isLoading=!1,i.initMsg=""});return function(h){return l.apply(this,arguments)}}(),l=>{i.isLoading=!1,console.log(l.error)})});return function(d){return r.apply(this,arguments)}}(),r=>{i.isLoading=!1,console.log(r.error)})});return function(a){return s.apply(this,arguments)}}(),s=>{i.isLoading=!1,console.log(s.error)})})()}generateSites(){this.sites$=[],this.zones$=[];const i=this.aggradateDataForm.value.districts;if(this.aggradateDataForm.value.sites="",this.aggradateDataForm.value.zones=[],(0,n.Nf)(i))for(let s=0;s<this.Sites$.length;s++){const a=this.Sites$[s];(0,n.Nf)(a)&&i.includes(a.district.id)&&this.sites$.push(a)}else this.sites$=[]}generateZones(){const i=(0,n.pb)(this.aggradateDataForm.value.sites);if(this.zones$=[],this.aggradateDataForm.value.zones=[],(0,n.Nf)(i))for(let s=0;s<this.Zones$.length;s++){const a=this.Zones$[s];(0,n.Nf)(a)&&i.includes(a.site.id)&&this.zones$.push(a)}else this.zones$=[]}ParamsToFilter(){return{start_date:this.aggradateDataForm.value.start_date,end_date:this.aggradateDataForm.value.end_date,districts:(0,n.pb)(this.chwOU?.site.district.id),sites:(0,n.pb)(this.chwOU?.site.id),zones:(0,n.pb)(this.chwOU?.zone.id),withDhis2Data:!1}}initDataFilted(i){this.initMsg="Loading Data ...",this.isLoading=!0,this.ChwsDataInfos$=void 0,this.sync.getDataInformations(i??this.ParamsToFilter()).subscribe(s=>{200==s.status?this.ChwsDataInfos$=s.data:this.responseMessage=s.data,this.isLoading=!1},s=>{this.isLoading=!1,console.log(s)})}}return e.\u0275fac=function(i){return new(i||e)(t.Y36(C.e),t.Y36(v._),t.Y36(w.F0))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-dashboard-4"]],decls:28,vars:4,consts:[[1,"content-header"],[1,"container-fluid"],[1,"card","card-info"],[2,"text-align","center"],[1,"overlay-wrapper"],["class","overlay",4,"ngIf"],[1,"card-header"],["novalidate","",3,"formGroup","ngSubmit"],[1,"row"],[1,"col-sm-2","col-6"],[1,"form-group"],["type","date","formControlName","start_date",1,"form-control"],["type","date","formControlName","end_date",1,"form-control"],["type","submit",1,"btn","btn-warning","form-control",3,"disabled"],[1,"fa","fa-floppy-o","fa-right"],["class","content",4,"ngIf"],[1,"overlay"],[1,"fas","fa-3x","fa-sync-alt","fa-spin"],[1,"text-bold","pt-2"],[1,"content"],[1,"card",2,"overflow-y","scroll!important"],[1,"card-title"],[1,"row",2,"margin-top","15px","padding","0px 40px"],[1,"col-sm-4","col-12",2,"font-weight","bold","padding","10px 20px","background-color","rgb(233, 189, 131)"],[2,"font-size","18px"],[1,"col-sm-4","col-12",2,"font-weight","bold","padding","10px 20px","background-color","rgb(190, 207, 159)"],[1,"col-sm-4","col-12",2,"font-weight","bold","padding","10px 20px","background-color","rgb(218, 177, 235)"],[1,"card-body"],["border","1 solid","id","export_table",1,"table","table-bordered"],[1,"bg-info"],["data-order","desc","data-name","family.name",2,"width","50px"],["data-order","desc","data-name","data.visit_in_day",2,"width","40px"],["data-order","desc","data-name","data.all_visit",2,"width","40px"],["data-order","desc","data-name","data.isVisited",2,"width","40px"],[4,"ngFor","ngForOf"]],template:function(i,s){1&i&&(t.TgZ(0,"section",0)(1,"div",1)(2,"div",2)(3,"h1",3),t._uU(4,"D\xe9tails Visite M\xe9nages"),t.qZA(),t.TgZ(5,"div",4),t.YNc(6,tt,4,1,"div",5),t.TgZ(7,"div",6)(8,"form",7),t.NdJ("ngSubmit",function(){return s.initDataFilted()}),t.TgZ(9,"div",8)(10,"div",9)(11,"div",10)(12,"label"),t._uU(13,"Date D\xe9but"),t.qZA(),t._UZ(14,"input",11),t.qZA()(),t.TgZ(15,"div",9)(16,"div",10)(17,"label"),t._uU(18,"Date Fin"),t.qZA(),t._UZ(19,"input",12),t.qZA()(),t.TgZ(20,"div",9)(21,"div",10)(22,"label"),t._uU(23,"."),t.qZA(),t.TgZ(24,"button",13),t._uU(25," OK "),t._UZ(26,"span",14),t.qZA()()()()()()()()()(),t.YNc(27,st,31,4,"section",15)),2&i&&(t.xp6(6),t.Q6J("ngIf",s.isLoading),t.xp6(2),t.Q6J("formGroup",s.aggradateDataForm),t.xp6(16),t.Q6J("disabled",!s.aggradateDataForm.valid),t.xp6(3),t.Q6J("ngIf",null!=s.ChwsDataInfos$&&null!=s.ChwsDataInfos$))},dependencies:[m.sg,m.O5,o._Y,o.Fj,o.JJ,o.JL,o.sg,o.u],styles:[".info[_ngcontent-%COMP%]{color:#00f;font-weight:bolder}.warning[_ngcontent-%COMP%]{color:orange;font-size:large;font-weight:bolder}.primary[_ngcontent-%COMP%]{color:purple;font-size:large;font-weight:bolder}.secondary[_ngcontent-%COMP%]{color:#09e4bf;font-size:large;font-weight:bolder}.success[_ngcontent-%COMP%]{color:green;font-size:large;font-weight:bolder}.success0[_ngcontent-%COMP%]{color:green;font-weight:bolder}.danger[_ngcontent-%COMP%]{color:red;font-size:large;font-weight:bolder}.danger0[_ngcontent-%COMP%]{color:red;font-weight:bolder}.line[_ngcontent-%COMP%]{color:#000;font-size:large;font-weight:bolder}"]}),e})();var Z=g(3514);const at=[{path:"",redirectTo:"dash1",pathMatch:"full"},{path:"dashboard1",component:P,canActivate:[Z.o],data:{href:"dashboard1",icon:"fa fa-user",label:"Dashboard-1",title:"Activit\xe9 des ASC"}},{path:"dashboard2",component:K,canActivate:[Z.o],data:{href:"dashboard2",icon:"fa fa-user",label:"Dashboard-2",title:"ASC Donn\xe9es d\xe9taill\xe9es"}},{path:"dashboard3",component:W,canActivate:[Z.o],data:{href:"dashboard3",icon:"fa fa-user",label:"Dashboard-3",title:"Effectifs des patients"}},{path:"dashboard4",component:et,canActivate:[Z.o],data:{href:"dashboard4",icon:"fa fa-user",label:"Dashboard-4",title:"D\xe9tails Visite M\xe9nages"}},{path:"select_orgunit",component:N,canActivate:[Z.o],data:{href:"select_orgunit",icon:"fa fa-user",label:"Choisir OrgUnit",title:"Choisir OrgUnit"}}];let nt=(()=>{class e{}return e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[w.Bz.forChild(at),w.Bz]}),e})(),ot=(()=>{class e{}return e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[m.ez,o.UX,nt]}),e})()}}]);