"use strict";(self.webpackChunkih_portal=self.webpackChunkih_portal||[]).push([[610],{610:(st,F,b)=>{b.r(F),b.d(F,{DashboardsModule:()=>tt});var N=b(8692),m=b(92),x=b(7509),q=b(8968),y=b(8239),l=b(8629),t=b(4537),D=b(8171),U=b(1815);function S(o,f){if(1&o&&(t.TgZ(0,"div",22),t._UZ(1,"i",23),t.TgZ(2,"div",24),t._uU(3),t.qZA()()),2&o){const e=t.oxw();t.xp6(3),t.hij(" ",e.initMsg,"")}}function M(o,f){if(1&o&&(t.TgZ(0,"option",27),t._uU(1),t.qZA()),2&o){const e=f.$implicit,s=t.oxw(2);t.s9C("value",e),t.xp6(1),t.hij(" ",s.formatHostName(e)," ")}}function J(o,f){if(1&o){const e=t.EpF();t.TgZ(0,"select",25),t.NdJ("change",function(){t.CHM(e);const p=t.oxw();return t.KtG(p.genarateSites())}),t.YNc(1,M,2,2,"option",26),t.qZA()}if(2&o){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.sourcesList)}}function E(o,f){1&o&&t._UZ(0,"select",28)}function Y(o,f){if(1&o&&(t.TgZ(0,"option",27),t._uU(1),t.qZA()),2&o){const e=f.$implicit;t.s9C("value",e.id),t.xp6(1),t.hij(" ",e.name," ")}}function G(o,f){if(1&o){const e=t.EpF();t.TgZ(0,"select",29),t.NdJ("change",function(){t.CHM(e);const p=t.oxw();return t.KtG(p.genarateChws())}),t.YNc(1,Y,2,2,"option",26),t.qZA()}if(2&o){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.sitesList)}}function Q(o,f){1&o&&t._UZ(0,"select",28)}function R(o,f){if(1&o&&(t.TgZ(0,"option",27),t._uU(1),t.qZA()),2&o){const e=f.$implicit;t.s9C("value",e.id),t.xp6(1),t.hij(" ",e.name," ")}}function k(o,f){if(1&o&&(t.TgZ(0,"select",30),t.YNc(1,R,2,2,"option",26),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.chwsList)}}function z(o,f){1&o&&t._UZ(0,"select",28)}function j(o,f){if(1&o&&(t.TgZ(0,"div",15)(1,"div")(2,"div",31)(3,"h3",32),t._uU(4),t.qZA(),t.TgZ(5,"p",33)(6,"strong"),t._uU(7),t.qZA()()(),t.TgZ(8,"div",34),t._UZ(9,"i"),t.qZA()()()),2&o){const e=f.$implicit;t.xp6(1),t.Gre("small-box ",e.color,""),t.xp6(3),t.Oqu(e.count),t.xp6(3),t.Oqu(e.label),t.xp6(2),t.Gre("ion ",e.icon,"")}}function B(o,f){if(1&o&&(t.TgZ(0,"div",18),t._UZ(1,"i",19),t.TgZ(2,"div",20),t._uU(3),t.qZA()()),2&o){const e=t.oxw();t.xp6(3),t.hij(" ",e.initMsg,"")}}function H(o,f){if(1&o&&(t.TgZ(0,"option",21),t._uU(1),t.qZA()),2&o){const e=f.$implicit;t.s9C("value",e.id),t.xp6(1),t.hij(" ",e.name," ")}}function V(o,f){if(1&o&&(t.TgZ(0,"tr")(1,"td",34),t._uU(2),t.qZA(),t.TgZ(3,"td",34),t._uU(4),t.qZA(),t.TgZ(5,"td",35),t._uU(6),t.qZA(),t.TgZ(7,"td",35),t._uU(8),t.qZA(),t.TgZ(9,"td",36),t._uU(10),t.qZA(),t.TgZ(11,"td",36),t._uU(12),t.qZA(),t.TgZ(13,"td",35),t._uU(14),t.qZA(),t.TgZ(15,"td",35),t._uU(16),t.qZA(),t.TgZ(17,"td",36),t._uU(18),t.qZA(),t.TgZ(19,"td",36),t._uU(20),t.qZA(),t.TgZ(21,"td",37),t._uU(22),t.qZA(),t.TgZ(23,"td",37),t._uU(24),t.qZA(),t.TgZ(25,"td",38)(26,"strong"),t._uU(27),t.qZA()(),t.TgZ(28,"td"),t._uU(29),t.qZA()()),2&o){const e=f.$implicit;t.xp6(2),t.Oqu(e.Code),t.xp6(2),t.Oqu(e.Name),t.xp6(2),t.Oqu(e.Pcime),t.xp6(2),t.Oqu(e.PcimeDhis2),t.xp6(2),t.Oqu(e.MaternellePf),t.xp6(2),t.Oqu(e.MaternellePfDhis2),t.xp6(2),t.Oqu(e.Consultation),t.xp6(2),t.Oqu(e.ConsultationDhis),t.xp6(2),t.Oqu(e.Recherche),t.xp6(2),t.Oqu(e.RechercheDhis),t.xp6(2),t.Oqu(e.Total),t.xp6(2),t.Oqu(e.TotalDhis),t.xp6(3),t.Oqu(e.TotalDiff),t.xp6(1),t.Gre("bg-",e.Ratio.color,""),t.xp6(1),t.hij("",e.Ratio.value," %")}}function K(o,f){if(1&o){const e=t.EpF();t.TgZ(0,"section",22)(1,"div",23)(2,"div",5)(3,"h3",24)(4,"button",25),t.NdJ("click",function(){t.CHM(e);const p=t.oxw();return t.KtG(p.initTable())}),t._uU(5,"Generate Table"),t.qZA()()(),t.TgZ(6,"div",26)(7,"table",27)(8,"thead")(9,"tr",28)(10,"th",29),t._uU(11,"Code ASC"),t.qZA(),t.TgZ(12,"th",30),t._uU(13,"Nom ASC"),t.qZA(),t.TgZ(14,"th",31),t._uU(15,"Pcime"),t.qZA(),t.TgZ(16,"th",31),t._uU(17,"Maternel & PF"),t.qZA(),t.TgZ(18,"th",31),t._uU(19,"Consultation"),t.qZA(),t.TgZ(20,"th",31),t._uU(21,"Recherche"),t.qZA(),t.TgZ(22,"th",31),t._uU(23,"Total"),t.qZA(),t.TgZ(24,"th",29),t._uU(25,"Diff"),t.qZA(),t.TgZ(26,"th",29),t._uU(27,"Ratio"),t.qZA()(),t.TgZ(28,"tr",28)(29,"th",32),t._uU(30,"APPLI"),t.qZA(),t.TgZ(31,"th",32),t._uU(32,"DHIS2"),t.qZA(),t.TgZ(33,"th",32),t._uU(34,"APPLI"),t.qZA(),t.TgZ(35,"th",32),t._uU(36,"DHIS2"),t.qZA(),t.TgZ(37,"th",32),t._uU(38,"APPLI"),t.qZA(),t.TgZ(39,"th",32),t._uU(40,"DHIS2"),t.qZA(),t.TgZ(41,"th",32),t._uU(42,"APPLI"),t.qZA(),t.TgZ(43,"th",32),t._uU(44,"DHIS2"),t.qZA(),t.TgZ(45,"th",32),t._uU(46,"APPLI"),t.qZA(),t.TgZ(47,"th",32),t._uU(48,"DHIS2"),t.qZA()()(),t.TgZ(49,"tbody"),t.YNc(50,V,30,17,"tr",33),t.qZA()()()()()}if(2&o){const e=t.oxw();t.xp6(50),t.Q6J("ngForOf",e.bodyData)("ngForTrackBy",e.identifyBodyData)}}const W=[{path:"",redirectTo:"dash1",pathMatch:"full"},{path:"dash1",component:(()=>{class o{constructor(e,s){this.db=e,this.sync=s,this.allAggragateData=[],this.options={Chart:{type:"area",height:700},title:{text:"Donn\xe9es par ASC"},credits:{enabled:!1},xAxis:{categories:["ASC1","ASC2","ASC3","ASC4","ASC5","ASC6","ASC7"],tickmarkPlacement:"on",title:{enabled:!0}},yAxis:{categories:[],max:5268,min:0,tickmarkPlacement:"on",title:{enabled:!1}},series:[{name:"Recherche Active",data:[502,635,809,947,1402,3634,5268]},{name:"Pcime",data:[163,203,276,408,547,729,628]},{name:"Maternel",data:[18,31,54,156,339,818,1201]}]},this.home_actions_forms=["pcime_c_asc","pcime_c_referral","pcime_c_followup","malnutrition_followup","pregnancy_family_planning","prenatal_followup","postnatal_followup","newborn_followup","home_visit","women_emergency_followup","fp_follow_up_renewal"],this.vaccination_forms=["vaccination"],this.consultations_followup_forms=["pcime_c_asc","pregnancy_family_planning","pcime_c_followup","pcime_c_referral","malnutrition_followup","prenatal_followup","postnatal_followup","newborn_followup","women_emergency_followup","fp_follow_up_renewal"],this.consultations_forms=["pcime_c_asc","pregnancy_family_planning"],this.followup_forms=["pcime_c_followup","pcime_c_referral","malnutrition_followup","prenatal_followup","postnatal_followup","newborn_followup","women_emergency_followup","fp_follow_up_renewal"],this.all_child_forms=["pcime_c_asc","pcime_c_followup","newborn_followup","malnutrition_followup"],this.child_followup_forms=["pcime_c_followup","newborn_followup","malnutrition_followup"],this.allForms=["pcime_c_asc","vaccination_followup","pregnancy_family_planning","delivery","home_visit","newborn_followup","pcime_c_followup","malnutrition_followup","postnatal_followup","prenatal_followup","pcime_c_referral","fp_follow_up_renewal"],this.AllChwsDataFromDbList=[],this.sourcesList=[],this.allChwsList=[],this.allSitesList=[],this.chwsList=[],this.sitesList=[],this.allZonesList=[],this.allPatientsList=[],this.allFamiliesList=[],this.chwsCount=0,this.sitesChwsCount=0,this.zonesChwsCount=0,this.patientsChwsCount=0,this.familiesChwsCount=0}createDataFilterFormGroup(){return new m.cw({start_date:new m.NI(this.initDate.start_date,[m.kI.required,m.kI.minLength(7)]),end_date:new m.NI(this.initDate.end_date,[m.kI.required,m.kI.minLength(7)]),sites:new m.NI(""),chws:new m.NI(""),sources:new m.NI("")})}identifyAggragateData(e,s){return s.label}ngOnInit(){this.isLoading=!1,this.initDate=l.E.startEnd21and20Date(),this.aggradateDataForm=this.createDataFilterFormGroup(),this.initAllData()}initAllData(){var e=this;return(0,y.Z)(function*(){yield e.db.getAllByParams(e.db.sites),e.isLoading=!0,e.initMsg="Chargement des Sites ...",e.sync.getSitesList().subscribe(function(){var p=(0,y.Z)(function*(d){e.allSitesList=d;for(let a=0;a<e.allSitesList.length;a++){const c=e.allSitesList[a].source;null!=c&&""!=c&&(e.sourcesList.includes(c)||e.sourcesList.push(c))}e.initMsg="Chargement des Zones ...",e.sync.getZoneList().subscribe(a=>{e.allZonesList=a,e.initMsg="Chargement des ASC ...",e.sync.getChwsList().subscribe(function(){var c=(0,y.Z)(function*(i){e.allChwsList=i,e.initDataFilted()});return function(i){return c.apply(this,arguments)}}(),c=>{e.isLoading=!1,console.log(c.error)})},a=>{e.isLoading=!1,console.log(a.error)})});return function(d){return p.apply(this,arguments)}}(),p=>{e.isLoading=!1,console.log(p.error)})})()}formatHostName(e){return e.replace(".org","").replace("-",".").trim()}genarateSites(){const e=this.aggradateDataForm.value.sources;if(this.sitesList=[],this.chwsList=[],this.aggradateDataForm.value.sites=[],this.aggradateDataForm.value.chws=[],l.F.isNotNull(e))for(let s=0;s<this.allSitesList.length;s++){const p=this.allSitesList[s];l.F.isNotNull(p)&&e.includes(p.source)&&this.sitesList.push(p)}else this.sitesList=this.allSitesList}genarateChws(){const e=this.aggradateDataForm.value.sites;if(this.chwsList=[],this.aggradateDataForm.value.chws=[],l.F.isNotNull(e))for(let s=0;s<this.allChwsList.length;s++){const p=this.allChwsList[s];l.F.isNotNull(p)&&e.includes(p.site.id)&&this.chwsList.push(p)}else this.chwsList=this.allChwsList}returnEmptyArrayIfNul(e){return l.F.isNotNull(e)?e:[]}initDataFilted(){const e=this.aggradateDataForm.value.start_date,s=this.aggradateDataForm.value.end_date,p=this.returnEmptyArrayIfNul(this.aggradateDataForm.value.chws),d=this.returnEmptyArrayIfNul(this.aggradateDataForm.value.sites);var c={start_date:e,end_date:s,sources:this.returnEmptyArrayIfNul(this.aggradateDataForm.value.sources),chws:p,sites:d,district:[]};this.isLoading=!0,this.initDate.start_date==e&&this.initDate.end_date==s&&0!=this.AllChwsDataFromDbList?.length?this.getAllAboutData(c):(this.initDate.start_date=e,this.initDate.end_date=s,this.initMsg=`Chargement des donn\xe9es du ${l.E.getDateInFormat(c.start_date,0,"fr")} au ${l.E.getDateInFormat(c.end_date,0,"fr")}`,this.sync.getAllData(c).subscribe(i=>{this.AllChwsDataFromDbList=i,this.getAllAboutData(c)},i=>{this.isLoading=!1,console.log(i.error)}))}getAllAboutData(e){this.initMsg="D\xe9marrage du calcule des indicateurs ...";const{start_date:s,end_date:p,chws:d,sites:a,sources:c}=e;if(l.F.isNotNull(s)&&l.F.isNotNull(p)){var i={total_home_visit:{},total_pcime_soins:{},total_pcime_suivi:{},total_reference_pcime_suivi:{},total_reference_pcime_soins:{},total_diarrhee_pcime_soins:{},total_paludisme_pcime_soins:{},total_pneumonie_pcime_soins:{},total_malnutrition_pcime_soins:{},prompt_diarrhee_24h_pcime_soins:{},prompt_diarrhee_48h_pcime_soins:{},prompt_diarrhee_72h_pcime_soins:{},prompt_paludisme_24h_pcime_soins:{},prompt_paludisme_48h_pcime_soins:{},prompt_paludisme_72h_pcime_soins:{},prompt_pneumonie_24h_pcime_soins:{},prompt_pneumonie_48h_pcime_soins:{},prompt_pneumonie_72h_pcime_soins:{},total_pregnancy_family_planning:{},total_reference_family_planning_soins:{},total_reference_femme_enceinte_soins:{},total_vad_femme_enceinte_soins:{},total_vad_femme_enceinte_NC_soins:{},total_test_de_grossesse_domicile:{},total_newborn_suivi:{},total_reference_newborn:{},total_malnutrition_suivi:{},total_reference_malnutrition_suivi:{},total_prenatal_suivi:{},total_reference_prenatal_suivi:{},total_postnatal_suivi:{},total_reference_postnatal_suivi:{},total_vad_femme_postpartum_NC:{},total_vad_women_emergency_suivi:{},total_reference_women_emergency_suivi:{},total_femme_enceinte_women_emergency_suivi:{},total_femme_postpartum_women_emergency_suivi:{},total_family_planning_renewal_suivi:{},total_reference_family_planning_renewal_suivi:{},total_vad_family_planning_NC:{}};for(let C=0;C<this.allChwsList.length;C++){const g=this.allChwsList[C].id;null!=g&&""!=g&&Object.entries(i).map(([v,u])=>{const n=u;n.hasOwnProperty(g)||(n[g]={chwId:g,count:0})})}for(let C=0;C<this.AllChwsDataFromDbList.length;C++){const g=this.AllChwsDataFromDbList[C];if(null!=g){const v=g.form,u=g.fields,n=null!=g.chw&&null!=g.chw.id&&""!=g.chw.id?g.chw.id:"",h=null!=g.site&&null!=g.site.id&&""!=g.site.id?g.site.id:"",r=null!=g.source&&""!=g.source?g.source:"",Z=l.F.isNotNull(n)&&l.F.isNotNull(d)&&d?.includes(n)||!l.F.isNotNull(d),A=l.F.isNotNull(h)&&l.F.isNotNull(a)&&a?.includes(h)||!l.F.isNotNull(a),T=l.F.isNotNull(r)&&l.F.isNotNull(c)&&c?.includes(r)||!l.F.isNotNull(c),L=!(!l.F.isNotNull(s)||!l.F.isNotNull(p))&&l.E.isBetween(`${s}`,g.reported_date,`${p}`);if(Z&&A&&L&&T){if("home_visit"===v&&(i.total_home_visit[n].count+=1),"pcime_c_asc"===v&&(i.total_pcime_soins[n].count+=1,"yes"==u["group_review.s_have_you_refer_child"]&&(i.total_reference_pcime_soins[n].count+=1),"true"==u.has_diarrhea&&(i.total_diarrhee_pcime_soins[n].count+=1,"true"==u.within_24h&&(i.prompt_diarrhee_24h_pcime_soins[n].count+=1),("true"==u.within_24h||"true"==u.within_48h)&&(i.prompt_diarrhee_48h_pcime_soins[n].count+=1),("true"==u.within_24h||"true"==u.within_48h||"true"==u.within_72h)&&(i.prompt_diarrhee_72h_pcime_soins[n].count+=1)),"true"==u.fever_with_malaria&&(i.total_paludisme_pcime_soins[n].count+=1,"true"==u.within_24h&&(i.prompt_paludisme_24h_pcime_soins[n].count+=1),("true"==u.within_24h||"true"==u.within_48h)&&(i.prompt_paludisme_48h_pcime_soins[n].count+=1),("true"==u.within_24h||"true"==u.within_48h||"true"==u.within_72h)&&(i.prompt_paludisme_72h_pcime_soins[n].count+=1)),"true"==u.has_pneumonia&&(i.total_pneumonie_pcime_soins[n].count+=1,"true"==u.within_24h&&(i.prompt_pneumonie_24h_pcime_soins[n].count+=1),("true"==u.within_24h||"true"==u.within_48h)&&(i.prompt_pneumonie_48h_pcime_soins[n].count+=1),("true"==u.within_24h||"true"==u.within_48h||"true"==u.within_72h)&&(i.prompt_pneumonie_72h_pcime_soins[n].count+=1)),"true"==u.has_malnutrition&&(i.total_malnutrition_pcime_soins[n].count+=1)),"pcime_c_followup"===v&&(i.total_pcime_suivi[n].count+=1,"yes"==u["group_review.s_have_you_refer_child"]&&(i.total_reference_pcime_suivi[n].count+=1)),"newborn_followup"===v&&(i.total_newborn_suivi[n].count+=1,"yes"==u["group_summary.s_have_you_refer_child"]&&(i.total_reference_newborn[n].count+=1)),"malnutrition_followup"===v&&(i.total_malnutrition_suivi[n].count+=1,"yes"==u["results_page.s_have_you_refer_child"]&&(i.total_reference_malnutrition_suivi[n].count+=1)),"prenatal_followup"===v&&(i.total_prenatal_suivi[n].count+=1,"yes"==u["group_summary.s_have_you_refer_child"]&&(i.total_reference_prenatal_suivi[n].count+=1)),"postnatal_followup"===v&&(i.total_postnatal_suivi[n].count+=1,"yes"==u["group_summary.s_have_you_refer_child"]&&(i.total_reference_postnatal_suivi[n].count+=1),"1"==u.follow_up_count&&(i.total_vad_femme_postpartum_NC[n].count+=1)),"pregnancy_family_planning"===v){i.total_pregnancy_family_planning[n].count+=1;var _="positive"==u["s_reg_pregnancy_screen.s_reg_urine_result"],w="already_pregnant"==u["s_reg_pregnancy_screen.s_reg_why_urine_test_not_done"];"yes"==u["s_reg_pregnancy_screen.s_reg_urine_test"]&&(i.total_test_de_grossesse_domicile[n].count+=1),"yes"==u["s_summary.s_have_you_refer_child"]&&!_&&!w&&(i.total_reference_family_planning_soins[n].count+=1),(_||w)&&(i.total_vad_femme_enceinte_soins[n].count+=1,"fp_followup"!=u["s_reg_mode.s_reg_how_found"]&&(i.total_vad_femme_enceinte_NC_soins[n].count+=1),"yes"==u["s_summary.s_have_you_refer_child"]&&(i.total_reference_femme_enceinte_soins[n].count+=1)),"yes"==u["s_fam_plan_screen.agreed_to_fp"]&&(i.total_vad_family_planning_NC[n].count+=1)}"women_emergency_followup"===v&&(i.total_vad_women_emergency_suivi[n].count+=1,"yes"==u["group_summary.s_have_you_refer_child"]&&(i.total_reference_women_emergency_suivi[n].count+=1),"pregnant"==u["initial.woman_status"]&&(i.total_femme_enceinte_women_emergency_suivi[n].count+=1),"postpartum"==u["initial.woman_status"]&&(i.total_femme_postpartum_women_emergency_suivi[n].count+=1)),"fp_follow_up_renewal"===v&&(i.total_family_planning_renewal_suivi[n].count+=1,"true"==u["checklist2.s_refer_for_health_state"]&&(i.total_reference_family_planning_renewal_suivi[n].count+=1))}}}this.transformData(i,e)}}transformData(e,s){const{start_date:p,end_date:d,chws:a,sites:c,sources:i}=s;if(l.F.isNotNull(p)&&l.F.isNotNull(d)){var _={total_vad:0,total_vad_pcime_c:0,total_suivi_pcime_c:0,total_vad_femmes_enceinte:0,total_vad_femmes_postpartum:0,total_recherche_active:0,total_vad_family_planning:0,reference_femmes_pf:0,reference_pcime:0,reference_femmes_enceinte_postpartum:0,total_diarrhee_pcime_soins:0,total_paludisme_pcime_soins:0,total_pneumonie_pcime_soins:0,total_malnutrition_pcime_soins:0,prompt_diarrhee_24h_pcime_soins:0,prompt_diarrhee_48h_pcime_soins:0,prompt_diarrhee_72h_pcime_soins:0,prompt_paludisme_24h_pcime_soins:0,prompt_paludisme_48h_pcime_soins:0,prompt_paludisme_72h_pcime_soins:0,prompt_pneumonie_24h_pcime_soins:0,prompt_pneumonie_48h_pcime_soins:0,prompt_pneumonie_72h_pcime_soins:0,total_vad_femmes_enceintes_NC:0,total_vad_femme_postpartum_NC:0,total_test_de_grossesse_domicile:0};for(let n=0;n<this.allChwsList.length;n++){const r=this.allChwsList[n].id,Z=e.total_home_visit[r].count+e.total_pcime_soins[r].count+e.total_pregnancy_family_planning[r].count+e.total_pcime_suivi[r].count+e.total_newborn_suivi[r].count+e.total_prenatal_suivi[r].count+e.total_postnatal_suivi[r].count+e.total_malnutrition_suivi[r].count+e.total_vad_women_emergency_suivi[r].count+e.total_family_planning_renewal_suivi[r].count,A=e.total_pcime_soins[r].count+e.total_pcime_suivi[r].count+e.total_newborn_suivi[r].count+e.total_malnutrition_suivi[r].count,T=e.total_pcime_suivi[r].count+e.total_newborn_suivi[r].count+e.total_malnutrition_suivi[r].count,L=e.total_reference_family_planning_soins[r].count+e.total_reference_family_planning_renewal_suivi[r].count,et=e.total_reference_pcime_soins[r].count+e.total_reference_pcime_suivi[r].count+e.total_reference_newborn[r].count+e.total_reference_malnutrition_suivi[r].count,it=e.total_reference_femme_enceinte_soins[r].count+e.total_reference_prenatal_suivi[r].count+e.total_reference_postnatal_suivi[r].count+e.total_reference_women_emergency_suivi[r].count,I=e.total_vad_femme_enceinte_soins[r].count+e.total_prenatal_suivi[r].count+e.total_femme_enceinte_women_emergency_suivi[r].count,O=e.total_postnatal_suivi[r].count+e.total_femme_postpartum_women_emergency_suivi[r].count,ot=Z-(A+I+O+e.total_home_visit[r].count);_.total_vad+=Z,_.total_vad_pcime_c+=A,_.total_suivi_pcime_c+=T,_.total_vad_femmes_enceinte+=I,_.total_vad_femmes_postpartum+=O,_.total_recherche_active+=e.total_home_visit[r].count,_.total_vad_family_planning=ot,_.reference_femmes_pf+=L,_.reference_pcime+=et,_.reference_femmes_enceinte_postpartum=it,_.total_diarrhee_pcime_soins+=e.total_diarrhee_pcime_soins[r].count,_.total_paludisme_pcime_soins+=e.total_paludisme_pcime_soins[r].count,_.total_pneumonie_pcime_soins+=e.total_pneumonie_pcime_soins[r].count,_.total_malnutrition_pcime_soins+=e.total_malnutrition_pcime_soins[r].count,_.prompt_diarrhee_24h_pcime_soins+=e.prompt_diarrhee_24h_pcime_soins[r].count,_.prompt_diarrhee_48h_pcime_soins+=e.prompt_diarrhee_48h_pcime_soins[r].count,_.prompt_diarrhee_72h_pcime_soins+=e.prompt_diarrhee_72h_pcime_soins[r].count,_.prompt_paludisme_24h_pcime_soins+=e.prompt_paludisme_24h_pcime_soins[r].count,_.prompt_paludisme_48h_pcime_soins+=e.prompt_paludisme_48h_pcime_soins[r].count,_.prompt_paludisme_72h_pcime_soins+=e.prompt_paludisme_72h_pcime_soins[r].count,_.prompt_pneumonie_24h_pcime_soins+=e.prompt_pneumonie_24h_pcime_soins[r].count,_.prompt_pneumonie_48h_pcime_soins+=e.prompt_pneumonie_48h_pcime_soins[r].count,_.prompt_pneumonie_72h_pcime_soins+=e.prompt_pneumonie_72h_pcime_soins[r].count,_.total_vad_femmes_enceintes_NC+=e.total_vad_femme_enceinte_NC_soins[r].count,_.total_vad_femme_postpartum_NC+=e.total_vad_femme_postpartum_NC[r].count,_.total_test_de_grossesse_domicile+=e.total_test_de_grossesse_domicile[r].count}this.sitesChwsCount=0,this.familiesChwsCount=0,this.patientsChwsCount=0,this.chwsCount=0,this.allAggragateData=[];for(let n=0;n<this.allSitesList.length;n++){const h=this.allSitesList[n];l.F.isNotNull(i)?i?.includes(h.source)&&this.sitesChwsCount++:this.sitesChwsCount++}for(let n=0;n<this.allFamiliesList.length;n++){const h=this.allFamiliesList[n];l.F.isNotNull(c)&&l.F.isNotNull(a)?l.F.isNotNull(i)?c?.includes(h.site.id)&&a?.includes(h.zone.chw_id)&&i?.includes(h.site.source)&&this.familiesChwsCount++:c?.includes(h.site.id)&&a?.includes(h.zone.chw_id)&&this.familiesChwsCount++:l.F.isNotNull(c)&&!l.F.isNotNull(a)?l.F.isNotNull(i)?c?.includes(h.site.id)&&i?.includes(h.site.source)&&this.familiesChwsCount++:c?.includes(h.site.id)&&this.familiesChwsCount++:l.F.isNotNull(i)?i?.includes(h.site.source)&&this.familiesChwsCount++:this.familiesChwsCount++}for(let n=0;n<this.allPatientsList.length;n++){const h=this.allPatientsList[n];l.F.isNotNull(c)&&l.F.isNotNull(a)?l.F.isNotNull(i)?c?.includes(h.site.id)&&a?.includes(h.zone.chw_id)&&i?.includes(h.site.source)&&this.patientsChwsCount++:c?.includes(h.site.id)&&a?.includes(h.zone.chw_id)&&this.patientsChwsCount++:l.F.isNotNull(c)&&!l.F.isNotNull(a)?l.F.isNotNull(i)?c?.includes(h.site.id)&&i?.includes(h.site.source)&&this.patientsChwsCount++:c?.includes(h.site.id)&&this.patientsChwsCount++:l.F.isNotNull(i)?i?.includes(h.site.source)&&this.patientsChwsCount++:this.patientsChwsCount++}for(let n=0;n<this.allChwsList.length;n++){const h=this.allChwsList[n];l.F.isNotNull(c)&&l.F.isNotNull(a)?l.F.isNotNull(i)?c?.includes(h.site.id)&&a?.includes(h.zone.chw_id)&&i?.includes(h.site.source)&&this.chwsCount++:c?.includes(h.site.id)&&a?.includes(h.zone.chw_id)&&this.chwsCount++:l.F.isNotNull(c)&&!l.F.isNotNull(a)?l.F.isNotNull(i)?c?.includes(h.site.id)&&i?.includes(h.site.source)&&this.chwsCount++:c?.includes(h.site.id)&&this.chwsCount++:l.F.isNotNull(i)?i?.includes(h.site.source)&&this.chwsCount++:this.chwsCount++}let w={label:l.F.capitaliseDataGiven("total_site_enregistre","_"," "),count:this.sitesChwsCount,icon:"ion-stats-bars",color:"bg-success",detailUrl:"/dashboards/dash1"},C={label:l.F.capitaliseDataGiven("total_ASC_enregistre","_"," "),count:this.chwsCount,icon:"ion-person-add",color:"bg-warning",detailUrl:"/dashboards/dash1"},g={label:l.F.capitaliseDataGiven("total_famille_enregistre","_"," "),count:this.familiesChwsCount,icon:"ion-pie-graph",color:"bg-danger",detailUrl:"/dashboards/dash1"},v={label:l.F.capitaliseDataGiven("total_patient_enregistre","_"," "),count:this.patientsChwsCount,icon:"ion-bag",color:"bg-primary",detailUrl:"/dashboards/dash1"};this.allAggragateData.push(w),this.allAggragateData.push(C),this.allAggragateData.push(g),this.allAggragateData.push(v),Object.entries(_).map(([n,h])=>{let r={label:l.F.capitaliseDataGiven(n,"_"," "),count:0,icon:"ion-bag",color:"bg-info",detailUrl:"/dashboards/dash1"};return r.count=h,this.allAggragateData.push(r),""})}this.initMsg="",this.isLoading=!1}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(D.p),t.Y36(U._))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-dashboard-one"]],decls:47,vars:11,consts:[[1,"content"],[1,"container-fluid"],[1,"card","card-info"],[1,"overlay-wrapper"],["class","overlay",4,"ngIf"],[1,"card-header"],["novalidate","",3,"formGroup","ngSubmit"],[1,"row"],[1,"col-sm-2","col-6"],[1,"form-group"],["type","date","formControlName","start_date",1,"form-control"],["type","date","formControlName","end_date",1,"form-control"],["class","form-control","multiple","multiple","formControlName","sources",3,"change",4,"ngIf"],["class","form-control",4,"ngIf"],["class","form-control","multiple","multiple","formControlName","sites",3,"change",4,"ngIf"],[1,"col-sm-3","col-6"],["class","form-control","multiple","multiple","formControlName","chws",4,"ngIf"],[1,"col-sm-1","col-6"],["type","submit",1,"btn","btn-warning","form-control",3,"disabled"],[1,"fa","fa-floppy-o","fa-right"],[1,"row","card-body"],["class","col-sm-3 col-6",4,"ngFor","ngForOf","ngForTrackBy"],[1,"overlay"],[1,"fas","fa-3x","fa-sync-alt","fa-spin"],[1,"text-bold","pt-2"],["multiple","multiple","formControlName","sources",1,"form-control",3,"change"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"form-control"],["multiple","multiple","formControlName","sites",1,"form-control",3,"change"],["multiple","multiple","formControlName","chws",1,"form-control"],[1,"inner"],[2,"font-size","40px"],[2,"font-size","20px"],[1,"icon"]],template:function(e,s){1&e&&(t.TgZ(0,"section",0)(1,"div",1)(2,"div",2)(3,"div",3),t.YNc(4,S,4,1,"div",4),t.TgZ(5,"div",5)(6,"form",6),t.NdJ("ngSubmit",function(){return s.initDataFilted()}),t.TgZ(7,"div",7)(8,"div",8)(9,"div",9)(10,"label"),t._uU(11,"Date D\xe9but"),t.qZA(),t._UZ(12,"input",10),t.qZA()(),t.TgZ(13,"div",8)(14,"div",9)(15,"label"),t._uU(16,"Date Fin"),t.qZA(),t._UZ(17,"input",11),t.qZA()(),t.TgZ(18,"div",8)(19,"div",9)(20,"label"),t._uU(21,"Source"),t.qZA(),t.YNc(22,J,2,1,"select",12),t.YNc(23,E,1,0,"select",13),t.qZA()(),t.TgZ(24,"div",8)(25,"div",9)(26,"label"),t._uU(27,"Site"),t.qZA(),t.YNc(28,G,2,1,"select",14),t.YNc(29,Q,1,0,"select",13),t.qZA()(),t.TgZ(30,"div",15)(31,"div",9)(32,"label"),t._uU(33,"ASC"),t.qZA(),t.YNc(34,k,2,1,"select",16),t.YNc(35,z,1,0,"select",13),t.qZA()(),t.TgZ(36,"div",17)(37,"div",9)(38,"label"),t._uU(39,"."),t.qZA(),t.TgZ(40,"button",18),t._uU(41," OK "),t._UZ(42,"span",19),t.qZA()()()()()()()(),t.TgZ(43,"div",20),t.YNc(44,j,10,8,"div",21),t.qZA(),t._UZ(45,"br")(46,"br"),t.qZA()()),2&e&&(t.xp6(4),t.Q6J("ngIf",s.isLoading),t.xp6(2),t.Q6J("formGroup",s.aggradateDataForm),t.xp6(16),t.Q6J("ngIf",s.sourcesList.length>0),t.xp6(1),t.Q6J("ngIf",0==s.sourcesList.length),t.xp6(5),t.Q6J("ngIf",s.sitesList.length>0),t.xp6(1),t.Q6J("ngIf",0==s.sitesList.length),t.xp6(5),t.Q6J("ngIf",s.chwsList.length>0),t.xp6(1),t.Q6J("ngIf",0==s.chwsList.length),t.xp6(5),t.Q6J("disabled",!s.aggradateDataForm.valid),t.xp6(4),t.Q6J("ngForOf",s.allAggragateData)("ngForTrackBy",s.identifyAggragateData))},dependencies:[N.sg,N.O5,m._Y,m.YN,m.Kr,m.Fj,m.K7,m.JJ,m.JL,m.sg,m.u],encapsulation:2}),o})(),canActivate:[q.a],data:{href:"dashboard1",icon:"fa fa-user",label:"Dashboard-1",title:"Dashboard-1"}},{path:"dash2",component:(()=>{class o{constructor(e){this.syncService=e,this.child_forms=["pcime_c_asc","pcime_c_referral","pcime_c_followup","malnutrition_followup","newborn_followup"],this.num_fp_forms=["pregnancy_family_planning","prenatal_followup","postnatal_followup","women_emergency_followup","fp_follow_up_renewal"],this.home_actions_forms=["pcime_c_asc","pcime_c_referral","pcime_c_followup","malnutrition_followup","pregnancy_family_planning","prenatal_followup","postnatal_followup","newborn_followup","home_visit","women_emergency_followup","fp_follow_up_renewal"],this.consultations_followup_forms=["pcime_c_asc","pregnancy_family_planning","pcime_c_followup","pcime_c_referral","malnutrition_followup","prenatal_followup","postnatal_followup","newborn_followup","women_emergency_followup","fp_follow_up_renewal"],this.bodyData=[],this.AllChwsDataFromDbList=[],this.allChwsList=[],this.allSitesList=[],this.source="portal-integratehealth.org.444",this.dhis2Url="dhis2.integratehealth.org/dhis.443"}createDataFilterFormGroup(){return new m.cw({start_date:new m.NI(this.initDate.start_date,[m.kI.required,m.kI.minLength(7)]),end_date:new m.NI(this.initDate.end_date,[m.kI.required,m.kI.minLength(7)]),sites:new m.NI(""),sources:new m.NI("")})}identifyBodyData(e,s){return s.Code}ngOnInit(){this.isLoading=!1,this.initDate=l.E.startEnd21and20Date(),this.aggradateDataForm=this.createDataFilterFormGroup(),this.initAllData()}initAllData(){var e=this;return(0,y.Z)(function*(){e.isLoading=!0,e.initMsg="Chargement des Sites ...",e.syncService.getSitesList({data_source:e.source}).subscribe(s=>{e.allSitesList=s,e.initMsg="Chargement des ASC ...",e.syncService.getChwsList({data_source:e.source}).subscribe(p=>{e.allChwsList=p,e.initDataFilted()},p=>console.log(p.error))},s=>console.log(s.error))})()}returnEmptyArrayIfNul(e){return l.F.isNotNull(e)?e:[]}initDataFilted(){this.isLoading=!0;var a={start_date:this.aggradateDataForm.value.start_date,end_date:this.aggradateDataForm.value.end_date,sites:this.aggradateDataForm.value.sites,data_source:["portal-integratehealth.org.444","dhis2.integratehealth.org/dhis.443"]};this.syncService.getAllData(a).subscribe(c=>{this.AllChwsDataFromDbList=c,this.getAllAboutData(a)},c=>{this.isLoading=!1,console.log(c.error)})}getAllAboutData(e){const{start_date:s,end_date:p,sites:d}=e;var a={};for(let c=0;c<this.allChwsList.length;c++){const i=this.allChwsList[c].id;l.F.isNotNull(i)&&(a.hasOwnProperty(i)||(a[i]={chwId:i,app_total_child_followup:0,dhis_total_child_followup:0,app_total_num_fp_followup:0,dhis_total_num_fp_followup:0,app_total_active_research:0,dhis_total_active_research:0,app_total_consultation_followup:0,dhis_total_consultation_followup:0,app_total_home_visit:0,dhis_total_home_visit:0}))}for(let c=0;c<this.AllChwsDataFromDbList.length;c++){const i=this.AllChwsDataFromDbList[c];if(null!=i){const _=i.form,w=null!=i.chw&&l.F.isNotNull(i.chw.id)?i.chw.id:"",C=null!=i.site&&l.F.isNotNull(i.site.id)?i.site.id:"",g=l.F.isNotNull(C)&&l.F.isNotNull(d)&&d?.includes(C)||!l.F.isNotNull(d),v=!(!l.F.isNotNull(s)||!l.F.isNotNull(p))&&l.E.isBetween(`${s}`,i.reported_date,`${p}`);g&&v&&a.hasOwnProperty(w)&&(i.source==this.dhis2Url?("PCIME"===_&&(a[w].dhis_total_child_followup+=1),("Maternelle"===_||"PF"===_)&&(a[w].dhis_total_num_fp_followup+=1),"Recherche"===_&&(a[w].dhis_total_active_research+=1),"Recherche"!==_&&(a[w].dhis_total_consultation_followup+=1),a[w].dhis_total_home_visit+=1):(this.child_forms.includes(_)&&(a[w].app_total_child_followup+=1),this.num_fp_forms.includes(_)&&(a[w].app_total_num_fp_followup+=1),"home_visit"===_&&(a[w].app_total_active_research+=1),this.consultations_followup_forms.includes(_)&&(a[w].app_total_consultation_followup+=1),this.home_actions_forms.includes(_)&&(a[w].app_total_home_visit+=1)))}}this.bodyData=[],Object.entries(a).map(([c,i])=>{const _=i;this.bodyData.push({Code:this.getChwInfos(_.chwId).external_id,Name:this.getChwInfos(_.chwId).name,Pcime:_.app_total_child_followup,PcimeDhis2:_.dhis_total_child_followup,MaternellePf:_.app_total_num_fp_followup,MaternellePfDhis2:_.dhis_total_num_fp_followup,Recherche:_.app_total_active_research,RechercheDhis:_.dhis_total_active_research,Consultation:_.app_total_consultation_followup,ConsultationDhis:_.dhis_total_consultation_followup,Total:_.app_total_home_visit,TotalDhis:_.dhis_total_home_visit,TotalDiff:this.getRatio(_.app_total_home_visit,_.dhis_total_home_visit,!1).value,Ratio:this.getRatio(_.app_total_home_visit,_.dhis_total_home_visit)})}),this.isLoading=!1}getDataValuesElements(e){for(let s=0;s<e.dataValues.length;s++){const p=e.dataValues[s];if(p.dataElement==e.dataElement&&p.value==e.value)return!0}return!1}getRatio(e,s,p=!0){var d=0,a="success",c=e-s;if(p){const i=100*(e>0?c/e:s/100);(d=+(i<0?-1*i:i).toFixed(2))>0&&d<=5&&(a="warning"),d>5&&(a="danger")}else d=+(c<0?-1*c:c).toFixed(2);return{value:d,color:a}}initTable(){initDataTable("compare_data",!1)}getChwInfos(e,s=!1){for(let d=0;d<this.allChwsList.length;d++){const a=this.allChwsList[d];if(l.F.isNotNull(a))if(1==s){if(l.F.isNotNull(a.external_id)&&a.external_id==e)return a}else if(l.F.isNotNull(a.id)&&a.id==e)return a}}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(U._))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-dashboard-two"]],decls:32,vars:5,consts:[[1,"content-header"],[1,"container-fluid"],[1,"card","card-info"],[1,"overlay-wrapper"],["class","overlay",4,"ngIf"],[1,"card-header"],["novalidate","",3,"formGroup","ngSubmit"],[1,"row"],[1,"col-sm-2","col-6"],[1,"form-group"],["type","date","formControlName","start_date",1,"form-control"],["type","date","formControlName","end_date",1,"form-control"],["formControlName","sites",1,"form-control"],[3,"value",4,"ngFor","ngForOf"],[1,"col-sm-1","col-6"],["type","submit",1,"btn","btn-warning","form-control",3,"disabled"],[1,"fa","fa-floppy-o","fa-right"],["class","content",4,"ngIf"],[1,"overlay"],[1,"fas","fa-3x","fa-sync-alt","fa-spin"],[1,"text-bold","pt-2"],[3,"value"],[1,"content"],[1,"card"],[1,"card-title"],["type","button",3,"click"],[1,"card-body"],["id","compare_data",1,"table","table-bordered","table-hover"],[1,"bg-primary"],["rowspan","2",2,"width","50px"],["rowspan","2",2,"width","150px"],["colspan","2",2,"width","50px"],[2,"width","50px"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"info"],[1,"warning"],[1,"primary"],[1,"final"],[1,""]],template:function(e,s){1&e&&(t.TgZ(0,"section",0)(1,"div",1)(2,"div",2)(3,"div",3),t.YNc(4,B,4,1,"div",4),t.TgZ(5,"div",5)(6,"form",6),t.NdJ("ngSubmit",function(){return s.initDataFilted()}),t.TgZ(7,"div",7)(8,"div",8)(9,"div",9)(10,"label"),t._uU(11,"Date D\xe9but"),t.qZA(),t._UZ(12,"input",10),t.qZA()(),t.TgZ(13,"div",8)(14,"div",9)(15,"label"),t._uU(16,"Date Fin"),t.qZA(),t._UZ(17,"input",11),t.qZA()(),t.TgZ(18,"div",8)(19,"div",9)(20,"label"),t._uU(21,"Site"),t.qZA(),t.TgZ(22,"select",12),t.YNc(23,H,2,2,"option",13),t.qZA()()(),t.TgZ(24,"div",14)(25,"div",9)(26,"label"),t._uU(27,"."),t.qZA(),t.TgZ(28,"button",15),t._uU(29," OK "),t._UZ(30,"span",16),t.qZA()()()()()()()()()(),t.YNc(31,K,51,2,"section",17)),2&e&&(t.xp6(4),t.Q6J("ngIf",s.isLoading),t.xp6(2),t.Q6J("formGroup",s.aggradateDataForm),t.xp6(17),t.Q6J("ngForOf",s.allSitesList),t.xp6(5),t.Q6J("disabled",!s.aggradateDataForm.valid),t.xp6(3),t.Q6J("ngIf",s.bodyData.length>0))},dependencies:[N.sg,N.O5,m._Y,m.YN,m.Kr,m.Fj,m.EJ,m.JJ,m.JL,m.sg,m.u],styles:[".info[_ngcontent-%COMP%]{color:#00f;font-weight:bolder}.warning[_ngcontent-%COMP%]{color:orange;font-size:large;font-weight:bolder}.primary[_ngcontent-%COMP%]{color:purple;font-size:large;font-weight:bolder}.final[_ngcontent-%COMP%]{color:green;font-size:large;font-weight:bolder}.line[_ngcontent-%COMP%]{color:#000;font-size:large;font-weight:bolder}"]}),o})(),canActivate:[q.a],data:{href:"dashboard2",icon:"fa fa-user",label:"Dashboard-2",title:"Dashboard-2"}}];let P=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[x.Bz.forChild(W),x.Bz]}),o})(),tt=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[N.ez,m.UX,P]}),o})()}}]);