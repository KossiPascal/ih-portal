"use strict";(self.webpackChunkih_portal=self.webpackChunkih_portal||[]).push([[610],{610:(ee,x,v)=>{v.r(x),v.d(x,{DashboardsModule:()=>W});var y=v(8692),m=v(92),q=v(7509),U=v(8968),b=v(8239),p=v(8629),e=v(4537),I=v(8171),F=v(1815);function O(i,h){if(1&i&&(e.TgZ(0,"div",22),e._UZ(1,"i",23),e.TgZ(2,"div",24),e._uU(3),e.qZA()()),2&i){const t=e.oxw();e.xp6(3),e.hij(" ",t.initMsg,"")}}function S(i,h){if(1&i&&(e.TgZ(0,"option",27),e._uU(1),e.qZA()),2&i){const t=h.$implicit,n=e.oxw(2);e.s9C("value",t),e.xp6(1),e.hij(" ",n.formatHostName(t)," ")}}function D(i,h){if(1&i){const t=e.EpF();e.TgZ(0,"select",25),e.NdJ("change",function(){e.CHM(t);const c=e.oxw();return e.KtG(c.genarateSites())}),e.YNc(1,S,2,2,"option",26),e.qZA()}if(2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.sourcesList)}}function J(i,h){1&i&&e._UZ(0,"select",28)}function M(i,h){if(1&i&&(e.TgZ(0,"option",27),e._uU(1),e.qZA()),2&i){const t=h.$implicit;e.s9C("value",t.id),e.xp6(1),e.hij(" ",t.name," ")}}function E(i,h){if(1&i){const t=e.EpF();e.TgZ(0,"select",29),e.NdJ("change",function(){e.CHM(t);const c=e.oxw();return e.KtG(c.genarateChws())}),e.YNc(1,M,2,2,"option",26),e.qZA()}if(2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.sitesList)}}function Y(i,h){1&i&&e._UZ(0,"select",28)}function Q(i,h){if(1&i&&(e.TgZ(0,"option",27),e._uU(1),e.qZA()),2&i){const t=h.$implicit;e.s9C("value",t.id),e.xp6(1),e.hij(" ",t.name," ")}}function R(i,h){if(1&i&&(e.TgZ(0,"select",30),e.YNc(1,Q,2,2,"option",26),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.chwsList)}}function G(i,h){1&i&&e._UZ(0,"select",28)}function k(i,h){if(1&i&&(e.TgZ(0,"div",15)(1,"div")(2,"div",31)(3,"h3",32),e._uU(4),e.qZA(),e.TgZ(5,"p")(6,"strong"),e._uU(7),e.qZA()()(),e.TgZ(8,"div",33),e._UZ(9,"i"),e.qZA()()()),2&i){const t=h.$implicit;e.xp6(1),e.Gre("small-box ",t.color,""),e.xp6(3),e.Oqu(t.count),e.xp6(3),e.Oqu(t.label),e.xp6(2),e.Gre("ion ",t.icon,"")}}function $(i,h){if(1&i&&(e.TgZ(0,"div",18),e._UZ(1,"i",19),e.TgZ(2,"div",20),e._uU(3),e.qZA()()),2&i){const t=e.oxw();e.xp6(3),e.hij(" ",t.initMsg,"")}}function B(i,h){if(1&i&&(e.TgZ(0,"option",21),e._uU(1),e.qZA()),2&i){const t=h.$implicit;e.s9C("value",t.id),e.xp6(1),e.hij(" ",t.name," ")}}function H(i,h){if(1&i&&(e.TgZ(0,"tr")(1,"td",34),e._uU(2),e.qZA(),e.TgZ(3,"td",34),e._uU(4),e.qZA(),e.TgZ(5,"td",35),e._uU(6),e.qZA(),e.TgZ(7,"td",35),e._uU(8),e.qZA(),e.TgZ(9,"td",36),e._uU(10),e.qZA(),e.TgZ(11,"td",36),e._uU(12),e.qZA(),e.TgZ(13,"td",35),e._uU(14),e.qZA(),e.TgZ(15,"td",35),e._uU(16),e.qZA(),e.TgZ(17,"td",36),e._uU(18),e.qZA(),e.TgZ(19,"td",36),e._uU(20),e.qZA(),e.TgZ(21,"td",37),e._uU(22),e.qZA(),e.TgZ(23,"td",37),e._uU(24),e.qZA(),e.TgZ(25,"td",38)(26,"strong"),e._uU(27),e.qZA()(),e.TgZ(28,"td"),e._uU(29),e.qZA()()),2&i){const t=h.$implicit;e.xp6(2),e.Oqu(t.Code),e.xp6(2),e.Oqu(t.Name),e.xp6(2),e.Oqu(t.Pcime),e.xp6(2),e.Oqu(t.PcimeDhis2),e.xp6(2),e.Oqu(t.MaternellePf),e.xp6(2),e.Oqu(t.MaternellePfDhis2),e.xp6(2),e.Oqu(t.Consultation),e.xp6(2),e.Oqu(t.ConsultationDhis),e.xp6(2),e.Oqu(t.Recherche),e.xp6(2),e.Oqu(t.RechercheDhis),e.xp6(2),e.Oqu(t.Total),e.xp6(2),e.Oqu(t.TotalDhis),e.xp6(3),e.Oqu(t.TotalDiff),e.xp6(1),e.Gre("bg-",t.Ratio.color,""),e.xp6(1),e.hij("",t.Ratio.value," %")}}function z(i,h){if(1&i){const t=e.EpF();e.TgZ(0,"section",22)(1,"div",23)(2,"div",5)(3,"h3",24)(4,"button",25),e.NdJ("click",function(){e.CHM(t);const c=e.oxw();return e.KtG(c.initTable())}),e._uU(5,"Generate Table"),e.qZA()()(),e.TgZ(6,"div",26)(7,"table",27)(8,"thead")(9,"tr",28)(10,"th",29),e._uU(11,"Code ASC"),e.qZA(),e.TgZ(12,"th",30),e._uU(13,"Nom ASC"),e.qZA(),e.TgZ(14,"th",31),e._uU(15,"Pcime"),e.qZA(),e.TgZ(16,"th",31),e._uU(17,"Maternel & PF"),e.qZA(),e.TgZ(18,"th",31),e._uU(19,"Consultation"),e.qZA(),e.TgZ(20,"th",31),e._uU(21,"Recherche"),e.qZA(),e.TgZ(22,"th",31),e._uU(23,"Total"),e.qZA(),e.TgZ(24,"th",29),e._uU(25,"Diff"),e.qZA(),e.TgZ(26,"th",29),e._uU(27,"Ratio"),e.qZA()(),e.TgZ(28,"tr",28)(29,"th",32),e._uU(30,"APPLI"),e.qZA(),e.TgZ(31,"th",32),e._uU(32,"DHIS2"),e.qZA(),e.TgZ(33,"th",32),e._uU(34,"APPLI"),e.qZA(),e.TgZ(35,"th",32),e._uU(36,"DHIS2"),e.qZA(),e.TgZ(37,"th",32),e._uU(38,"APPLI"),e.qZA(),e.TgZ(39,"th",32),e._uU(40,"DHIS2"),e.qZA(),e.TgZ(41,"th",32),e._uU(42,"APPLI"),e.qZA(),e.TgZ(43,"th",32),e._uU(44,"DHIS2"),e.qZA(),e.TgZ(45,"th",32),e._uU(46,"APPLI"),e.qZA(),e.TgZ(47,"th",32),e._uU(48,"DHIS2"),e.qZA()()(),e.TgZ(49,"tbody"),e.YNc(50,H,30,17,"tr",33),e.qZA()()()()()}if(2&i){const t=e.oxw();e.xp6(50),e.Q6J("ngForOf",t.bodyData)("ngForTrackBy",t.identifyBodyData)}}const K=[{path:"",redirectTo:"dash1",pathMatch:"full"},{path:"dash1",component:(()=>{class i{constructor(t,n){this.db=t,this.sync=n,this.allAggragateData=[],this.options={Chart:{type:"area",height:700},title:{text:"Donn\xe9es par ASC"},credits:{enabled:!1},xAxis:{categories:["ASC1","ASC2","ASC3","ASC4","ASC5","ASC6","ASC7"],tickmarkPlacement:"on",title:{enabled:!0}},yAxis:{categories:[],max:5268,min:0,tickmarkPlacement:"on",title:{enabled:!1}},series:[{name:"Recherche Active",data:[502,635,809,947,1402,3634,5268]},{name:"Pcime",data:[163,203,276,408,547,729,628]},{name:"Maternel",data:[18,31,54,156,339,818,1201]}]},this.home_actions_forms=["pcime_c_asc","pcime_c_referral","pcime_c_followup","malnutrition_followup","pregnancy_family_planning","prenatal_followup","postnatal_followup","newborn_followup","home_visit","women_emergency_followup","fp_follow_up_renewal"],this.vaccination_forms=["vaccination"],this.consultations_followup_forms=["pcime_c_asc","pregnancy_family_planning","pcime_c_followup","pcime_c_referral","malnutrition_followup","prenatal_followup","postnatal_followup","newborn_followup","women_emergency_followup","fp_follow_up_renewal"],this.consultations_forms=["pcime_c_asc","pregnancy_family_planning"],this.followup_forms=["pcime_c_followup","pcime_c_referral","malnutrition_followup","prenatal_followup","postnatal_followup","newborn_followup","women_emergency_followup","fp_follow_up_renewal"],this.all_child_forms=["pcime_c_asc","pcime_c_followup","newborn_followup","malnutrition_followup"],this.child_followup_forms=["pcime_c_followup","newborn_followup","malnutrition_followup"],this.allForms=["pcime_c_asc","vaccination_followup","pregnancy_family_planning","delivery","home_visit","newborn_followup","pcime_c_followup","malnutrition_followup","postnatal_followup","prenatal_followup","pcime_c_referral","fp_follow_up_renewal"],this.AllChwsDataFromDbList=[],this.sourcesList=[],this.allChwsList=[],this.allSitesList=[],this.chwsList=[],this.sitesList=[],this.allZonesList=[],this.allPatientsList=[],this.allFamiliesList=[],this.chwsCount=0,this.sitesChwsCount=0,this.zonesChwsCount=0,this.patientsChwsCount=0,this.familiesChwsCount=0}createDataFilterFormGroup(){return new m.cw({start_date:new m.NI(this.initDate.start_date,[m.kI.required,m.kI.minLength(7)]),end_date:new m.NI(this.initDate.end_date,[m.kI.required,m.kI.minLength(7)]),sites:new m.NI(""),chws:new m.NI(""),sources:new m.NI("")})}identifyAggragateData(t,n){return n.label}ngOnInit(){this.isLoading=!1,this.initDate=p.E.startEnd21and20Date(),this.aggradateDataForm=this.createDataFilterFormGroup(),this.initAllData()}initAllData(){var t=this;return(0,b.Z)(function*(){yield t.db.getAllByParams(t.db.sites),t.isLoading=!0,t.initMsg="Chargement des Sites ...",t.sync.getSitesList().subscribe(function(){var c=(0,b.Z)(function*(f){t.allSitesList=f;for(let r=0;r<t.allSitesList.length;r++){const u=t.allSitesList[r].source;null!=u&&""!=u&&(t.sourcesList.includes(u)||t.sourcesList.push(u))}t.initMsg="Chargement des ASC ...",t.sync.getChwsList().subscribe(function(){var r=(0,b.Z)(function*(u){t.allChwsList=u,t.initDataFilted()});return function(u){return r.apply(this,arguments)}}(),r=>{t.isLoading=!1,console.log(r.error)})});return function(f){return c.apply(this,arguments)}}(),c=>{t.isLoading=!1,console.log(c.error)})})()}formatHostName(t){return t.replace(".org","").replace("-",".").trim()}genarateSites(){const t=this.aggradateDataForm.value.sources;if(this.sitesList=[],this.chwsList=[],this.aggradateDataForm.value.sites=[],this.aggradateDataForm.value.chws=[],p.F.isNotNull(t))for(let n=0;n<this.allSitesList.length;n++){const c=this.allSitesList[n];p.F.isNotNull(c)&&t.includes(c.source)&&this.sitesList.push(c)}else this.sitesList=this.allSitesList}genarateChws(){const t=this.aggradateDataForm.value.sites;if(this.chwsList=[],this.aggradateDataForm.value.chws=[],p.F.isNotNull(t))for(let n=0;n<this.allChwsList.length;n++){const c=this.allChwsList[n];p.F.isNotNull(c)&&t.includes(c.site.id)&&this.chwsList.push(c)}else this.chwsList=this.allChwsList}returnEmptyArrayIfNul(t){return p.F.isNotNull(t)?t:[]}initDataFilted(){const t=this.aggradateDataForm.value.start_date,n=this.aggradateDataForm.value.end_date,c=this.returnEmptyArrayIfNul(this.aggradateDataForm.value.chws),f=this.returnEmptyArrayIfNul(this.aggradateDataForm.value.sites);var u={start_date:t,end_date:n,sources:this.returnEmptyArrayIfNul(this.aggradateDataForm.value.sources),chws:c,sites:f,district:[]};this.isLoading=!0,this.initDate.start_date==t&&this.initDate.end_date==n&&0!=this.AllChwsDataFromDbList?.length?this.getAllAboutData(u):(this.initDate.start_date=t,this.initDate.end_date=n,this.initMsg=`Chargement des donn\xe9es du ${p.E.getDateInFormat(u.start_date,0,"fr")} au ${p.E.getDateInFormat(u.end_date,0,"fr")}`,this.sync.getAllData(u).subscribe(o=>{this.AllChwsDataFromDbList=o,this.getAllAboutData(u)},o=>{this.isLoading=!1,console.log(o.error)}))}getAllAboutData(t){this.initMsg="D\xe9marrage du calcule des indicateurs ...";const{start_date:n,end_date:c,chws:f,sites:r,sources:u}=t;if(p.F.isNotNull(n)&&p.F.isNotNull(c)){var o={total_home_visit:{},total_pcime_soins:{},total_pcime_suivi:{},total_reference_pcime_suivi:{},total_reference_pcime_soins:{},total_diarrhee_pcime_soins:{},total_paludisme_pcime_soins:{},total_pneumonie_pcime_soins:{},total_malnutrition_pcime_soins:{},prompt_diarrhee_24h_pcime_soins:{},prompt_diarrhee_48h_pcime_soins:{},prompt_diarrhee_72h_pcime_soins:{},prompt_paludisme_24h_pcime_soins:{},prompt_paludisme_48h_pcime_soins:{},prompt_paludisme_72h_pcime_soins:{},prompt_pneumonie_24h_pcime_soins:{},prompt_pneumonie_48h_pcime_soins:{},prompt_pneumonie_72h_pcime_soins:{},total_pregnancy_family_planning:{},total_reference_family_planning_soins:{},total_reference_femme_enceinte_soins:{},total_vad_femme_enceinte_soins:{},total_vad_femme_enceinte_NC_soins:{},total_test_de_grossesse_domicile:{},total_newborn_suivi:{},total_reference_newborn:{},total_malnutrition_suivi:{},total_reference_malnutrition_suivi:{},total_prenatal_suivi:{},total_reference_prenatal_suivi:{},total_postnatal_suivi:{},total_reference_postnatal_suivi:{},total_vad_femme_postpartum_NC:{},total_vad_women_emergency_suivi:{},total_reference_women_emergency_suivi:{},total_femme_enceinte_women_emergency_suivi:{},total_femme_postpartum_women_emergency_suivi:{},total_family_planning_renewal_suivi:{},total_reference_family_planning_renewal_suivi:{},total_vad_family_planning_NC:{}};for(let g=0;g<this.allChwsList.length;g++){const d=this.allChwsList[g].id;null!=d&&""!=d&&Object.entries(o).map(([s,l])=>{const a=l;a.hasOwnProperty(d)||(a[d]={chwId:d,count:0})})}for(let g=0;g<this.AllChwsDataFromDbList.length;g++){const d=this.AllChwsDataFromDbList[g];if(null!=d){const s=d.form,l=d.fields,a=null!=d.chw&&null!=d.chw.id&&""!=d.chw.id?d.chw.id:"",Z=null!=d.site&&null!=d.site.id&&""!=d.site.id?d.site.id:"",C=null!=d.source&&""!=d.source?d.source:"",T=p.F.isNotNull(a)&&p.F.isNotNull(f)&&f?.includes(a)||!p.F.isNotNull(f),L=p.F.isNotNull(Z)&&p.F.isNotNull(r)&&r?.includes(Z)||!p.F.isNotNull(r),A=p.F.isNotNull(C)&&p.F.isNotNull(u)&&u?.includes(C)||!p.F.isNotNull(u),N=!(!p.F.isNotNull(n)||!p.F.isNotNull(c))&&p.E.isBetween(`${n}`,d.reported_date,`${c}`);if(T&&L&&N&&A){if("home_visit"===s&&(o.total_home_visit[a].count+=1),"pcime_c_asc"===s&&(o.total_pcime_soins[a].count+=1,"yes"==l["group_review.s_have_you_refer_child"]&&(o.total_reference_pcime_soins[a].count+=1),"true"==l.has_diarrhea&&(o.total_diarrhee_pcime_soins[a].count+=1,"true"==l.within_24h&&(o.prompt_diarrhee_24h_pcime_soins[a].count+=1),("true"==l.within_24h||"true"==l.within_48h)&&(o.prompt_diarrhee_48h_pcime_soins[a].count+=1),("true"==l.within_24h||"true"==l.within_48h||"true"==l.within_72h)&&(o.prompt_diarrhee_72h_pcime_soins[a].count+=1)),"true"==l.fever_with_malaria&&(o.total_paludisme_pcime_soins[a].count+=1,"true"==l.within_24h&&(o.prompt_paludisme_24h_pcime_soins[a].count+=1),("true"==l.within_24h||"true"==l.within_48h)&&(o.prompt_paludisme_48h_pcime_soins[a].count+=1),("true"==l.within_24h||"true"==l.within_48h||"true"==l.within_72h)&&(o.prompt_paludisme_72h_pcime_soins[a].count+=1)),"true"==l.has_pneumonia&&(o.total_pneumonie_pcime_soins[a].count+=1,"true"==l.within_24h&&(o.prompt_pneumonie_24h_pcime_soins[a].count+=1),("true"==l.within_24h||"true"==l.within_48h)&&(o.prompt_pneumonie_48h_pcime_soins[a].count+=1),("true"==l.within_24h||"true"==l.within_48h||"true"==l.within_72h)&&(o.prompt_pneumonie_72h_pcime_soins[a].count+=1)),"true"==l.has_malnutrition&&(o.total_malnutrition_pcime_soins[a].count+=1)),"pcime_c_followup"===s&&(o.total_pcime_suivi[a].count+=1,"yes"==l["group_review.s_have_you_refer_child"]&&(o.total_reference_pcime_suivi[a].count+=1)),"newborn_followup"===s&&(o.total_newborn_suivi[a].count+=1,"yes"==l["group_summary.s_have_you_refer_child"]&&(o.total_reference_newborn[a].count+=1)),"malnutrition_followup"===s&&(o.total_malnutrition_suivi[a].count+=1,"yes"==l["results_page.s_have_you_refer_child"]&&(o.total_reference_malnutrition_suivi[a].count+=1)),"prenatal_followup"===s&&(o.total_prenatal_suivi[a].count+=1,"yes"==l["group_summary.s_have_you_refer_child"]&&(o.total_reference_prenatal_suivi[a].count+=1)),"postnatal_followup"===s&&(o.total_postnatal_suivi[a].count+=1,"yes"==l["group_summary.s_have_you_refer_child"]&&(o.total_reference_postnatal_suivi[a].count+=1),"1"==l.follow_up_count&&(o.total_vad_femme_postpartum_NC[a].count+=1)),"pregnancy_family_planning"===s){o.total_pregnancy_family_planning[a].count+=1;var _="positive"==l["s_reg_pregnancy_screen.s_reg_urine_result"],w="already_pregnant"==l["s_reg_pregnancy_screen.s_reg_why_urine_test_not_done"];"yes"==l["s_reg_pregnancy_screen.s_reg_urine_test"]&&(o.total_test_de_grossesse_domicile[a].count+=1),"yes"==l["s_summary.s_have_you_refer_child"]&&!_&&!w&&(o.total_reference_family_planning_soins[a].count+=1),(_||w)&&(o.total_vad_femme_enceinte_soins[a].count+=1,"fp_followup"!=l["s_reg_mode.s_reg_how_found"]&&(o.total_vad_femme_enceinte_NC_soins[a].count+=1),"yes"==l["s_summary.s_have_you_refer_child"]&&(o.total_reference_femme_enceinte_soins[a].count+=1)),"yes"==l["s_fam_plan_screen.agreed_to_fp"]&&(o.total_vad_family_planning_NC[a].count+=1)}"women_emergency_followup"===s&&(o.total_vad_women_emergency_suivi[a].count+=1,"yes"==l["group_summary.s_have_you_refer_child"]&&(o.total_reference_women_emergency_suivi[a].count+=1),"pregnant"==l["initial.woman_status"]&&(o.total_femme_enceinte_women_emergency_suivi[a].count+=1),"postpartum"==l["initial.woman_status"]&&(o.total_femme_postpartum_women_emergency_suivi[a].count+=1)),"fp_follow_up_renewal"===s&&(o.total_family_planning_renewal_suivi[a].count+=1,"true"==l["checklist2.s_refer_for_health_state"]&&(o.total_reference_family_planning_renewal_suivi[a].count+=1))}}}this.transformData(o,t)}}transformData(t,n){const{start_date:c,end_date:f}=n;if(p.F.isNotNull(c)&&p.F.isNotNull(f)){var _={total_vad:0,total_vad_pcime_c:0,total_suivi_pcime_c:0,total_vad_femmes_enceinte:0,total_vad_femmes_postpartum:0,total_recherche_active:0,total_vad_family_planning:0,reference_femmes_pf:0,reference_pcime:0,reference_femmes_enceinte_postpartum:0,total_diarrhee_pcime_soins:0,total_paludisme_pcime_soins:0,total_pneumonie_pcime_soins:0,total_malnutrition_pcime_soins:0,prompt_diarrhee_24h_pcime_soins:0,prompt_diarrhee_48h_pcime_soins:0,prompt_diarrhee_72h_pcime_soins:0,prompt_paludisme_24h_pcime_soins:0,prompt_paludisme_48h_pcime_soins:0,prompt_paludisme_72h_pcime_soins:0,prompt_pneumonie_24h_pcime_soins:0,prompt_pneumonie_48h_pcime_soins:0,prompt_pneumonie_72h_pcime_soins:0,total_vad_femmes_enceintes_NC:0,total_vad_femme_postpartum_NC:0,total_test_de_grossesse_domicile:0};for(let g=0;g<this.allChwsList.length;g++){const s=this.allChwsList[g].id,l=t.total_home_visit[s].count+t.total_pcime_soins[s].count+t.total_pregnancy_family_planning[s].count+t.total_pcime_suivi[s].count+t.total_newborn_suivi[s].count+t.total_prenatal_suivi[s].count+t.total_postnatal_suivi[s].count+t.total_malnutrition_suivi[s].count+t.total_vad_women_emergency_suivi[s].count+t.total_family_planning_renewal_suivi[s].count,a=t.total_pcime_soins[s].count+t.total_pcime_suivi[s].count+t.total_newborn_suivi[s].count+t.total_malnutrition_suivi[s].count,Z=t.total_pcime_suivi[s].count+t.total_newborn_suivi[s].count+t.total_malnutrition_suivi[s].count,C=t.total_reference_family_planning_soins[s].count+t.total_reference_family_planning_renewal_suivi[s].count,T=t.total_reference_pcime_soins[s].count+t.total_reference_pcime_suivi[s].count+t.total_reference_newborn[s].count+t.total_reference_malnutrition_suivi[s].count,L=t.total_reference_femme_enceinte_soins[s].count+t.total_reference_prenatal_suivi[s].count+t.total_reference_postnatal_suivi[s].count+t.total_reference_women_emergency_suivi[s].count,A=t.total_vad_femme_enceinte_soins[s].count+t.total_prenatal_suivi[s].count+t.total_femme_enceinte_women_emergency_suivi[s].count,N=t.total_postnatal_suivi[s].count+t.total_femme_postpartum_women_emergency_suivi[s].count,P=l-(a+A+N+t.total_home_visit[s].count);_.total_vad+=l,_.total_vad_pcime_c+=a,_.total_suivi_pcime_c+=Z,_.total_vad_femmes_enceinte+=A,_.total_vad_femmes_postpartum+=N,_.total_recherche_active+=t.total_home_visit[s].count,_.total_vad_family_planning=P,_.reference_femmes_pf+=C,_.reference_pcime+=T,_.reference_femmes_enceinte_postpartum=L,_.total_diarrhee_pcime_soins+=t.total_diarrhee_pcime_soins[s].count,_.total_paludisme_pcime_soins+=t.total_paludisme_pcime_soins[s].count,_.total_pneumonie_pcime_soins+=t.total_pneumonie_pcime_soins[s].count,_.total_malnutrition_pcime_soins+=t.total_malnutrition_pcime_soins[s].count,_.prompt_diarrhee_24h_pcime_soins+=t.prompt_diarrhee_24h_pcime_soins[s].count,_.prompt_diarrhee_48h_pcime_soins+=t.prompt_diarrhee_48h_pcime_soins[s].count,_.prompt_diarrhee_72h_pcime_soins+=t.prompt_diarrhee_72h_pcime_soins[s].count,_.prompt_paludisme_24h_pcime_soins+=t.prompt_paludisme_24h_pcime_soins[s].count,_.prompt_paludisme_48h_pcime_soins+=t.prompt_paludisme_48h_pcime_soins[s].count,_.prompt_paludisme_72h_pcime_soins+=t.prompt_paludisme_72h_pcime_soins[s].count,_.prompt_pneumonie_24h_pcime_soins+=t.prompt_pneumonie_24h_pcime_soins[s].count,_.prompt_pneumonie_48h_pcime_soins+=t.prompt_pneumonie_48h_pcime_soins[s].count,_.prompt_pneumonie_72h_pcime_soins+=t.prompt_pneumonie_72h_pcime_soins[s].count,_.total_vad_femmes_enceintes_NC+=t.total_vad_femme_enceinte_NC_soins[s].count,_.total_vad_femme_postpartum_NC+=t.total_vad_femme_postpartum_NC[s].count,_.total_test_de_grossesse_domicile+=t.total_test_de_grossesse_domicile[s].count}this.allAggragateData=[],Object.entries(_).map(([g,d])=>{let s={label:p.F.capitaliseDataGiven(g,"_"," "),count:0,icon:"ion-bag",color:"bg-info",detailUrl:"/dashboards/dash1"};return s.count=d,this.allAggragateData.push(s),""})}this.initMsg="",this.isLoading=!1}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(I.p),e.Y36(F._))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-dashboard-one"]],decls:47,vars:11,consts:[[1,"content"],[1,"container-fluid"],[1,"card","card-info"],[1,"overlay-wrapper"],["class","overlay",4,"ngIf"],[1,"card-header"],["novalidate","",3,"formGroup","ngSubmit"],[1,"row"],[1,"col-sm-2","col-6"],[1,"form-group"],["type","date","formControlName","start_date",1,"form-control"],["type","date","formControlName","end_date",1,"form-control"],["class","form-control","multiple","multiple","formControlName","sources",3,"change",4,"ngIf"],["class","form-control",4,"ngIf"],["class","form-control","multiple","multiple","formControlName","sites",3,"change",4,"ngIf"],[1,"col-sm-3","col-6"],["class","form-control","multiple","multiple","formControlName","chws",4,"ngIf"],[1,"col-sm-1","col-6"],["type","submit",1,"btn","btn-warning","form-control",3,"disabled"],[1,"fa","fa-floppy-o","fa-right"],[1,"row","card-body"],["class","col-sm-3 col-6",4,"ngFor","ngForOf","ngForTrackBy"],[1,"overlay"],[1,"fas","fa-3x","fa-sync-alt","fa-spin"],[1,"text-bold","pt-2"],["multiple","multiple","formControlName","sources",1,"form-control",3,"change"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"form-control"],["multiple","multiple","formControlName","sites",1,"form-control",3,"change"],["multiple","multiple","formControlName","chws",1,"form-control"],[1,"inner"],[2,"font-size","40px"],[1,"icon"]],template:function(t,n){1&t&&(e.TgZ(0,"section",0)(1,"div",1)(2,"div",2)(3,"div",3),e.YNc(4,O,4,1,"div",4),e.TgZ(5,"div",5)(6,"form",6),e.NdJ("ngSubmit",function(){return n.initDataFilted()}),e.TgZ(7,"div",7)(8,"div",8)(9,"div",9)(10,"label"),e._uU(11,"Date D\xe9but"),e.qZA(),e._UZ(12,"input",10),e.qZA()(),e.TgZ(13,"div",8)(14,"div",9)(15,"label"),e._uU(16,"Date Fin"),e.qZA(),e._UZ(17,"input",11),e.qZA()(),e.TgZ(18,"div",8)(19,"div",9)(20,"label"),e._uU(21,"Source"),e.qZA(),e.YNc(22,D,2,1,"select",12),e.YNc(23,J,1,0,"select",13),e.qZA()(),e.TgZ(24,"div",8)(25,"div",9)(26,"label"),e._uU(27,"Site"),e.qZA(),e.YNc(28,E,2,1,"select",14),e.YNc(29,Y,1,0,"select",13),e.qZA()(),e.TgZ(30,"div",15)(31,"div",9)(32,"label"),e._uU(33,"ASC"),e.qZA(),e.YNc(34,R,2,1,"select",16),e.YNc(35,G,1,0,"select",13),e.qZA()(),e.TgZ(36,"div",17)(37,"div",9)(38,"label"),e._uU(39,"."),e.qZA(),e.TgZ(40,"button",18),e._uU(41," OK "),e._UZ(42,"span",19),e.qZA()()()()()()()(),e.TgZ(43,"div",20),e.YNc(44,k,10,8,"div",21),e.qZA(),e._UZ(45,"br")(46,"br"),e.qZA()()),2&t&&(e.xp6(4),e.Q6J("ngIf",n.isLoading),e.xp6(2),e.Q6J("formGroup",n.aggradateDataForm),e.xp6(16),e.Q6J("ngIf",n.sourcesList.length>0),e.xp6(1),e.Q6J("ngIf",0==n.sourcesList.length),e.xp6(5),e.Q6J("ngIf",n.sitesList.length>0),e.xp6(1),e.Q6J("ngIf",0==n.sitesList.length),e.xp6(5),e.Q6J("ngIf",n.chwsList.length>0),e.xp6(1),e.Q6J("ngIf",0==n.chwsList.length),e.xp6(5),e.Q6J("disabled",!n.aggradateDataForm.valid),e.xp6(4),e.Q6J("ngForOf",n.allAggragateData)("ngForTrackBy",n.identifyAggragateData))},dependencies:[y.sg,y.O5,m._Y,m.YN,m.Kr,m.Fj,m.K7,m.JJ,m.JL,m.sg,m.u],encapsulation:2}),i})(),canActivate:[U.a],data:{href:"dashboard1",icon:"fa fa-user",label:"Dashboard-1",title:"Dashboard-1"}},{path:"dash2",component:(()=>{class i{constructor(t){this.syncService=t,this.child_forms=["pcime_c_asc","pcime_c_referral","pcime_c_followup","malnutrition_followup","newborn_followup"],this.num_fp_forms=["pregnancy_family_planning","prenatal_followup","postnatal_followup","women_emergency_followup","fp_follow_up_renewal"],this.home_actions_forms=["pcime_c_asc","pcime_c_referral","pcime_c_followup","malnutrition_followup","pregnancy_family_planning","prenatal_followup","postnatal_followup","newborn_followup","home_visit","women_emergency_followup","fp_follow_up_renewal"],this.consultations_followup_forms=["pcime_c_asc","pregnancy_family_planning","pcime_c_followup","pcime_c_referral","malnutrition_followup","prenatal_followup","postnatal_followup","newborn_followup","women_emergency_followup","fp_follow_up_renewal"],this.bodyData=[],this.AllChwsDataFromDbList=[],this.allChwsList=[],this.allSitesList=[],this.source="portal-integratehealth.org.444",this.dhis2Url="dhis2.integratehealth.org/dhis.443"}createDataFilterFormGroup(){return new m.cw({start_date:new m.NI(this.initDate.start_date,[m.kI.required,m.kI.minLength(7)]),end_date:new m.NI(this.initDate.end_date,[m.kI.required,m.kI.minLength(7)]),sites:new m.NI(""),sources:new m.NI("")})}identifyBodyData(t,n){return n.Code}ngOnInit(){this.isLoading=!1,this.initDate=p.E.startEnd21and20Date(),this.aggradateDataForm=this.createDataFilterFormGroup(),this.initAllData()}initAllData(){var t=this;return(0,b.Z)(function*(){t.isLoading=!0,t.initMsg="Chargement des Sites ...",t.syncService.getSitesList({data_source:t.source}).subscribe(n=>{t.allSitesList=n,t.initMsg="Chargement des ASC ...",t.syncService.getChwsList({data_source:t.source}).subscribe(c=>{t.allChwsList=c,t.initDataFilted()},c=>console.log(c.error))},n=>console.log(n.error))})()}returnEmptyArrayIfNul(t){return p.F.isNotNull(t)?t:[]}initDataFilted(){this.isLoading=!0;var r={start_date:this.aggradateDataForm.value.start_date,end_date:this.aggradateDataForm.value.end_date,sites:this.aggradateDataForm.value.sites,data_source:["portal-integratehealth.org.444","dhis2.integratehealth.org/dhis.443"]};this.syncService.getAllData(r).subscribe(u=>{this.AllChwsDataFromDbList=u,this.getAllAboutData(r)},u=>{this.isLoading=!1,console.log(u.error)})}getAllAboutData(t){const{start_date:n,end_date:c,sites:f}=t;var r={};for(let u=0;u<this.allChwsList.length;u++){const o=this.allChwsList[u].id;p.F.isNotNull(o)&&(r.hasOwnProperty(o)||(r[o]={chwId:o,app_total_child_followup:0,dhis_total_child_followup:0,app_total_num_fp_followup:0,dhis_total_num_fp_followup:0,app_total_active_research:0,dhis_total_active_research:0,app_total_consultation_followup:0,dhis_total_consultation_followup:0,app_total_home_visit:0,dhis_total_home_visit:0}))}for(let u=0;u<this.AllChwsDataFromDbList.length;u++){const o=this.AllChwsDataFromDbList[u];if(null!=o){const _=o.form,w=null!=o.chw&&p.F.isNotNull(o.chw.id)?o.chw.id:"",g=null!=o.site&&p.F.isNotNull(o.site.id)?o.site.id:"",d=p.F.isNotNull(g)&&p.F.isNotNull(f)&&f?.includes(g)||!p.F.isNotNull(f),s=!(!p.F.isNotNull(n)||!p.F.isNotNull(c))&&p.E.isBetween(`${n}`,o.reported_date,`${c}`);d&&s&&r.hasOwnProperty(w)&&(o.source==this.dhis2Url?("PCIME"===_&&(r[w].dhis_total_child_followup+=1),("Maternelle"===_||"PF"===_)&&(r[w].dhis_total_num_fp_followup+=1),"Recherche"===_&&(r[w].dhis_total_active_research+=1),"Recherche"!==_&&(r[w].dhis_total_consultation_followup+=1),r[w].dhis_total_home_visit+=1):(this.child_forms.includes(_)&&(r[w].app_total_child_followup+=1),this.num_fp_forms.includes(_)&&(r[w].app_total_num_fp_followup+=1),"home_visit"===_&&(r[w].app_total_active_research+=1),this.consultations_followup_forms.includes(_)&&(r[w].app_total_consultation_followup+=1),this.home_actions_forms.includes(_)&&(r[w].app_total_home_visit+=1)))}}this.bodyData=[],Object.entries(r).map(([u,o])=>{const _=o;this.bodyData.push({Code:this.getChwInfos(_.chwId).external_id,Name:this.getChwInfos(_.chwId).name,Pcime:_.app_total_child_followup,PcimeDhis2:_.dhis_total_child_followup,MaternellePf:_.app_total_num_fp_followup,MaternellePfDhis2:_.dhis_total_num_fp_followup,Recherche:_.app_total_active_research,RechercheDhis:_.dhis_total_active_research,Consultation:_.app_total_consultation_followup,ConsultationDhis:_.dhis_total_consultation_followup,Total:_.app_total_home_visit,TotalDhis:_.dhis_total_home_visit,TotalDiff:this.getRatio(_.app_total_home_visit,_.dhis_total_home_visit,!1).value,Ratio:this.getRatio(_.app_total_home_visit,_.dhis_total_home_visit)})}),this.isLoading=!1}getDataValuesElements(t){for(let n=0;n<t.dataValues.length;n++){const c=t.dataValues[n];if(c.dataElement==t.dataElement&&c.value==t.value)return!0}return!1}getRatio(t,n,c=!0){var f=0,r="success",u=t-n;if(c){const o=100*(t>0?u/t:n/100);(f=+(o<0?-1*o:o).toFixed(2))>0&&f<=5&&(r="warning"),f>5&&(r="danger")}else f=+(u<0?-1*u:u).toFixed(2);return{value:f,color:r}}initTable(){initDataTable("compare_data",!1)}getChwInfos(t,n=!1){for(let f=0;f<this.allChwsList.length;f++){const r=this.allChwsList[f];if(p.F.isNotNull(r))if(1==n){if(p.F.isNotNull(r.external_id)&&r.external_id==t)return r}else if(p.F.isNotNull(r.id)&&r.id==t)return r}}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(F._))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-dashboard-two"]],decls:32,vars:5,consts:[[1,"content-header"],[1,"container-fluid"],[1,"card","card-info"],[1,"overlay-wrapper"],["class","overlay",4,"ngIf"],[1,"card-header"],["novalidate","",3,"formGroup","ngSubmit"],[1,"row"],[1,"col-sm-2","col-6"],[1,"form-group"],["type","date","formControlName","start_date",1,"form-control"],["type","date","formControlName","end_date",1,"form-control"],["formControlName","sites",1,"form-control"],[3,"value",4,"ngFor","ngForOf"],[1,"col-sm-1","col-6"],["type","submit",1,"btn","btn-warning","form-control",3,"disabled"],[1,"fa","fa-floppy-o","fa-right"],["class","content",4,"ngIf"],[1,"overlay"],[1,"fas","fa-3x","fa-sync-alt","fa-spin"],[1,"text-bold","pt-2"],[3,"value"],[1,"content"],[1,"card"],[1,"card-title"],["type","button",3,"click"],[1,"card-body"],["id","compare_data",1,"table","table-bordered","table-hover"],[1,"bg-primary"],["rowspan","2",2,"width","50px"],["rowspan","2",2,"width","150px"],["colspan","2",2,"width","50px"],[2,"width","50px"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"info"],[1,"warning"],[1,"primary"],[1,"final"],[1,""]],template:function(t,n){1&t&&(e.TgZ(0,"section",0)(1,"div",1)(2,"div",2)(3,"div",3),e.YNc(4,$,4,1,"div",4),e.TgZ(5,"div",5)(6,"form",6),e.NdJ("ngSubmit",function(){return n.initDataFilted()}),e.TgZ(7,"div",7)(8,"div",8)(9,"div",9)(10,"label"),e._uU(11,"Date D\xe9but"),e.qZA(),e._UZ(12,"input",10),e.qZA()(),e.TgZ(13,"div",8)(14,"div",9)(15,"label"),e._uU(16,"Date Fin"),e.qZA(),e._UZ(17,"input",11),e.qZA()(),e.TgZ(18,"div",8)(19,"div",9)(20,"label"),e._uU(21,"Site"),e.qZA(),e.TgZ(22,"select",12),e.YNc(23,B,2,2,"option",13),e.qZA()()(),e.TgZ(24,"div",14)(25,"div",9)(26,"label"),e._uU(27,"."),e.qZA(),e.TgZ(28,"button",15),e._uU(29," OK "),e._UZ(30,"span",16),e.qZA()()()()()()()()()(),e.YNc(31,z,51,2,"section",17)),2&t&&(e.xp6(4),e.Q6J("ngIf",n.isLoading),e.xp6(2),e.Q6J("formGroup",n.aggradateDataForm),e.xp6(17),e.Q6J("ngForOf",n.allSitesList),e.xp6(5),e.Q6J("disabled",!n.aggradateDataForm.valid),e.xp6(3),e.Q6J("ngIf",n.bodyData.length>0))},dependencies:[y.sg,y.O5,m._Y,m.YN,m.Kr,m.Fj,m.EJ,m.JJ,m.JL,m.sg,m.u],styles:[".info[_ngcontent-%COMP%]{color:#00f;font-weight:bolder}.warning[_ngcontent-%COMP%]{color:orange;font-size:large;font-weight:bolder}.primary[_ngcontent-%COMP%]{color:purple;font-size:large;font-weight:bolder}.final[_ngcontent-%COMP%]{color:green;font-size:large;font-weight:bolder}.line[_ngcontent-%COMP%]{color:#000;font-size:large;font-weight:bolder}"]}),i})(),canActivate:[U.a],data:{href:"dashboard2",icon:"fa fa-user",label:"Dashboard-2",title:"Dashboard-2"}}];let X=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[q.Bz.forChild(K),q.Bz]}),i})(),W=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[y.ez,m.UX,X]}),i})()}}]);