"use strict";(self.webpackChunkih_portal=self.webpackChunkih_portal||[]).push([["src_app_modules_view-chws-data_view-chws-data_module_ts"],{4556:(Ft,A,m)=>{m.r(A),m.d(A,{ViewChwsDataModule:()=>Dt});var _=m(8692),r=m(92),F=m(3580),g=m(4553),l=m(8629),D=m(8527),x=m(926),t=m(4537),Z=m(7556),v=m(3395);let T=(()=>{class i{constructor(){}ngOnInit(){}csv(e="data",a=","){table2csv(e,a)}excel(e="data"){table2excel(e)}pdf(e="data"){table2pdf(e,"l")}json(e="data"){table2json(e)}print(e="data"){printTable(e)}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=t.Xpm({type:i,selectors:[["table-export"]],decls:16,vars:0,consts:[[3,"click"]],template:function(e,a){1&e&&(t.TgZ(0,"ul")(1,"li")(2,"span",0),t.NdJ("click",function(){return a.excel()}),t._uU(3,"Excel"),t.qZA()(),t.TgZ(4,"li")(5,"span",0),t.NdJ("click",function(){return a.csv()}),t._uU(6,"CSV"),t.qZA()(),t.TgZ(7,"li")(8,"span",0),t.NdJ("click",function(){return a.json()}),t._uU(9,"JSON"),t.qZA()(),t.TgZ(10,"li")(11,"span",0),t.NdJ("click",function(){return a.pdf()}),t._uU(12,"PDF"),t.qZA()(),t.TgZ(13,"li")(14,"span",0),t.NdJ("click",function(){return a.print()}),t._uU(15,"PRINT"),t.qZA()()())},styles:["ul[_ngcontent-%COMP%]{list-style-type:none;margin:0;padding:0;overflow:hidden}li[_ngcontent-%COMP%]{float:left;background-color:#333}li[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;color:#fff;text-align:center;padding:2px 5px;text-decoration:none;font-size:12px;cursor:pointer}li[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:hover{background-color:#111}"]}),i})();class N{constructor(){this.sortOrder=1,this.collator=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"})}startSort(o,e,a=""){return"desc"===e&&(this.sortOrder=-1),(s,d)=>{if("date"===a)return this.sortData(new Date(s[o]),new Date(d[o]));var n=o.split(".");if(n.length>1){if(2==n.length)return this.collator.compare(s[n[0]][n[1]],d[n[0]][n[1]])*this.sortOrder;if(3==n.length)return this.collator.compare(s[n[0]][n[1]][n[2]],d[n[0]][n[1]][n[2]])*this.sortOrder;if(4==n.length)return this.collator.compare(s[n[0]][n[1]][n[2]][n[3]],d[n[0]][n[1]][n[2]][n[3]])*this.sortOrder;if(5==n.length)return this.collator.compare(s[n[0]][n[1]][n[2]][n[3]][n[4]],d[n[0]][n[1]][n[2]][n[3]][n[4]])*this.sortOrder}return this.collator.compare(s[o],d[o])*this.sortOrder}}sortData(o,e){return o<e?-1*this.sortOrder:o>e?1*this.sortOrder:0*this.sortOrder}}let y=(()=>{class i{constructor(e,a){this.renderer=e,this.targetElem=a}sortData(){const e=new N,a=this.targetElem.nativeElement,s=a.getAttribute("data-order"),d=a.getAttribute("data-type"),n=a.getAttribute("data-name");"desc"===s?(this.appSort.sort(e.startSort(n,s,d)),a.setAttribute("data-order","asc")):(this.appSort.sort(e.startSort(n,s,d)),a.setAttribute("data-order","desc"))}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(t.Qsj),t.Y36(t.SBq))},i.\u0275dir=t.lG2({type:i,selectors:[["","appSort",""]],hostBindings:function(e,a){1&e&&t.NdJ("click",function(){return a.sortData()})},inputs:{appSort:"appSort"}}),i})();function U(i,o){if(1&i&&(t.TgZ(0,"div",22),t._UZ(1,"i",23),t.TgZ(2,"div",24),t._uU(3),t.qZA()()),2&i){const e=t.oxw();t.xp6(3),t.hij(" ",e.initMsg,"")}}function $(i,o){if(1&i&&(t.TgZ(0,"option",25),t._uU(1),t.qZA()),2&i){const e=o.$implicit;t.s9C("value",e.id),t.xp6(1),t.hij(" ",e.name," ")}}function O(i,o){if(1&i&&(t.TgZ(0,"option",25),t._uU(1),t.qZA()),2&i){const e=o.$implicit;t.s9C("value",e.id),t.xp6(1),t.hij(" ",e.name," ")}}function S(i,o){1&i&&t._UZ(0,"table-export")}function J(i,o){if(1&i&&(t.TgZ(0,"tr")(1,"td",46),t._uU(2),t.qZA(),t.TgZ(3,"td",46),t._uU(4),t.qZA(),t.TgZ(5,"td",47),t._uU(6),t.qZA(),t.TgZ(7,"td",47),t._uU(8),t.qZA(),t.TgZ(9,"td",48),t._uU(10),t.qZA(),t.TgZ(11,"td",48),t._uU(12),t.qZA(),t.TgZ(13,"td",47),t._uU(14),t.qZA(),t.TgZ(15,"td",47),t._uU(16),t.qZA(),t.TgZ(17,"td",48),t._uU(18),t.qZA(),t.TgZ(19,"td",48),t._uU(20),t.qZA(),t.TgZ(21,"td",49),t._uU(22),t.qZA(),t.TgZ(23,"td",49),t._uU(24),t.qZA(),t.TgZ(25,"td",46)(26,"strong"),t._uU(27),t.qZA()()()),2&i){const e=o.$implicit;t.xp6(2),t.Oqu(e.chw.external_id),t.xp6(2),t.Oqu(e.chw.name),t.xp6(2),t.Oqu(e.data.sum_soins_suivi.tonoudayo),t.xp6(2),t.Oqu(e.data.sum_soins_suivi.dhis2),t.xp6(2),t.Oqu(e.data.sum_enceinte_postpartum.tonoudayo),t.xp6(2),t.Oqu(e.data.sum_enceinte_postpartum.dhis2),t.xp6(2),t.Oqu(e.data.pf.tonoudayo),t.xp6(2),t.Oqu(e.data.pf.dhis2),t.xp6(2),t.Oqu(e.data.home_visit.tonoudayo),t.xp6(2),t.Oqu(e.data.home_visit.dhis2),t.xp6(2),t.Oqu(e.data.total_vad.tonoudayo),t.xp6(2),t.Oqu(e.data.total_vad.dhis2),t.xp6(3),t.Oqu(e.data.sum_total_vad)}}function I(i,o){if(1&i&&(t.TgZ(0,"section",26)(1,"div",27)(2,"div",6)(3,"div",28),t.YNc(4,S,1,0,"table-export",29),t.qZA()(),t.TgZ(5,"div",30)(6,"table",31)(7,"thead")(8,"tr")(9,"th",32),t._uU(10,"Code ASC"),t.qZA(),t.TgZ(11,"th",33),t._uU(12,"Nom ASC"),t.qZA(),t.TgZ(13,"th",34),t._uU(14,"Pcime "),t._UZ(15,"br"),t._uU(16," Appli."),t.qZA(),t.TgZ(17,"th",35),t._uU(18,"Pcime "),t._UZ(19,"br"),t._uU(20," Saisie"),t.qZA(),t.TgZ(21,"th",36),t._uU(22,"Maternel "),t._UZ(23,"br"),t._uU(24," Appli."),t.qZA(),t.TgZ(25,"th",37),t._uU(26,"Maternel "),t._UZ(27,"br"),t._uU(28," Saisie"),t.qZA(),t.TgZ(29,"th",38),t._uU(30,"PF "),t._UZ(31,"br"),t._uU(32," Appli."),t.qZA(),t.TgZ(33,"th",39),t._uU(34,"PF "),t._UZ(35,"br"),t._uU(36," Saisie"),t.qZA(),t.TgZ(37,"th",40),t._uU(38,"Recherche "),t._UZ(39,"br"),t._uU(40," Appli."),t.qZA(),t.TgZ(41,"th",41),t._uU(42,"Recherche "),t._UZ(43,"br"),t._uU(44," Saisie"),t.qZA(),t.TgZ(45,"th",42),t._uU(46,"Somme "),t._UZ(47,"br"),t._uU(48," Appli."),t.qZA(),t.TgZ(49,"th",43),t._uU(50,"Somme "),t._UZ(51,"br"),t._uU(52," Saisie"),t.qZA(),t.TgZ(53,"th",44),t._uU(54,"Total "),t._UZ(55,"br"),t._uU(56," Action"),t.qZA()()(),t.TgZ(57,"tbody"),t.YNc(58,J,28,13,"tr",45),t.qZA()()()()()),2&i){const e=t.oxw();t.xp6(4),t.Q6J("ngIf",e.roles.canDownloadReports()),t.xp6(5),t.Q6J("appSort",e.FinalChwsOutputData$),t.xp6(2),t.Q6J("appSort",e.FinalChwsOutputData$),t.xp6(2),t.Q6J("appSort",e.FinalChwsOutputData$),t.xp6(4),t.Q6J("appSort",e.FinalChwsOutputData$),t.xp6(4),t.Q6J("appSort",e.FinalChwsOutputData$),t.xp6(4),t.Q6J("appSort",e.FinalChwsOutputData$),t.xp6(4),t.Q6J("appSort",e.FinalChwsOutputData$),t.xp6(4),t.Q6J("appSort",e.FinalChwsOutputData$),t.xp6(4),t.Q6J("appSort",e.FinalChwsOutputData$),t.xp6(4),t.Q6J("appSort",e.FinalChwsOutputData$),t.xp6(4),t.Q6J("appSort",e.FinalChwsOutputData$),t.xp6(4),t.Q6J("appSort",e.FinalChwsOutputData$),t.xp6(4),t.Q6J("appSort",e.FinalChwsOutputData$),t.xp6(5),t.Q6J("ngForOf",e.FinalChwsOutputData$)}}let M=(()=>{class i{constructor(e,a){this.auth=e,this.sync=a,this.roles=new D.G(this.auth),this.FinalChwsOutputData$=[],this.Districts$=[],this.Chws$=[],this.Sites$=[],this.chws$=[],this.sites$=[],this.responseMessage=""}sum(e){throw new Error("Method not implemented.")}createDataFilterFormGroup(){return new r.cw({start_date:new r.NI(this.initDate.start_date,[r.kI.required,r.kI.minLength(7)]),end_date:new r.NI(this.initDate.end_date,[r.kI.required,r.kI.minLength(7)]),districts:new r.NI(""),sites:new r.NI(""),withRatio:new r.NI(!1,[r.kI.required])})}identifyBodyData(e,a){return a.Code}ngOnInit(){this.isLoading=!1,this.initDate=(0,x.vW)(),this.aggradateDataForm=this.createDataFilterFormGroup(),this.initAllData()}initAllData(){var e=this;return(0,g.Z)(function*(){e.isLoading=!0,e.initMsg="Chargement des Districts ...",e.sync.getDistrictsList().subscribe(function(){var a=(0,g.Z)(function*(s){200==s.status&&(e.Districts$=s.data),e.initMsg="Chargement des Sites ...",e.sync.getSitesList().subscribe(function(){var d=(0,g.Z)(function*(n){200==n.status&&(e.Sites$=n.data),e.genarateSites(),e.initMsg="Chargement des ASC ...",e.sync.getChwsList().subscribe(function(){var c=(0,g.Z)(function*(u){200==u.status&&(e.Chws$=u.data),e.genarateChws(),e.isLoading=!1});return function(u){return c.apply(this,arguments)}}(),c=>{e.isLoading=!1,console.log(c.error)})});return function(n){return d.apply(this,arguments)}}(),d=>{e.isLoading=!1,console.log(d.error)})});return function(s){return a.apply(this,arguments)}}(),a=>{e.isLoading=!1,console.log(a.error)})})()}genarateSites(){this.sites$=[],this.chws$=[];const e=this.aggradateDataForm.value.districts;if(this.aggradateDataForm.value.sites="",this.aggradateDataForm.value.chws=[],(0,l.Nf)(e))for(let a=0;a<this.Sites$.length;a++){const s=this.Sites$[a];(0,l.Nf)(s)&&e.includes(s.district.id)&&this.sites$.push(s)}else this.sites$=[]}genarateChws(){const e=(0,l.pb)(this.aggradateDataForm.value.sites);if(this.chws$=[],this.aggradateDataForm.value.chws=[],(0,l.Nf)(e))for(let a=0;a<this.Chws$.length;a++){const s=this.Chws$[a];(0,l.Nf)(s)&&e.includes(s.site.id)&&this.chws$.push(s)}else this.chws$=this.Chws$}ParamsToFilter(){return{start_date:this.aggradateDataForm.value.start_date,end_date:this.aggradateDataForm.value.end_date,districts:(0,l.pb)(this.aggradateDataForm.value.districts),sites:(0,l.pb)(this.aggradateDataForm.value.sites),withDhis2Data:!0}}initDataFilted(e){this.initMsg="Loading Data ...",this.isLoading=!0,this.genarateChws(),this.sync.ihChtDataPerChw(e??this.ParamsToFilter()).subscribe(a=>{200==a.status?this.FinalChwsOutputData$=a.data:this.responseMessage=a.data,this.isLoading=!1},a=>{this.isLoading=!1,console.log(a)})}isRatioChecked(){return 1==this.aggradateDataForm.value.withRatio}getRatio(e,a,s=!0){var d=0,n="success",c=e-a;if(s){const u=100*(e>0?c/e:a/100);(d=+(u<0?-1*u:u).toFixed(2))>0&&d<=5&&(n="warning"),d>5&&(n="danger")}else d=+(c<0?-1*c:c).toFixed(2);return{value:d,color:n}}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(Z.e),t.Y36(v._))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-dashboard-1"]],decls:42,vars:6,consts:[[1,"content-header"],[1,"container-fluid"],[1,"card","card-info"],[1,"title",2,"text-align","center","color","purple"],[1,"overlay-wrapper"],["class","overlay",4,"ngIf"],[1,"card-header"],["novalidate","",3,"formGroup","ngSubmit"],[1,"row"],[1,"col-sm-2","col-6"],[1,"form-group"],["type","date","formControlName","start_date",1,"form-control"],["type","date","formControlName","end_date",1,"form-control"],[1,"col-sm-3","col-6"],["formControlName","districts",1,"form-control",3,"change"],["value",""],[3,"value",4,"ngFor","ngForOf"],["formControlName","sites",1,"form-control",3,"change"],[2,"color","white"],["type","submit",1,"btn","btn-warning","form-control",3,"disabled"],[1,"fa","fa-floppy-o","fa-right"],["class","content",4,"ngIf"],[1,"overlay"],[1,"fas","fa-3x","fa-sync-alt","fa-spin"],[1,"text-bold","pt-2"],[3,"value"],[1,"content"],[1,"card"],[1,"card-title"],[4,"ngIf"],[1,"card-body",2,"overflow-y","scroll!important"],["border","1 solid","id","export_table",1,"table","table-bordered","table-hover","border"],["data-order","desc","data-name","chw.external_id",1,"bg-info",2,"width","50px",3,"appSort"],["data-order","desc","data-name","chw.name",1,"bg-info",2,"width","150px",3,"appSort"],["data-order","desc","data-name","data.sum_soins_suivi.tonoudayo",1,"bg-warning",2,"width","40px",3,"appSort"],["data-order","desc","data-name","data.sum_soins_suivi.dhis2",1,"bg-warning",2,"width","40px",3,"appSort"],["data-order","desc","data-name","data.sum_enceinte_postpartum.tonoudayo",1,"bg-primary",2,"width","40px",3,"appSort"],["data-order","desc","data-name","data.sum_enceinte_postpartum.dhis2",1,"bg-primary",2,"width","40px",3,"appSort"],["data-order","desc","data-name","data.pf.tonoudayo",1,"bg-warning",2,"width","40px",3,"appSort"],["data-order","desc","data-name","data.pf.dhis2",1,"bg-warning",2,"width","40px",3,"appSort"],["data-order","desc","data-name","data.home_visit.tonoudayo",1,"bg-primary",2,"width","40px",3,"appSort"],["data-order","desc","data-name","data.home_visit.dhis2",1,"bg-primary",2,"width","40px",3,"appSort"],["data-order","desc","data-name","data.total_vad.tonoudayo",1,"bg-success",2,"width","40px",3,"appSort"],["data-order","desc","data-name","data.total_vad.dhis2",1,"bg-success",2,"width","40px",3,"appSort"],["data-order","desc","data-name","data.sum_total_vad",1,"bg-info",2,"width","40px",3,"appSort"],[4,"ngFor","ngForOf"],[1,"info"],[1,"warning"],[1,"primary"],[1,"final"]],template:function(e,a){1&e&&(t.TgZ(0,"section",0)(1,"div",1)(2,"div",2)(3,"h2",3),t._uU(4,"Activit\xe9 des ASC"),t.qZA(),t.TgZ(5,"div",4),t.YNc(6,U,4,1,"div",5),t.TgZ(7,"div",6)(8,"form",7),t.NdJ("ngSubmit",function(){return a.initDataFilted()}),t.TgZ(9,"div",8)(10,"div",9)(11,"div",10)(12,"label"),t._uU(13,"Date D\xe9but"),t.qZA(),t._UZ(14,"input",11),t.qZA()(),t.TgZ(15,"div",9)(16,"div",10)(17,"label"),t._uU(18,"Date Fin"),t.qZA(),t._UZ(19,"input",12),t.qZA()(),t.TgZ(20,"div",13)(21,"div",10)(22,"label"),t._uU(23,"District"),t.qZA(),t.TgZ(24,"select",14),t.NdJ("change",function(){return a.genarateSites()}),t._UZ(25,"option",15),t.YNc(26,$,2,2,"option",16),t.qZA()()(),t.TgZ(27,"div",13)(28,"div",10)(29,"label"),t._uU(30,"Site"),t.qZA(),t.TgZ(31,"select",17),t.NdJ("change",function(){return a.genarateChws()}),t._UZ(32,"option",15),t.YNc(33,O,2,2,"option",16),t.qZA()()(),t.TgZ(34,"div",9)(35,"div",10)(36,"label",18),t._uU(37,"."),t.qZA(),t.TgZ(38,"button",19),t._uU(39," OK "),t._UZ(40,"span",20),t.qZA()()()()()()()()()(),t.YNc(41,I,59,15,"section",21)),2&e&&(t.xp6(6),t.Q6J("ngIf",a.isLoading),t.xp6(2),t.Q6J("formGroup",a.aggradateDataForm),t.xp6(18),t.Q6J("ngForOf",a.Districts$),t.xp6(7),t.Q6J("ngForOf",a.sites$),t.xp6(5),t.Q6J("disabled",!a.aggradateDataForm.valid),t.xp6(3),t.Q6J("ngIf",a.FinalChwsOutputData$.length>0))},dependencies:[_.sg,_.O5,r._Y,r.YN,r.Kr,r.Fj,r.EJ,r.JJ,r.JL,r.sg,r.u,T,y],styles:[".info[_ngcontent-%COMP%]{color:#00f;font-weight:bolder}.warning[_ngcontent-%COMP%]{color:orange;font-size:large;font-weight:bolder}.primary[_ngcontent-%COMP%]{color:purple;font-size:large;font-weight:bolder}.final[_ngcontent-%COMP%]{color:green;font-size:large;font-weight:bolder}.line[_ngcontent-%COMP%]{color:#000;font-size:large;font-weight:bolder}input[_ngcontent-%COMP%], select[_ngcontent-%COMP%], label[_ngcontent-%COMP%], .submit[_ngcontent-%COMP%], .title[_ngcontent-%COMP%]{margin-bottom:-10px!important}"]}),i})();function P(i,o){if(1&i&&(t.TgZ(0,"div",26),t._UZ(1,"i",27),t.TgZ(2,"div",28),t._uU(3),t.qZA()()),2&i){const e=t.oxw();t.xp6(3),t.hij(" ",e.initMsg,"")}}function L(i,o){if(1&i&&(t.TgZ(0,"option",30),t._uU(1),t.qZA()),2&i){const e=o.$implicit;t.s9C("value",e.id),t.xp6(1),t.hij(" ",e.name," ")}}function Q(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"select",29),t.NdJ("change",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.genarateSites())}),t.YNc(1,L,2,2,"option",15),t.qZA()}if(2&i){const e=t.oxw();t.Q6J("multiple",e.Districts$.length>0?"multiple":""),t.xp6(1),t.Q6J("ngForOf",e.Districts$)}}function k(i,o){if(1&i&&(t.TgZ(0,"option",30),t._uU(1),t.qZA()),2&i){const e=o.$implicit;t.s9C("value",e.id),t.xp6(1),t.hij(" ",e.name," ")}}function z(i,o){if(1&i&&(t.TgZ(0,"option",30),t._uU(1),t.qZA()),2&i){const e=o.$implicit;t.s9C("value",e.id),t.xp6(1),t.hij(" ",e.name," ")}}function Y(i,o){if(1&i&&(t.TgZ(0,"option",30),t._uU(1),t.qZA()),2&i){const e=o.$implicit;t.s9C("value",e),t.xp6(1),t.hij(" ",e," ")}}function E(i,o){if(1&i&&(t.TgZ(0,"div",9)(1,"div",10)(2,"label"),t._uU(3,"Source"),t.qZA(),t.TgZ(4,"select",31)(5,"option",32),t._uU(6,"Tout"),t.qZA(),t.YNc(7,Y,2,2,"option",15),t.qZA()()()),2&i){const e=t.oxw();t.xp6(7),t.Q6J("ngForOf",e.Sources$)}}function G(i,o){if(1&i&&(t.TgZ(0,"option",30)(1,"strong"),t._uU(2),t.qZA(),t._uU(3),t.qZA()),2&i){const e=o.$implicit;t.s9C("value",e),t.xp6(2),t.hij("",e," "),t.xp6(1),t.hij(" ",e<=1?"jour":"jours"," ")}}function V(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"div",9)(1,"div",10)(2,"label"),t._uU(3,"Nbr de Jour"),t.qZA(),t.TgZ(4,"select",33),t.NdJ("change",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.initDataFilted())}),t.YNc(5,G,4,3,"option",15),t.qZA()()()}if(2&i){const e=t.oxw();t.xp6(5),t.Q6J("ngForOf",e.days$)}}function H(i,o){if(1&i&&(t.TgZ(0,"h2")(1,"div",2)(2,"div",34),t._uU(3),t.qZA()()()),2&i){const e=t.oxw();t.xp6(3),t.hij(" ",e.data_error_messages," ")}}function R(i,o){1&i&&(t.TgZ(0,"h2")(1,"div",2)(2,"div",34),t._uU(3," Pas de donn\xe9es trouv\xe9e avec les paramettres renseign\xe9s ! "),t.qZA()()())}function K(i,o){1&i&&t._UZ(0,"table-export")}function B(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"tr")(1,"td")(2,"span",41)(3,"b"),t._uU(4),t.qZA()(),t._UZ(5,"br"),t.TgZ(6,"span",42),t._uU(7),t.qZA(),t._UZ(8,"br"),t.TgZ(9,"span",43)(10,"small"),t._uU(11,"Total Action: "),t.qZA(),t.TgZ(12,"b"),t._uU(13),t.qZA()()(),t.TgZ(14,"td")(15,"span",44),t._uU(16,"~ "),t.qZA(),t.TgZ(17,"span",45),t._uU(18),t.qZA(),t._UZ(19,"br"),t.TgZ(20,"span",46)(21,"strong"),t._uU(22,"Actions/Jr"),t.qZA()()(),t.TgZ(23,"td")(24,"button",47),t.NdJ("click",function(){const d=t.CHM(e).$implicit,n=t.oxw(2);return t.KtG(n.seeSelectedChwData(d))}),t._uU(25,"D\xe9tails"),t.qZA()()()}if(2&i){const e=o.$implicit,a=t.oxw(2);t.xp6(4),t.Oqu(e.chw.name),t.xp6(3),t.Oqu(e.chw.external_id),t.xp6(6),t.Oqu(a.sum(e.data)),t.xp6(4),t.Gre("custom-action badge ",a.getVadPerDay(e).class,""),t.xp6(1),t.hij(" ",a.getVadPerDay(e).val," ")}}function X(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"div",2)(1,"div",35)(2,"div",6)(3,"div",36),t.YNc(4,K,1,0,"table-export",23),t.qZA()(),t.TgZ(5,"div",37)(6,"table",38),t.NdJ("click",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.sort())}),t.TgZ(7,"thead")(8,"tr",39)(9,"th"),t._uU(10,"ASC"),t.qZA(),t.TgZ(11,"th"),t._uU(12,"Nbre Action/Jour"),t.qZA(),t._UZ(13,"th"),t.qZA()(),t.TgZ(14,"tbody"),t.YNc(15,B,26,7,"tr",40),t.qZA()()()()()}if(2&i){const e=t.oxw();t.xp6(4),t.Q6J("ngIf",e.roles.canDownloadReports()),t.xp6(11),t.Q6J("ngForOf",e.FinalChwsOutputData$)}}function j(i,o){if(1&i&&(t.TgZ(0,"div",60)(1,"div",61)(2,"h3",62),t._uU(3),t.qZA(),t.TgZ(4,"p",63)(5,"strong"),t._uU(6),t.qZA()()(),t.TgZ(7,"div",64),t._UZ(8,"i",65),t.qZA()()),2&i){const e=t.oxw().$implicit,a=t.oxw(2);t.xp6(3),t.Oqu(a.generateCount(e.value)),t.xp6(3),t.Oqu(a.capitaliseDataGiven(e.key,"_"," "))}}function W(i,o){if(1&i&&(t.TgZ(0,"div"),t.YNc(1,j,9,2,"div",59),t.qZA()),2&i){const e=o.$implicit,a=t.oxw(2);t.Tol(a.showClass(e)),t.xp6(1),t.Q6J("ngIf",a.isNumber(e.value))}}function tt(i,o){if(1&i&&(t.TgZ(0,"div",48)(1,"div",49)(2,"div",50)(3,"div",51)(4,"h2"),t._uU(5),t._UZ(6,"br"),t.TgZ(7,"small"),t._uU(8),t.qZA()(),t.TgZ(9,"button",52)(10,"span",53),t._uU(11,"\xd7"),t.qZA()()(),t.TgZ(12,"div",54)(13,"div",55),t.YNc(14,W,2,4,"div",56),t.ALo(15,"keyvalue"),t.qZA()(),t.TgZ(16,"div",57)(17,"button",58),t._uU(18,"Fermer"),t.qZA()()()()()),2&i){const e=t.oxw();t.xp6(5),t.hij(" ",e.selectedChwData.chw.name," "),t.xp6(3),t.Oqu(e.selectedChwData.chw.external_id),t.xp6(6),t.Q6J("ngForOf",t.lcZ(15,3,e.selectedChwData.data))}}let et=(()=>{class i{constructor(e,a){this.auth=e,this.sync=a,this.roles=new D.G(this.auth),this.allAggragateData=[],this.data_error_messages="",this.data_no_data_found=!1,this.FinalChwsOutputData$=[],this.selectedChwData=null,this.ChwsDataFromDbError="",this.Sources$=[],this.Districts$=[],this.Sites$=[],this.Chws$=[],this.Zones$=[],this.Patients$=[],this.Families$=[],this.chws$=[],this.sites$=[],this.days$=(0,l.w6)(24,1),this.day=22}createDataFilterFormGroup(){return new r.cw({start_date:new r.NI(this.initDate.start_date,[r.kI.required,r.kI.minLength(7)]),end_date:new r.NI(this.initDate.end_date,[r.kI.required,r.kI.minLength(7)]),sources:new r.NI(""),districts:new r.NI("",[r.kI.required]),sites:new r.NI("",[r.kI.required]),chws:new r.NI(""),day:new r.NI(this.day,[r.kI.required])})}identifyAggragateData(e,a){return a.total_vad}generateCount(e){return e.tonoudayo+e.dhis2}isNumber(e){return!isNaN(this.generateCount(e))}showClass(e){return this.isNumber(e)?"col-sm-6 col-6":""}ngOnInit(){this.isLoading=!1,this.initDate=(0,x.vW)(),this.aggradateDataForm=this.createDataFilterFormGroup(),this.initAllData()}initAllData(){var e=this;return(0,g.Z)(function*(){e.isLoading=!0;const a=e.ParamsToFilter();e.initMsg="Chargement des Districts ...",e.sync.getDistrictsList(a).subscribe(function(){var s=(0,g.Z)(function*(d){200==d.status&&(e.Districts$=d.data),e.initMsg="Chargement des Sites ...",e.sync.getSitesList(a).subscribe(function(){var n=(0,g.Z)(function*(c){200==c.status&&(e.Sites$=c.data),e.genarateSites(),e.initMsg="Chargement des ASC ...",e.sync.getChwsList(a).subscribe(function(){var u=(0,g.Z)(function*(f){200==f.status&&(e.Chws$=f.data),e.genarateChws(),e.isLoading=!1});return function(f){return u.apply(this,arguments)}}(),u=>{e.isLoading=!1,console.log(u.error)})});return function(c){return n.apply(this,arguments)}}(),n=>{e.isLoading=!1,console.log(n.error)})});return function(d){return s.apply(this,arguments)}}(),s=>{e.isLoading=!1,console.log(s.error)})})()}sort(){sortTable("export_table")}capitaliseDataGiven(e,a,s){return(0,l.Fs)(e,a,s)}seeSelectedChwData(e){this.selectedChwData=e}genarateSites(){this.sites$=[],this.chws$=[];const e=(0,l.Dk)(this.aggradateDataForm.value.districts);if(this.aggradateDataForm.value.sites=[],this.aggradateDataForm.value.chws=[],(0,l.Nf)(e))for(let a=0;a<this.Sites$.length;a++){const s=this.Sites$[a];(0,l.Nf)(s)&&e.includes(s.district.id)&&this.sites$.push(s)}else this.sites$=[]}genarateChws(){const e=(0,l.Dk)(this.aggradateDataForm.value.sites);if(this.chws$=[],this.aggradateDataForm.value.chws=[],(0,l.Nf)(e))for(let a=0;a<this.Chws$.length;a++){const s=this.Chws$[a];(0,l.Nf)(s)&&e.includes(s.site.id)&&this.chws$.push(s)}else this.chws$=[]}ParamsToFilter(){const s=this.aggradateDataForm.value.sources;return{start_date:this.aggradateDataForm.value.start_date,end_date:this.aggradateDataForm.value.end_date,sources:(0,l.Nf)(s)?(0,l.pb)(s):[],districts:(0,l.Dk)(this.aggradateDataForm.value.districts),sites:(0,l.Dk)(this.aggradateDataForm.value.sites),chws:(0,l.Dk)(this.aggradateDataForm.value.chws),withDhis2Data:!0}}returnDataAsArray(e){return(0,l.Nf)(e)?e:[]}getVadPerDay(e){const a=this.sum(e.data),s=a/this.day;var d=s.toFixed(s<1?1:0);if(e.chw.name.includes("(R)")&&a<=0)return{val:d,class:""};var n="bg-success";return a>0&&s<10*this.day/this.day&&s>=5*this.day/this.day&&(n="bg-warning"),(0==a||a>0&&s<5*this.day/this.day)&&(n="bg-danger"),{val:d,class:n}}initDataFilted(e){this.isLoading=!0,this.selectedChwData=null,this.day=this.aggradateDataForm.value.day;const a=e??this.ParamsToFilter();this.defaultParams?.start_date!=a.start_date||this.defaultParams?.end_date!=a.end_date||this.defaultParams?.districts!=a.districts||this.defaultParams?.sites!=a.sites||this.defaultParams?.chws!=a.chws?(this.FinalChwsOutputData$=[],this.data_error_messages="",this.data_no_data_found=!1,this.ChwsDataFromDbError="",this.sync.ihChtDataPerChw(a).subscribe(s=>{this.response$=s,this.startTraitement(a)},s=>{this.isLoading=!1,this.ChwsDataFromDbError=s.toString()})):this.startTraitement(a)}sum(e){return e.total_vad.tonoudayo+e.total_vad.dhis2}startTraitement(e){this.isLoading=!0;const a=e??this.ParamsToFilter();200==this.response$.status?(this.FinalChwsOutputData$=this.response$.data,this.defaultParams=a,this.data_no_data_found=this.FinalChwsOutputData$.length<=0):(this.data_error_messages=this.response$.data.toString(),this.data_no_data_found=!0),this.isLoading=!1}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(Z.e),t.Y36(v._))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-dashboard-2"]],decls:55,vars:14,consts:[[1,"content-header"],[1,"container-fluid"],[1,"card","card-info"],[1,"title",2,"text-align","center","color","blue"],[1,"overlay-wrapper"],["class","overlay",4,"ngIf"],[1,"card-header"],["novalidate","",3,"formGroup","ngSubmit"],[1,"row"],[1,"col-sm-2","col-6"],[1,"form-group"],["type","date","formControlName","start_date",1,"form-control"],["type","date","formControlName","end_date",1,"form-control"],["class","form-control","formControlName","districts",3,"multiple","change",4,"ngIf"],["formControlName","sites",1,"form-control",3,"multiple","change"],[3,"value",4,"ngFor","ngForOf"],["formControlName","chws",1,"form-control",3,"multiple"],["class","col-sm-2 col-6",4,"ngIf"],[2,"color","white"],["type","submit",1,"btn","btn-warning","form-control",3,"disabled"],[1,"fa","fa-floppy-o","fa-right"],[1,"content"],[1,"col-sm-5"],[4,"ngIf"],["class","card card-info",4,"ngIf"],["class","modal fade","id","modal-default",4,"ngIf"],[1,"overlay"],[1,"fas","fa-3x","fa-sync-alt","fa-spin"],[1,"text-bold","pt-2"],["formControlName","districts",1,"form-control",3,"multiple","change"],[3,"value"],["formControlName","sources",1,"form-control"],["value",""],["formControlName","day",1,"form-control",2,"font-size","18px",3,"change"],[1,"card-body"],[1,"card"],[1,"card-title"],[1,"card-body","p-0",2,"overflow-y","scroll!important"],["id","export_table",1,"table","table-sm","table-striped",2,"margin","auto",3,"click"],[1,"bg-info"],[4,"ngFor","ngForOf"],[1,"custom-badge",2,"font-size","16px"],[1,"custom-badge",2,"font-size","12px","color","gray"],[1,"info",2,"font-size","16px","color","blue"],[2,"font-size","18px"],[2,"font-size","33px","padding","1px"],[1,"info"],["data-toggle","modal","data-target","#modal-default",1,"btn","btn-info",2,"margin-top","15px","padding","2px!important","font-size","10px",3,"click"],["id","modal-default",1,"modal","fade"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body"],[1,"row","card-body"],[3,"class",4,"ngFor","ngForOf"],[1,"modal-footer","justify-content-between"],["id","close-modal","type","button","data-dismiss","modal",1,"btn","btn-default"],["style","border: 1px solid black;","class","small-box bg-info",4,"ngIf"],[1,"small-box","bg-info",2,"border","1px solid black"],[1,"inner"],[2,"font-size","45px","text-align","center"],[2,"font-size","20px","text-align","center"],[1,"icon"],[1,"ion","ion-stats-bars"]],template:function(e,a){1&e&&(t.TgZ(0,"section",0)(1,"div",1)(2,"div",2)(3,"h2",3),t._uU(4,"ASC Donn\xe9es d\xe9taill\xe9es"),t.qZA(),t.TgZ(5,"div",4),t.YNc(6,P,4,1,"div",5),t.TgZ(7,"div",6)(8,"form",7),t.NdJ("ngSubmit",function(){return a.initDataFilted()}),t.TgZ(9,"div",8)(10,"div",9)(11,"div",10)(12,"label"),t._uU(13,"Date D\xe9but"),t.qZA(),t._UZ(14,"input",11),t.qZA()(),t.TgZ(15,"div",9)(16,"div",10)(17,"label"),t._uU(18,"Date Fin"),t.qZA(),t._UZ(19,"input",12),t.qZA()(),t.TgZ(20,"div",9)(21,"div",10)(22,"label"),t._uU(23,"District"),t.qZA(),t.YNc(24,Q,2,2,"select",13),t.qZA()(),t.TgZ(25,"div",9)(26,"div",10)(27,"label"),t._uU(28,"Site"),t.qZA(),t.TgZ(29,"select",14),t.NdJ("change",function(){return a.genarateChws()}),t.YNc(30,k,2,2,"option",15),t.qZA()()(),t.TgZ(31,"div",9)(32,"div",10)(33,"label"),t._uU(34,"ASC"),t.qZA(),t.TgZ(35,"select",16),t.YNc(36,z,2,2,"option",15),t.qZA()()(),t.YNc(37,E,8,1,"div",17),t.YNc(38,V,6,1,"div",17),t.TgZ(39,"div",9)(40,"div",10)(41,"label",18),t._uU(42,"."),t.qZA(),t.TgZ(43,"button",19),t._uU(44," Charger "),t._UZ(45,"span",20),t.qZA()()()()()()()(),t.TgZ(46,"section",21)(47,"div",1)(48,"div",22),t.YNc(49,H,4,1,"h2",23),t.YNc(50,R,4,0,"h2",23),t.qZA(),t.YNc(51,X,16,2,"div",24),t.qZA()(),t.YNc(52,tt,19,5,"div",25),t._UZ(53,"br")(54,"br"),t.qZA()()),2&e&&(t.xp6(6),t.Q6J("ngIf",a.isLoading),t.xp6(2),t.Q6J("formGroup",a.aggradateDataForm),t.xp6(16),t.Q6J("ngIf",a.Districts$.length>0),t.xp6(5),t.Q6J("multiple",a.sites$.length>0?"multiple":""),t.xp6(1),t.Q6J("ngForOf",a.sites$),t.xp6(5),t.Q6J("multiple",a.chws$.length>0?"multiple":""),t.xp6(1),t.Q6J("ngForOf",a.chws$),t.xp6(1),t.Q6J("ngIf",a.Sources$.length>0),t.xp6(1),t.Q6J("ngIf",a.days$.length>0),t.xp6(5),t.Q6J("disabled",!a.aggradateDataForm.valid),t.xp6(6),t.Q6J("ngIf",""!=a.data_error_messages),t.xp6(1),t.Q6J("ngIf",1==a.data_no_data_found),t.xp6(1),t.Q6J("ngIf",""==a.data_error_messages&&a.FinalChwsOutputData$.length>0),t.xp6(1),t.Q6J("ngIf",null!=a.selectedChwData))},dependencies:[_.sg,_.O5,r._Y,r.YN,r.Kr,r.Fj,r.EJ,r.K7,r.JJ,r.JL,r.sg,r.u,T,_.Nd],styles:[".custom-badge[_ngcontent-%COMP%]{font-size:18px;color:#000}.custom-action[_ngcontent-%COMP%]{font-size:25px;color:#000;text-align:center!important}.info[_ngcontent-%COMP%]{text-align:center!important}.box[_ngcontent-%COMP%]{width:600px;height:300px;border:1px solid black;padding:2px 4px;overflow-y:scroll;overflow-x:auto}.log[_ngcontent-%COMP%]{margin-top:8px;font-family:monospace}input[_ngcontent-%COMP%], select[_ngcontent-%COMP%], label[_ngcontent-%COMP%], .submit[_ngcontent-%COMP%], .title[_ngcontent-%COMP%]{margin-bottom:-10px!important}"]}),i})();var at=m(6083);function it(i,o){if(1&i&&(t.TgZ(0,"div",22),t._UZ(1,"i",23),t.TgZ(2,"div",24),t._uU(3),t.qZA()()),2&i){const e=t.oxw();t.xp6(3),t.hij(" ",e.initMsg,"")}}function st(i,o){if(1&i&&(t.TgZ(0,"option",25),t._uU(1),t.qZA()),2&i){const e=o.$implicit;t.s9C("value",e.id),t.xp6(1),t.hij(" ",e.name," ")}}function nt(i,o){if(1&i&&(t.TgZ(0,"option",25),t._uU(1),t.qZA()),2&i){const e=o.$implicit;t.s9C("value",e.id),t.xp6(1),t.hij(" ",e.name," ")}}function ot(i,o){if(1&i&&(t.TgZ(0,"option",25),t._uU(1),t.qZA()),2&i){const e=o.$implicit;t.s9C("value",e.id),t.xp6(1),t.hij(" ",e.name," ")}}function rt(i,o){if(1&i&&(t.TgZ(0,"div",15)(1,"div")(2,"div",26)(3,"h3",27),t._uU(4),t.qZA(),t.TgZ(5,"p")(6,"strong"),t._uU(7),t.qZA()()(),t.TgZ(8,"div",28),t._UZ(9,"i"),t.qZA()()()),2&i){const e=o.$implicit;t.xp6(1),t.Gre("small-box ",e.color,""),t.xp6(3),t.Oqu(e.count),t.xp6(3),t.Oqu(e.label),t.xp6(2),t.Gre("ion ",e.icon,"")}}let lt=(()=>{class i{constructor(e,a,s){this.auth=e,this.db=a,this.sync=s,this.allAggragateData=[],this.Districts$=[],this.Sites$=[],this.Chws$=[],this.Zones$=[],this.Patients$=[],this.Families$=[],this.chws$=[],this.sites$=[],this.districtsChwsCount=0,this.sitesChwsCount=0,this.zonesChwsCount=0,this.patientsChwsCount=0,this.patientsCibleChwsCount=0,this.familiesChwsCount=0,this.chwsCount=0}createDataFilterFormGroup(){return new r.cw({districts:new r.NI("",[r.kI.required]),sites:new r.NI("",[r.kI.required]),chws:new r.NI("")})}identifyAggragateData(e,a){return a.label}ngOnInit(){this.isLoading=!1,this.aggradateDataForm=this.createDataFilterFormGroup(),this.initAllData(!0)}initAllData(e=!1){var a=this;return(0,g.Z)(function*(){const s=a.ParamsToFilter();1==e?(a.isLoading=!0,a.initMsg="Chargement des Districts ...",a.sync.getDistrictsList(s).subscribe(function(){var d=(0,g.Z)(function*(n){200==n.status&&(a.Districts$=n.data),a.initMsg="Chargement des Sites ...",a.sync.getSitesList(s).subscribe(function(){var c=(0,g.Z)(function*(u){200==u.status&&(a.Sites$=u.data),a.initMsg="Chargement des ASC ...",a.sync.getChwsList(s).subscribe(function(){var f=(0,g.Z)(function*(C){200==C.status&&(a.Chws$=C.data)});return function(C){return f.apply(this,arguments)}}(),f=>{a.isLoading=!1,console.log(f.error)})});return function(u){return c.apply(this,arguments)}}(),c=>{a.isLoading=!1,console.log(c.error)})});return function(n){return d.apply(this,arguments)}}(),d=>{a.isLoading=!1,console.log(d.error)})):a.isLoading=!1,0==e?(a.isLoading=!0,a.initMsg="Chargement des Zones ...",a.sync.getZonesList(s).subscribe(function(){var d=(0,g.Z)(function*(n){200==n.status&&(a.Zones$=n.data),a.initMsg="Chargement des Familles ...",a.sync.getFamilyList(s).subscribe(function(){var c=(0,g.Z)(function*(u){200==u.status&&(a.Families$=u.data),a.initMsg="Chargement des Patients ...",a.sync.getPatientsList(s).subscribe(function(){var f=(0,g.Z)(function*(C){200==C.status&&(a.Patients$=C.data),a.initDataFilted(s)});return function(C){return f.apply(this,arguments)}}(),f=>{a.isLoading=!1,console.log(f)})});return function(u){return c.apply(this,arguments)}}(),c=>{a.isLoading=!1,console.log(c.error)})});return function(n){return d.apply(this,arguments)}}(),d=>{a.isLoading=!1,console.log(d.error)})):a.isLoading=!1})()}formatHostName(e){return e.replace(".org","").replace("-",".").trim()}genarateSites(){this.sites$=[],this.chws$=[];const e=(0,l.Dk)(this.aggradateDataForm.value.districts);if(this.aggradateDataForm.value.sites=[],this.aggradateDataForm.value.chws=[],(0,l.Nf)(e))for(let a=0;a<this.Sites$.length;a++){const s=this.Sites$[a];(0,l.Nf)(s)&&e.includes(s.district.id)&&this.sites$.push(s)}else this.sites$=[]}genarateChws(){const e=(0,l.Dk)(this.aggradateDataForm.value.sites);if(this.chws$=[],this.aggradateDataForm.value.chws=[],(0,l.Nf)(e))for(let a=0;a<this.Chws$.length;a++){const s=this.Chws$[a];(0,l.Nf)(s)&&e.includes(s.site.id)&&this.chws$.push(s)}else this.chws$=[]}ParamsToFilter(){return{districts:(0,l.Dk)(this.aggradateDataForm.value.districts),sites:(0,l.Dk)(this.aggradateDataForm.value.sites),chws:(0,l.Dk)(this.aggradateDataForm.value.chws),withDhis2Data:!1}}initDataFilted(e){this.isLoading=!0;const{chws:d,sites:n,districts:c}=e??this.ParamsToFilter();this.districtsChwsCount=0,this.sitesChwsCount=0,this.familiesChwsCount=0,this.patientsChwsCount=0,this.patientsCibleChwsCount=0,this.zonesChwsCount=0,this.chwsCount=0,this.allAggragateData=[];for(let p=0;p<this.Districts$.length;p++){const h=this.Districts$[p];(0,l.Nf)(c)?c?.includes(h.id)&&this.districtsChwsCount++:this.districtsChwsCount++}for(let p=0;p<this.Sites$.length;p++){const h=this.Sites$[p];(0,l.Nf)(c)&&(0,l.Nf)(n)?c?.includes(h.district.id)&&n?.includes(h.id)&&this.sitesChwsCount++:(0,l.Nf)(c)&&!(0,l.Nf)(n)?c?.includes(h.district.id)&&this.sitesChwsCount++:this.sitesChwsCount++}for(let p=0;p<this.Zones$.length;p++){const h=this.Zones$[p];(0,l.Nf)(c)&&(0,l.Nf)(n)&&(0,l.Nf)(d)?c?.includes(h.site.district.id)&&n?.includes(h.site.id)&&d?.includes(h.chw_id)&&this.zonesChwsCount++:(0,l.Nf)(c)&&(0,l.Nf)(n)&&!(0,l.Nf)(d)?c?.includes(h.site.district.id)&&n?.includes(h.site.id)&&this.zonesChwsCount++:(!(0,l.Nf)(c)||(0,l.Nf)(n)||(0,l.Nf)(d)||c?.includes(h.site.district.id))&&this.zonesChwsCount++}for(let p=0;p<this.Chws$.length;p++){const h=this.Chws$[p];(0,l.Nf)(c)&&(0,l.Nf)(n)&&(0,l.Nf)(d)?c?.includes(h.site.district.id)&&n?.includes(h.site.id)&&d?.includes(h.zone.chw_id)&&this.chwsCount++:(0,l.Nf)(c)&&(0,l.Nf)(n)&&!(0,l.Nf)(d)?c?.includes(h.site.district.id)&&n?.includes(h.site.id)&&this.chwsCount++:(!(0,l.Nf)(c)||(0,l.Nf)(n)||(0,l.Nf)(d)||c?.includes(h.site.district.id))&&this.chwsCount++}for(let p=0;p<this.Families$.length;p++){const h=this.Families$[p];(0,l.Nf)(c)&&(0,l.Nf)(n)&&(0,l.Nf)(d)?c?.includes(h.site.district.id)&&n?.includes(h.site.id)&&d?.includes(h.zone.chw_id)&&this.familiesChwsCount++:(0,l.Nf)(c)&&(0,l.Nf)(n)&&!(0,l.Nf)(d)?c?.includes(h.site.district.id)&&n?.includes(h.site.id)&&this.familiesChwsCount++:(!(0,l.Nf)(c)||(0,l.Nf)(n)||(0,l.Nf)(d)||c?.includes(h.site.district.id))&&this.familiesChwsCount++}for(let p=0;p<this.Patients$.length;p++){const h=this.Patients$[p],w=(0,l.mP)(h).is_in_cible;(0,l.Nf)(c)&&(0,l.Nf)(n)&&(0,l.Nf)(d)?c?.includes(h.site.district.id)&&n?.includes(h.site.id)&&d?.includes(h.zone.chw_id)&&(this.patientsChwsCount++,w&&this.patientsCibleChwsCount++):(0,l.Nf)(c)&&(0,l.Nf)(n)&&!(0,l.Nf)(d)?c?.includes(h.site.district.id)&&n?.includes(h.site.id)&&(this.patientsChwsCount++,w&&this.patientsCibleChwsCount++):(!(0,l.Nf)(c)||(0,l.Nf)(n)||(0,l.Nf)(d)||c?.includes(h.site.district.id))&&(this.patientsChwsCount++,w&&this.patientsCibleChwsCount++)}let u={label:(0,l.Fs)("total_district_enregistre","_"," "),count:this.districtsChwsCount,icon:"ion-stats-bars",color:"bg-info",detailUrl:"/view-chws-data/dashboard1"},f={label:(0,l.Fs)("total_site_enregistre","_"," "),count:this.sitesChwsCount,icon:"ion-stats-bars",color:"bg-info",detailUrl:"/view-chws-data/dashboard1"},C={label:(0,l.Fs)("total_ASC_enregistre","_"," "),count:this.chwsCount,icon:"ion-pie-graph",color:"bg-primary",detailUrl:"/view-chws-data/dashboard1"},q={label:(0,l.Fs)("total_zone_enregistre","_"," "),count:this.zonesChwsCount,icon:"ion-pie-graph",color:"bg-primary",detailUrl:"/view-chws-data/dashboard1"},xt={label:(0,l.Fs)("total_famille_enregistre","_"," "),count:this.familiesChwsCount,icon:"ion-person-add",color:"bg-danger",detailUrl:"/view-chws-data/dashboard1"},Tt={label:(0,l.Fs)("total_patient_enregistre","_"," "),count:this.patientsChwsCount,icon:"ion-person-add",color:"bg-success",detailUrl:"/view-chws-data/dashboard1"},At={label:(0,l.Fs)("total_patient_cible","_"," "),count:this.patientsCibleChwsCount,icon:"ion-person-add",color:"bg-warning",detailUrl:"/view-chws-data/dashboard1"};u.count>1&&this.allAggragateData.push(u),f.count>1&&this.allAggragateData.push(f),C.count>1&&this.allAggragateData.push(C),q.count>1&&this.allAggragateData.push(q),this.allAggragateData.push(xt),this.allAggragateData.push(Tt),this.allAggragateData.push(At),this.initMsg="",this.isLoading=!1}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(Z.e),t.Y36(at.p),t.Y36(v._))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-dashboard-3"]],decls:41,vars:11,consts:[[1,"content-header"],[1,"container-fluid"],[1,"card","card-warning"],[2,"text-align","center"],[1,"overlay-wrapper"],["class","overlay",4,"ngIf"],[1,"card-header"],["novalidate","",3,"formGroup","ngSubmit"],[1,"row"],[1,"col-sm-2","col-6"],[1,"form-group"],["formControlName","districts",1,"form-control",3,"multiple","change"],["value",""],[3,"value",4,"ngFor","ngForOf"],["formControlName","sites",1,"form-control",3,"multiple","change"],[1,"col-sm-3","col-6"],["formControlName","chws",1,"form-control",3,"multiple"],[1,"col-sm-1","col-6"],["type","submit",1,"btn","btn-warning","form-control",3,"disabled"],[1,"nav-icon","fas","fa-search"],[1,"row","card-body"],["class","col-sm-3 col-6",4,"ngFor","ngForOf","ngForTrackBy"],[1,"overlay"],[1,"fas","fa-3x","fa-sync-alt","fa-spin"],[1,"text-bold","pt-2"],[3,"value"],[1,"inner"],[2,"font-size","40px"],[1,"icon"]],template:function(e,a){1&e&&(t.TgZ(0,"section",0)(1,"div",1)(2,"div",2)(3,"h1",3),t._uU(4,"Effectifs des patients"),t.qZA(),t.TgZ(5,"div",4),t.YNc(6,it,4,1,"div",5),t.TgZ(7,"div",6)(8,"form",7),t.NdJ("ngSubmit",function(){return a.initAllData()}),t.TgZ(9,"div",8)(10,"div",9)(11,"div",10)(12,"label"),t._uU(13,"District"),t.qZA(),t.TgZ(14,"select",11),t.NdJ("change",function(){return a.genarateSites()}),t._UZ(15,"option",12),t.YNc(16,st,2,2,"option",13),t.qZA()()(),t.TgZ(17,"div",9)(18,"div",10)(19,"label"),t._uU(20,"Site"),t.qZA(),t.TgZ(21,"select",14),t.NdJ("change",function(){return a.genarateChws()}),t._UZ(22,"option",12),t.YNc(23,nt,2,2,"option",13),t.qZA()()(),t.TgZ(24,"div",15)(25,"div",10)(26,"label"),t._uU(27,"ASC"),t.qZA(),t.TgZ(28,"select",16),t._UZ(29,"option",12),t.YNc(30,ot,2,2,"option",13),t.qZA()()(),t.TgZ(31,"div",17)(32,"div",10)(33,"label"),t._uU(34,"."),t.qZA(),t.TgZ(35,"button",18),t._UZ(36,"i",19),t.qZA()()()()()()()(),t.TgZ(37,"div",20),t.YNc(38,rt,10,8,"div",21),t.qZA(),t._UZ(39,"br")(40,"br"),t.qZA()()),2&e&&(t.xp6(6),t.Q6J("ngIf",a.isLoading),t.xp6(2),t.Q6J("formGroup",a.aggradateDataForm),t.xp6(6),t.Q6J("multiple",a.Districts$.length>0?"multiple":""),t.xp6(2),t.Q6J("ngForOf",a.Districts$),t.xp6(5),t.Q6J("multiple",a.sites$.length>0?"multiple":""),t.xp6(2),t.Q6J("ngForOf",a.sites$),t.xp6(5),t.Q6J("multiple",a.chws$.length>0?"multiple":""),t.xp6(2),t.Q6J("ngForOf",a.chws$),t.xp6(5),t.Q6J("disabled",!a.aggradateDataForm.valid),t.xp6(3),t.Q6J("ngForOf",a.allAggragateData)("ngForTrackBy",a.identifyAggragateData))},dependencies:[_.sg,_.O5,r._Y,r.YN,r.Kr,r.K7,r.JJ,r.JL,r.sg,r.u],styles:["input[_ngcontent-%COMP%], select[_ngcontent-%COMP%], label[_ngcontent-%COMP%], .submit[_ngcontent-%COMP%], .title[_ngcontent-%COMP%]{margin-bottom:-10px!important}"]}),i})();function dt(i,o){if(1&i&&(t.TgZ(0,"div",21),t._UZ(1,"i",22),t.TgZ(2,"div",23),t._uU(3),t.qZA()()),2&i){const e=t.oxw();t.xp6(3),t.hij(" ",e.initMsg,"")}}function ct(i,o){if(1&i&&(t.TgZ(0,"option",24),t._uU(1),t.qZA()),2&i){const e=o.$implicit;t.s9C("value",e.id),t.xp6(1),t.hij(" ",e.name," ")}}function ht(i,o){if(1&i&&(t.TgZ(0,"option",24),t._uU(1),t.qZA()),2&i){const e=o.$implicit;t.s9C("value",e.id),t.xp6(1),t.hij(" ",e.name," ")}}function ut(i,o){if(1&i&&(t.TgZ(0,"option",24),t._uU(1),t.qZA()),2&i){const e=o.$implicit;t.s9C("value",e.id),t.xp6(1),t.hij(" ",e.name," ")}}function pt(i,o){1&i&&t._UZ(0,"table-export")}function gt(i,o){if(1&i&&(t.TgZ(0,"tr")(1,"td")(2,"b"),t._uU(3),t.qZA()(),t.TgZ(4,"td"),t._uU(5),t.qZA(),t.TgZ(6,"td"),t._uU(7),t.qZA(),t.TgZ(8,"td"),t._uU(9),t.qZA()()),2&i){const e=o.$implicit;t.xp6(3),t.Oqu(e.family.name),t.xp6(2),t.Oqu(e.data.visit_in_day),t.xp6(2),t.Oqu(e.data.all_visit),t.xp6(1),t.Tol(e.data.isVisited?"success0":"danger0"),t.xp6(1),t.hij(" ",e.data.isVisited?"Visit\xe9":"Non ","")}}function ft(i,o){if(1&i&&(t.TgZ(0,"section",25)(1,"div",26)(2,"div",6)(3,"div",27),t.YNc(4,pt,1,0,"table-export",28),t.qZA()(),t.TgZ(5,"div",29)(6,"div",30),t._uU(7," Total Familles: "),t.TgZ(8,"strong",31),t._uU(9),t.qZA()(),t.TgZ(10,"div",32),t._uU(11," Total Familles Visit\xe9s: "),t.TgZ(12,"strong",31),t._uU(13),t.qZA()(),t.TgZ(14,"div",33),t._uU(15," Total Famille Non Visit\xe9s: "),t.TgZ(16,"strong",31),t._uU(17),t.qZA()()(),t.TgZ(18,"div",34)(19,"table",35)(20,"thead")(21,"tr",36)(22,"th",37),t._uU(23,"Nom Famille"),t.qZA(),t.TgZ(24,"th",38),t._uU(25,"Visit 1/jour"),t.qZA(),t.TgZ(26,"th",39),t._uU(27,"#Action Total"),t.qZA(),t.TgZ(28,"th",40),t._uU(29,"#Famille Visit\xe9"),t.qZA()()(),t.TgZ(30,"tbody"),t.YNc(31,gt,10,7,"tr",41),t.qZA()()()()()),2&i){const e=t.oxw();t.xp6(4),t.Q6J("ngIf",e.roles.canDownloadReports()),t.xp6(5),t.Oqu(e.ChwsDataInfos$.family_count),t.xp6(4),t.Oqu(e.ChwsDataInfos$.total_visited),t.xp6(4),t.Oqu(e.ChwsDataInfos$.total_not_visited),t.xp6(5),t.Q6J("appSort",e.ChwsDataInfos$.detail),t.xp6(2),t.Q6J("appSort",e.ChwsDataInfos$.detail),t.xp6(2),t.Q6J("appSort",e.ChwsDataInfos$.detail),t.xp6(2),t.Q6J("appSort",e.ChwsDataInfos$.detail),t.xp6(3),t.Q6J("ngForOf",e.ChwsDataInfos$.detail)}}let mt=(()=>{class i{constructor(e,a){this.auth=e,this.sync=a,this.roles=new D.G(this.auth),this.Districts$=[],this.Zones$=[],this.Sites$=[],this.zones$=[],this.sites$=[],this.responseMessage=""}createDataFilterFormGroup(){return new r.cw({start_date:new r.NI(this.initDate.start_date,[r.kI.required,r.kI.minLength(7)]),end_date:new r.NI(this.initDate.end_date,[r.kI.required,r.kI.minLength(7)]),districts:new r.NI("",[r.kI.required]),sites:new r.NI("",[r.kI.required]),zones:new r.NI("",[r.kI.required])})}ngOnInit(){this.isLoading=!1,this.initDate=(0,x.vW)(),this.aggradateDataForm=this.createDataFilterFormGroup(),this.initAllData()}initAllData(){var e=this;return(0,g.Z)(function*(){e.isLoading=!0,e.initMsg="Chargement des Districts ...",e.sync.getDistrictsList().subscribe(function(){var a=(0,g.Z)(function*(s){200==s.status&&(e.Districts$=s.data),e.initMsg="Chargement des Sites ...",e.sync.getSitesList().subscribe(function(){var d=(0,g.Z)(function*(n){200==n.status&&(e.Sites$=n.data),e.initMsg="Chargement des Zones ...",e.sync.getZonesList().subscribe(function(){var c=(0,g.Z)(function*(u){200==u.status&&(e.Zones$=u.data),e.isLoading=!1,e.initMsg=""});return function(u){return c.apply(this,arguments)}}(),c=>{e.isLoading=!1,console.log(c.error)})});return function(n){return d.apply(this,arguments)}}(),d=>{e.isLoading=!1,console.log(d.error)})});return function(s){return a.apply(this,arguments)}}(),a=>{e.isLoading=!1,console.log(a.error)})})()}generateSites(){this.sites$=[],this.zones$=[];const e=this.aggradateDataForm.value.districts;if(this.aggradateDataForm.value.sites="",this.aggradateDataForm.value.zones=[],(0,l.Nf)(e))for(let a=0;a<this.Sites$.length;a++){const s=this.Sites$[a];(0,l.Nf)(s)&&e.includes(s.district.id)&&this.sites$.push(s)}else this.sites$=[]}generateZones(){const e=(0,l.pb)(this.aggradateDataForm.value.sites);if(this.zones$=[],this.aggradateDataForm.value.zones=[],(0,l.Nf)(e))for(let a=0;a<this.Zones$.length;a++){const s=this.Zones$[a];(0,l.Nf)(s)&&e.includes(s.site.id)&&this.zones$.push(s)}else this.zones$=[]}ParamsToFilter(){return{start_date:this.aggradateDataForm.value.start_date,end_date:this.aggradateDataForm.value.end_date,districts:(0,l.pb)(this.aggradateDataForm.value.districts),sites:(0,l.pb)(this.aggradateDataForm.value.sites),zones:(0,l.pb)(this.aggradateDataForm.value.zones),withDhis2Data:!1}}initDataFilted(e){this.initMsg="Loading Data ...",this.isLoading=!0,this.ChwsDataInfos$=void 0,this.sync.getDataInformations(e??this.ParamsToFilter()).subscribe(a=>{200==a.status?this.ChwsDataInfos$=a.data:this.responseMessage=a.data,this.isLoading=!1},a=>{this.isLoading=!1,console.log(a)})}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(Z.e),t.Y36(v._))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-dashboard-4"]],decls:49,vars:7,consts:[[1,"content-header"],[1,"container-fluid"],[1,"card","card-info"],[2,"text-align","center"],[1,"overlay-wrapper"],["class","overlay",4,"ngIf"],[1,"card-header"],["novalidate","",3,"formGroup","ngSubmit"],[1,"row"],[1,"col-sm-2","col-6"],[1,"form-group"],["type","date","formControlName","start_date",1,"form-control"],["type","date","formControlName","end_date",1,"form-control"],["formControlName","districts",1,"form-control",3,"change"],["value",""],[3,"value",4,"ngFor","ngForOf"],["formControlName","sites",1,"form-control",3,"change"],["formControlName","zones",1,"form-control"],["type","submit",1,"btn","btn-warning","form-control",3,"disabled"],[1,"fa","fa-floppy-o","fa-right"],["class","content",4,"ngIf"],[1,"overlay"],[1,"fas","fa-3x","fa-sync-alt","fa-spin"],[1,"text-bold","pt-2"],[3,"value"],[1,"content"],[1,"card",2,"overflow-y","scroll!important"],[1,"card-title"],[4,"ngIf"],[1,"row",2,"margin-top","15px","padding","0px 40px"],[1,"col-sm-4","col-12",2,"font-weight","bold","padding","10px 20px","background-color","rgb(233, 189, 131)"],[2,"font-size","18px"],[1,"col-sm-4","col-12",2,"font-weight","bold","padding","10px 20px","background-color","rgb(190, 207, 159)"],[1,"col-sm-4","col-12",2,"font-weight","bold","padding","10px 20px","background-color","rgb(218, 177, 235)"],[1,"card-body"],["border","1 solid","id","export_table",1,"table","table-bordered"],[1,"bg-info"],["data-order","desc","data-name","family.name",2,"width","50px",3,"appSort"],["data-order","desc","data-name","data.visit_in_day",2,"width","40px",3,"appSort"],["data-order","desc","data-name","data.all_visit",2,"width","40px",3,"appSort"],["data-order","desc","data-name","data.isVisited",2,"width","40px",3,"appSort"],[4,"ngFor","ngForOf"]],template:function(e,a){1&e&&(t.TgZ(0,"section",0)(1,"div",1)(2,"div",2)(3,"h1",3),t._uU(4,"D\xe9tails Visite M\xe9nages"),t.qZA(),t.TgZ(5,"div",4),t.YNc(6,dt,4,1,"div",5),t.TgZ(7,"div",6)(8,"form",7),t.NdJ("ngSubmit",function(){return a.initDataFilted()}),t.TgZ(9,"div",8)(10,"div",9)(11,"div",10)(12,"label"),t._uU(13,"Date D\xe9but"),t.qZA(),t._UZ(14,"input",11),t.qZA()(),t.TgZ(15,"div",9)(16,"div",10)(17,"label"),t._uU(18,"Date Fin"),t.qZA(),t._UZ(19,"input",12),t.qZA()(),t.TgZ(20,"div",9)(21,"div",10)(22,"label"),t._uU(23,"District"),t.qZA(),t.TgZ(24,"select",13),t.NdJ("change",function(){return a.generateSites()}),t._UZ(25,"option",14),t.YNc(26,ct,2,2,"option",15),t.qZA()()(),t.TgZ(27,"div",9)(28,"div",10)(29,"label"),t._uU(30,"Site"),t.qZA(),t.TgZ(31,"select",16),t.NdJ("change",function(){return a.generateZones()}),t._UZ(32,"option",14),t.YNc(33,ht,2,2,"option",15),t.qZA()()(),t.TgZ(34,"div",9)(35,"div",10)(36,"label"),t._uU(37,"Zone"),t.qZA(),t.TgZ(38,"select",17),t._UZ(39,"option",14),t.YNc(40,ut,2,2,"option",15),t.qZA()()(),t.TgZ(41,"div",9)(42,"div",10)(43,"label"),t._uU(44,"."),t.qZA(),t.TgZ(45,"button",18),t._uU(46," OK "),t._UZ(47,"span",19),t.qZA()()()()()()()()()(),t.YNc(48,ft,32,9,"section",20)),2&e&&(t.xp6(6),t.Q6J("ngIf",a.isLoading),t.xp6(2),t.Q6J("formGroup",a.aggradateDataForm),t.xp6(18),t.Q6J("ngForOf",a.Districts$),t.xp6(7),t.Q6J("ngForOf",a.sites$),t.xp6(7),t.Q6J("ngForOf",a.zones$),t.xp6(5),t.Q6J("disabled",!a.aggradateDataForm.valid),t.xp6(3),t.Q6J("ngIf",null!=a.ChwsDataInfos$&&null!=a.ChwsDataInfos$))},dependencies:[_.sg,_.O5,r._Y,r.YN,r.Kr,r.Fj,r.EJ,r.JJ,r.JL,r.sg,r.u,T,y],styles:[".info[_ngcontent-%COMP%]{color:#00f;font-weight:bolder}.warning[_ngcontent-%COMP%]{color:orange;font-size:large;font-weight:bolder}.primary[_ngcontent-%COMP%]{color:purple;font-size:large;font-weight:bolder}.secondary[_ngcontent-%COMP%]{color:#09e4bf;font-size:large;font-weight:bolder}.success[_ngcontent-%COMP%]{color:green;font-size:large;font-weight:bolder}.success0[_ngcontent-%COMP%]{color:green;font-weight:bolder}.danger[_ngcontent-%COMP%]{color:red;font-size:large;font-weight:bolder}.danger0[_ngcontent-%COMP%]{color:red;font-weight:bolder}.line[_ngcontent-%COMP%]{color:#000;font-size:large;font-weight:bolder}"]}),i})(),_t=(()=>{class i{ngOnInit(){}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-map-chart"]],decls:0,vars:0,template:function(e,a){},styles:["h2[_ngcontent-%COMP%]{font-family:Arial,Helvetica,sans-serif;font-size:1.25rem;margin:0 0 1.5rem}"]}),i})(),Ct=(()=>{class i{constructor(){this.chwOU=null,this.bodyData=[],this.ChwsDataFromDb$=[],this.Districts$=[],this.Chws$=[],this.Sites$=[],this.chws$=[],this.sites$=[],this.responseMessage=""}createDataFilterFormGroup(){return new r.cw({start_date:new r.NI(this.initDate.start_date,[r.kI.required,r.kI.minLength(7)]),end_date:new r.NI(this.initDate.end_date,[r.kI.required,r.kI.minLength(7)]),districts:new r.NI(""),sites:new r.NI(""),withRatio:new r.NI(!1,[r.kI.required])})}ngOnInit(){}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=t.Xpm({type:i,selectors:[["my-app"]],decls:4,vars:0,consts:[["id","highchart_container"]],template:function(e,a){1&e&&t._UZ(0,"br")(1,"br")(2,"br")(3,"div",0)},styles:["p[_ngcontent-%COMP%]{font-family:Lato}#highchart_container[_ngcontent-%COMP%]{margin:0 auto}"]}),i})(),bt=(()=>{class i{ngOnInit(){}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=t.Xpm({type:i,selectors:[["my-app"]],decls:0,vars:0,template:function(e,a){},styles:["p[_ngcontent-%COMP%]{font-family:Lato}"]}),i})(),Zt=(()=>{class i{constructor(){}ngOnInit(){}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=t.Xpm({type:i,selectors:[["googlemaps"]],decls:0,vars:0,template:function(e,a){},styles:["agm-map[_ngcontent-%COMP%]{height:300px}"]}),i})();var b=m(3514);const vt=[{path:"",redirectTo:"dash1",pathMatch:"full"},{path:"dashboard1",component:M,canActivate:[b.o],data:{href:"dashboard1",icon:"fa fa-user",label:"Dashboard-1",title:"Activit\xe9 des ASC"}},{path:"dashboard2",component:et,canActivate:[b.o],data:{href:"dashboard2",icon:"fa fa-user",label:"Dashboard-2",title:"ASC Donn\xe9es d\xe9taill\xe9es"}},{path:"dashboard3",component:lt,canActivate:[b.o],data:{href:"dashboard3",icon:"fa fa-user",label:"Dashboard-3",title:"Effectifs des patients"}},{path:"dashboard4",component:mt,canActivate:[b.o],data:{href:"dashboard4",icon:"fa fa-user",label:"Dashboard-4",title:"D\xe9tails Visite M\xe9nages"}},{path:"highchartmap1",component:_t,canActivate:[b.o],data:{title:"Highchart Map 1"}},{path:"highchartmap2",component:Ct,canActivate:[b.o],data:{title:"Highchart Map 2"}},{path:"highchartmap3",component:bt,canActivate:[b.o],data:{title:"Highchart Map 3"}},{path:"googlemap",component:Zt,canActivate:[b.o],data:{title:"Google Map"}}];let wt=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[F.Bz.forChild(vt),F.Bz]}),i})(),Dt=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[_.ez,r.UX,wt]}),i})()}}]);