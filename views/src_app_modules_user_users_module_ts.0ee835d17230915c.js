"use strict";(self.webpackChunkih_portal=self.webpackChunkih_portal||[]).push([["src_app_modules_user_users_module_ts"],{1233:(E,p,a)=>{a.r(p),a.d(p,{UsersModule:()=>O});var c=a(8692),m=a(3580),f=a(8239),n=a(92),h=a(5128),g=a(8629),d=a(574),e=a(4537),Z=a(1383),U=a(7556),_=a(1815),T=a(5998);let v=(()=>{class s{constructor(t){this.sanitizer=t}transform(t){return this.sanitizer.bypassSecurityTrustHtml(t)}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(T.H7,16))},s.\u0275pipe=e.Yjl({name:"safeHtml",type:s,pure:!0}),s})();function A(s,r){if(1&s){const t=e.EpF();e.TgZ(0,"tbody")(1,"tr")(2,"td"),e._uU(3),e.qZA(),e.TgZ(4,"td"),e._uU(5),e.qZA(),e.TgZ(6,"td"),e._uU(7),e.qZA(),e.TgZ(8,"td"),e._uU(9),e.qZA(),e.TgZ(10,"td"),e._uU(11),e.qZA(),e._UZ(12,"td",52),e.ALo(13,"safeHtml"),e._UZ(14,"td",52),e.ALo(15,"safeHtml"),e._UZ(16,"td",52),e.ALo(17,"safeHtml"),e._UZ(18,"td",52),e.ALo(19,"safeHtml"),e.TgZ(20,"td")(21,"i",53),e.NdJ("click",function(){const l=e.CHM(t).$implicit,u=e.oxw();return e.KtG(u.EditUser(l))}),e.qZA()(),e.TgZ(22,"td")(23,"i",54),e.NdJ("click",function(){const l=e.CHM(t).$implicit,u=e.oxw();return e.KtG(u.UserSelected(l))}),e.qZA()(),e.TgZ(24,"td")(25,"span",55),e._uU(26),e.qZA()(),e.TgZ(27,"td")(28,"span",55),e._uU(29),e.qZA()()()()}if(2&s){const t=r.$implicit,o=r.index,i=e.oxw();e.xp6(3),e.Oqu(t.id),e.xp6(2),e.Oqu(o+1),e.xp6(2),e.Oqu(t.username),e.xp6(2),e.Oqu(t.fullname),e.xp6(2),e.Oqu(t.email),e.xp6(1),e.Q6J("innerHTML",e.lcZ(13,11,i.ToStringNewLine(t.roles,"roles")),e.oJD),e.xp6(2),e.Q6J("innerHTML",e.lcZ(15,13,i.ToStringNewLine(t.groups,"groups")),e.oJD),e.xp6(2),e.Q6J("innerHTML",e.lcZ(17,15,i.ToStringNewLine(t.actions,"actions")),e.oJD),e.xp6(2),e.Q6J("innerHTML",e.lcZ(19,17,i.ToStringNewLine(t.meeting_report,"meeting_report")),e.oJD),e.xp6(8),e.Oqu(t.isActive?"":"\u2713"),e.xp6(3),e.Oqu(t.isSuperAdmin?"\u2713":"")}}function b(s,r){1&s&&(e.TgZ(0,"label",56),e._uU(1,"Username"),e.qZA())}function C(s,r){1&s&&(e.TgZ(0,"label",57),e._uU(1,"Full Name"),e.qZA())}function q(s,r){1&s&&(e.TgZ(0,"label",58),e._uU(1,"R\xf4les"),e.qZA())}function M(s,r){if(1&s&&(e.TgZ(0,"option",59),e._uU(1),e.qZA()),2&s){const t=r.$implicit;e.s9C("value",t.id),e.xp6(1),e.hij(" ",t.name," ")}}function N(s,r){1&s&&(e.TgZ(0,"label",58),e._uU(1,"Groupes"),e.qZA())}function y(s,r){if(1&s&&(e.TgZ(0,"option",59),e._uU(1),e.qZA()),2&s){const t=r.$implicit;e.s9C("value",t.id),e.xp6(1),e.hij(" ",t.name," ")}}function F(s,r){1&s&&(e.TgZ(0,"label",58),e._uU(1,"Actions"),e.qZA())}function x(s,r){if(1&s&&(e.TgZ(0,"option",59),e._uU(1),e.qZA()),2&s){const t=r.$implicit;e.s9C("value",t),e.xp6(1),e.hij(" ",t," ")}}function S(s,r){1&s&&(e.TgZ(0,"label",58),e._uU(1,"Mettingteam"),e.qZA())}function J(s,r){if(1&s&&(e.TgZ(0,"option",59),e._uU(1),e.qZA()),2&s){const t=r.$implicit;e.s9C("value",t.id),e.xp6(1),e.hij(" ",t.name," ")}}const L=[{path:"",component:(()=>{class s{constructor(t,o,i,l){this.store=t,this.auth=o,this.sync=i,this.router=l,this.users$=[],this.roles$=(0,d.vE)(),this.groups$=(0,d._)(),this.actions$=(0,d.uj)(),this.isLoginForm=!1,this.isLoading=!1,this.LoadingMsg="Loading...",this.isEditMode=!1,this.message="",this.APP_LOGO=h.z.APP_LOGO,this.roles=new d.G7(this.store),this.roles.isSuperUser()||(location.href=this.auth.userValue()?.defaultRedirectUrl??"")}activeSave(){throw new Error("Method not implemented.")}ngOnInit(){this.getUsers(),this.GetTeams(),this.userForm=this.createFormGroup()}GetTeams(){var t=this;this.sync.GetTeams().subscribe(function(){var o=(0,f.Z)(function*(i){200==i.status&&(t.MeetingReport$=i.data.sort((l,u)=>l.name.localeCompare(u.name)))});return function(i){return o.apply(this,arguments)}}(),o=>{})}getUsers(){this.auth.getAllUsers().subscribe(t=>{if(200===t.status){this.users$=[];const o=t.data;for(let i=0;i<o.length;i++){const l=o[i];l.isSuperAdmin=l.roles.includes((0,d.i4)().SuperUser.id),this.users$.push(l)}}else console.log(t.data)},t=>{console.log(t.error)})}EditUser(t){this.isEditMode=!0,t.roles=t.roles.toString().replace("[","").replace("]","").split(","),t.groups=(t.groups??[]).toString().replace("[","").replace("]","").split(","),t.actions=(t.actions??[]).toString().replace("[","").replace("]","").split(","),this.userForm=this.createFormGroup(t),this.UserSelected(t)}UserSelected(t){this.selectedUser=t}DeleteUser(){this.isEditMode=!1,this.selectedUser&&this.auth.deleteUser(this.selectedUser).subscribe(t=>{200===t.status?(this.showModalToast("success","Supprim\xe9 avec success"),console.log("successfully deleted!"),this.getUsers(),this.selectedUser=null,this.isLoading=!1):this.message=t.data,console.log(this.message)},t=>{this.message=t,this.isLoading=!1,console.log(this.message)})}CreateUser(){this.isEditMode=!1,this.userForm=this.createFormGroup(),this.selectedUser=null}createFormGroup(t){return new n.cw({username:new n.NI(null!=t?t.username:"",[n.kI.required,n.kI.minLength(4)]),fullname:new n.NI(null!=t?t.fullname:"",[n.kI.required,n.kI.minLength(4)]),roles:new n.NI(null!=t?t.roles:""),groups:new n.NI(null!=t?t.groups:""),actions:new n.NI(null!=t?t.actions:""),meeting_report:new n.NI(null!=t?t.meeting_report:""),isActive:new n.NI(null!=t&&t.isActive)},[this.MatchValidator("password","passwordConfirm")])}passwordMatchError(){return this.userForm.getError("password")&&this.userForm.get("passwordConfirm")?.touched}showModalToast(t,o){showToast(t,o),this.closeModal("close-delete-modal")}closeModal(t="close-modal"){$("#"+t).trigger("click")}MatchValidator(t,o){return i=>{const l=i.get(t),u=i.get(o);if(l&&u){if(l.value!==u.value)return{mismatch:!0};if(this.isEditMode&&((0,g.Nf)(l.value)&&l.value.length<8||(0,g.Nf)(u.value)&&u.value.length<8))return{mismatch:!0}}return null}}ToStringNewLine(t,o){var i=[];return"roles"==o&&(i=this.roles$),i.length>0?i.filter(u=>t.includes(u.id)).map(u=>u.name).join("<br>"):`${t}`.toString().replace(/,/g,"<br>")}register(){var t;if(this.auth.isLoggedIn()){if(this.isEditMode?this.selectedUser&&(this.selectedUser.groups=this.userForm.value.groups,this.selectedUser.roles=this.userForm.value.roles,this.selectedUser.actions=this.userForm.value.actions,this.selectedUser.meeting_report=this.userForm.value.meeting_report,t=this.auth.updateUser(this.selectedUser)):t=this.auth.register(this.userForm.value),t)return t.subscribe(o=>{if(200===o.status){this.message="Registed successfully !",this.closeModal(),this.getUsers();const i=this.auth.userValue(),l=o.data;i&&l&&i.id==l.id&&this.store.set("user",JSON.stringify(o.data))}else this.message=o.data;console.log(this.message),this.isLoading=!1},o=>{this.isLoading=!1})}else this.auth.logout()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Z.u),e.Y36(U.e),e.Y36(_._),e.Y36(m.F0))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-user"]],decls:127,vars:24,consts:[[1,"page-title","card","card-primary","card-outline"],[1,"card-body"],[1,"fas","fa-user",2,"float","left"],["type","button","data-toggle","modal","data-target","#modal-default",1,"btn","btn-default",2,"float","right",3,"click"],[1,"page-content-wrap"],[1,"row"],[1,"col-md-12"],[1,"panel","panel-default"],[1,"panel-heading"],[1,"panel-body"],[1,"table","datatable"],["colspan","2"],[4,"ngFor","ngForOf"],["id","modal-default",1,"modal","fade"],[1,"modal-dialog"],["novalidate","",1,"form-horizontal",3,"formGroup","ngSubmit"],[1,"modal-content"],[1,"modal-header"],["height","30","alt","","srcset","",1,"modal-title",3,"src"],[1,"login-box-msg",2,"text-align","center"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body"],[1,"login-box-msg"],["for","username",4,"ngIf"],[1,"input-group","mb-3"],["id","username","type","text","placeholder","Username","formControlName","username",1,"form-control"],[1,"input-group-append"],[1,"input-group-text"],[1,"fas","fa-user"],["for","fullname",4,"ngIf"],["id","fullname","type","text","placeholder","Full Name","formControlName","fullname",1,"form-control"],["for","",4,"ngIf"],["multiple","multiple","formControlName","roles",1,"form-control"],[3,"value",4,"ngFor","ngForOf"],[1,"fas","fa-lock"],["multiple","multiple","formControlName","groups",1,"form-control"],["multiple","multiple","formControlName","actions",1,"form-control"],["multiple","multiple","formControlName","meeting_report",1,"form-control"],[1,"col-6"],[1,"icheck-primary"],["type","checkbox","id","isActive","formControlName","isActive"],["for","isActive"],[1,"modal-footer","justify-content-between"],["id","close-modal","type","button","data-dismiss","modal",1,"btn","btn-default"],["type","submit",3,"disabled"],["id","modal-danger",1,"modal","fade"],[1,"modal-content","bg-danger"],[1,"modal-title"],["id","close-delete-modal","type","button","data-dismiss","modal","aria-label","Close",1,"close"],["type","button","data-dismiss","modal",1,"btn","btn-default"],["type","button",1,"btn","btn-danger","swalDefaultSuccess",3,"click"],[3,"innerHTML"],["data-toggle","modal","data-target","#modal-default",1,"btn-warning","fas","fa-edit",3,"click"],["data-toggle","modal","data-target","#modal-danger",1,"btn-danger","fas","fa-trash-alt",3,"click"],[2,"font-size","20px"],["for","username"],["for","fullname"],["for",""],[3,"value"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"span",2),e._uU(3," Users List"),e.qZA(),e.TgZ(4,"button",3),e.NdJ("click",function(){return o.CreateUser()}),e._uU(5," Add User "),e.qZA()()(),e.TgZ(6,"div",4)(7,"div",5)(8,"div",6)(9,"div",7),e._UZ(10,"div",8),e.TgZ(11,"div",9)(12,"table",10)(13,"thead")(14,"tr")(15,"th"),e._uU(16,"id"),e.qZA(),e.TgZ(17,"th"),e._uU(18,"N\xb0"),e.qZA(),e.TgZ(19,"th"),e._uU(20,"Username"),e.qZA(),e.TgZ(21,"th"),e._uU(22,"Full name"),e.qZA(),e.TgZ(23,"th"),e._uU(24,"Email"),e.qZA(),e.TgZ(25,"th"),e._uU(26,"R\xf4les"),e.qZA(),e.TgZ(27,"th"),e._uU(28,"Groupes"),e.qZA(),e.TgZ(29,"th"),e._uU(30,"Actions"),e.qZA(),e.TgZ(31,"th"),e._uU(32,"Mettingteam"),e.qZA(),e.TgZ(33,"th",11),e._uU(34,"Actions"),e.qZA(),e.TgZ(35,"th"),e._uU(36,"InActifs"),e.qZA(),e.TgZ(37,"th"),e._uU(38,"IsSuperAdmin"),e.qZA()()(),e.YNc(39,A,30,19,"tbody",12),e.qZA()()()()()(),e.TgZ(40,"div",13)(41,"div",14)(42,"form",15),e.NdJ("ngSubmit",function(){return o.register()}),e.TgZ(43,"div",16)(44,"div",17),e._UZ(45,"img",18),e.TgZ(46,"strong",19)(47,"span"),e._uU(48),e.qZA()(),e.TgZ(49,"button",20)(50,"span",21),e._uU(51,"\xd7"),e.qZA()()(),e.TgZ(52,"div",22)(53,"p",23)(54,"strong"),e._uU(55),e.qZA()(),e.YNc(56,b,2,0,"label",24),e.TgZ(57,"div",25),e._UZ(58,"input",26),e.TgZ(59,"div",27)(60,"div",28),e._UZ(61,"span",29),e.qZA()()(),e.YNc(62,C,2,0,"label",30),e.TgZ(63,"div",25),e._UZ(64,"input",31),e.TgZ(65,"div",27)(66,"div",28),e._UZ(67,"span",29),e.qZA()()(),e.YNc(68,q,2,0,"label",32),e.TgZ(69,"div",25)(70,"select",33),e.YNc(71,M,2,2,"option",34),e.qZA(),e.TgZ(72,"div",27)(73,"div",28),e._UZ(74,"span",35),e.qZA()()(),e.YNc(75,N,2,0,"label",32),e.TgZ(76,"div",25)(77,"select",36),e.YNc(78,y,2,2,"option",34),e.qZA(),e.TgZ(79,"div",27)(80,"div",28),e._UZ(81,"span",35),e.qZA()()(),e.YNc(82,F,2,0,"label",32),e.TgZ(83,"div",25)(84,"select",37),e.YNc(85,x,2,2,"option",34),e.qZA(),e.TgZ(86,"div",27)(87,"div",28),e._UZ(88,"span",35),e.qZA()()(),e.YNc(89,S,2,0,"label",32),e.TgZ(90,"div",25)(91,"select",38),e.YNc(92,J,2,2,"option",34),e.qZA(),e.TgZ(93,"div",27)(94,"div",28),e._UZ(95,"span",35),e.qZA()()(),e.TgZ(96,"div",5)(97,"div",39)(98,"div",25)(99,"div",40),e._UZ(100,"input",41),e.TgZ(101,"label",42),e._uU(102,"Activer"),e.qZA()()()()()(),e.TgZ(103,"div",43)(104,"button",44),e._uU(105,"Close"),e.qZA(),e.TgZ(106,"button",45),e._uU(107),e.qZA()()()()()(),e.TgZ(108,"div",46)(109,"div",14)(110,"div",47)(111,"div",17)(112,"h4",48),e._uU(113,"Suppression d'utilisateur"),e.qZA(),e.TgZ(114,"button",49)(115,"span",21),e._uU(116,"\xd7"),e.qZA()()(),e.TgZ(117,"div",22),e._uU(118," Cette action est ir\xe9versible! \xcates vous s\xfbr de proc\xe9der \xe0 la suppression ? "),e.TgZ(119,"p",23)(120,"strong"),e._uU(121),e.qZA()()(),e.TgZ(122,"div",43)(123,"button",50),e._uU(124,"Annuler"),e.qZA(),e.TgZ(125,"button",51),e.NdJ("click",function(){return o.DeleteUser()}),e._uU(126,"Oui Supprimer !"),e.qZA()()()()()),2&t&&(e.xp6(39),e.Q6J("ngForOf",o.users$),e.xp6(3),e.Q6J("formGroup",o.userForm),e.xp6(3),e.s9C("src",o.APP_LOGO,e.LSH),e.xp6(2),e.Gre(" btn-",o.isEditMode?"warning":"success",""),e.xp6(1),e.Oqu(o.isEditMode?"Modifier un utilisateur":"Ajouter un utilisateur"),e.xp6(7),e.Oqu(o.message),e.xp6(1),e.Q6J("ngIf",o.isEditMode),e.xp6(6),e.Q6J("ngIf",o.isEditMode),e.xp6(6),e.Q6J("ngIf",o.isEditMode),e.xp6(3),e.Q6J("ngForOf",o.roles$),e.xp6(4),e.Q6J("ngIf",o.isEditMode),e.xp6(3),e.Q6J("ngForOf",o.groups$),e.xp6(4),e.Q6J("ngIf",o.isEditMode),e.xp6(3),e.Q6J("ngForOf",o.actions$),e.xp6(4),e.Q6J("ngIf",o.isEditMode),e.xp6(3),e.Q6J("ngForOf",o.MeetingReport$),e.xp6(14),e.Gre("btn btn-",o.isEditMode?"warning":"success",""),e.Q6J("disabled",!o.userForm.valid),e.xp6(1),e.Oqu(o.isEditMode?"Modifier":"Sauvegarder"),e.xp6(14),e.Oqu(o.message))},dependencies:[c.sg,c.O5,n._Y,n.YN,n.Kr,n.Fj,n.Wl,n.K7,n.JJ,n.JL,n.sg,n.u,v],encapsulation:2}),s})(),data:{href:"user",icon:"fa fa-user",label:"Users",title:"Users"}}];let w=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[m.Bz.forChild(L),m.Bz]}),s})(),O=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[c.ez,n.UX,w]}),s})()}}]);