"use strict";(self.webpackChunkih_portal=self.webpackChunkih_portal||[]).push([[257],{3257:(A,m,l)=>{l.r(m),l.d(m,{ChwsManageModule:()=>y});var c=l(8692),u=l(4032),p=l(8239),o=l(92),g=l(8629),e=l(4537),h=l(7556),f=l(1815);function C(n,a){if(1&n&&(e.TgZ(0,"div",43),e._UZ(1,"i",44),e.TgZ(2,"div",45),e._uU(3),e.qZA()()),2&n){const t=e.oxw();e.xp6(3),e.Oqu(t.LoadingMsg)}}function Z(n,a){if(1&n&&(e.TgZ(0,"option",46),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.s9C("value",t.id),e.xp6(1),e.hij(" ",t.name," ")}}function v(n,a){if(1&n&&(e.TgZ(0,"option",46),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.s9C("value",t.id),e.xp6(1),e.hij(" ",t.name," ")}}function w(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"tbody")(1,"tr",47),e.NdJ("click",function(){const r=e.CHM(t).$implicit,d=e.oxw();return e.KtG(d.EditChwsZone(r))}),e.TgZ(2,"td"),e._uU(3),e.qZA(),e.TgZ(4,"td"),e._uU(5),e.qZA()()()}if(2&n){const t=a.$implicit;e.xp6(3),e.Oqu(t.name),e.xp6(2),e.Oqu(t.zone.name)}}function T(n,a){if(1&n&&(e.TgZ(0,"div",43),e._UZ(1,"i",44),e.TgZ(2,"div",45),e._uU(3),e.qZA()()),2&n){const t=e.oxw();e.xp6(3),e.Oqu(t.LoadingMsg)}}function _(n,a){if(1&n&&(e.TgZ(0,"option",46),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.s9C("value",t.id),e.xp6(1),e.hij(" ",t.name," ")}}const b=[{path:"",redirectTo:"replacements",pathMatch:"full"},{path:"replacements",component:(()=>{class n{constructor(t,i,s){this.auth=t,this.syncService=i,this.router=s,this.District$=[],this.Sites$=[],this.Zones$=[],this.district$=[],this.sites$=[],this.replacementChws$=[],this.isLoginForm=!1,this.isLoading1=!1,this.isLoading2=!1,this.LoadingMsg="Loading...",this.isEditMode=!1,this.message=""}activeSave(){throw new Error("Method not implemented.")}ngOnInit(){this.initAllData(),this.filterForm=this.createFilterFormGroup(),this.replacementChwsForm=this.createReplacementChwsFormGroup()}initAllData(){var t=this;return(0,p.Z)(function*(){const i={sources:["Tonoudayo"]};t.syncService.getDistrictsList(i).subscribe(s=>{t.District$=s,t.syncService.getSitesList(i).subscribe(r=>{t.Sites$=r},r=>console.log(r.error))},s=>console.log(s.error))})()}getReplacementChws(){this.isLoading1=!0;const t={sources:["Tonoudayo"],sites:[`${this.filterForm.value.site}`]};this.syncService.getZoneList(t).subscribe(i=>{this.Zones$=i,this.syncService.getChwsList(t).subscribe(s=>{this.replacementChws$=[];for(let r=0;r<s.length;r++){const d=s[r];d.name.includes("(R)")&&this.replacementChws$.push(d)}this.isLoading1=!1},s=>{console.log(s.error),this.isLoading1=!1})},i=>{console.log(i.error),this.isLoading1=!1})}EditChwsZone(t){this.isEditMode=!0,this.replacementChwsForm=this.createReplacementChwsFormGroup(t),this.selectedChw(t)}selectedChw(t){this.chw=t}updateChwsFacilityIdAndContactPlace(){return this.isLoading2=!0,this.auth.updateUserFacilityIdAndContactPlace(this.replacementChwsForm.value).subscribe(t=>{this.message=t.message,this.getReplacementChws(),this.closeModal(),this.isLoading2=!1},t=>{this.message=t,this.isLoading2=!1,console.log(this.message)})}createFilterFormGroup(){return new o.cw({district:new o.NI("",[o.kI.required]),site:new o.NI("",[o.kI.required])})}createReplacementChwsFormGroup(t){return new o.cw({host:new o.NI(null!=t?"portal-integratehealth.org:444":"",[o.kI.required]),contact:new o.NI(null!=t?t.id:"",[o.kI.required]),parent:new o.NI(null!=t?t.zone.id:"",[o.kI.required]),new_parent:new o.NI("",[o.kI.required])},[this.MatchValidator("parent","new_parent")])}MatchValidator(t,i){return s=>{const r=s.get(t),d=s.get(i);return r&&d&&this.isEditMode&&r.value==d.value?{mismatch:!0}:null}}genarateSites(){const t=g.F.returnDataAsArray(this.filterForm.value.district);if(this.sites$=[],g.F.notNull(t))for(let i=0;i<this.Sites$.length;i++){const s=this.Sites$[i];g.F.notNull(s)&&t.includes(s.district.id)&&this.sites$.push(s)}else this.sites$=[]}showModalToast(t,i){showToast(t,i),this.closeModal("close-delete-modal")}closeModal(t="close-modal"){$("#"+t).trigger("click")}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(h.e),e.Y36(f._),e.Y36(u.F0))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-chws_manage"]],decls:81,vars:13,consts:[[1,"page-title","card","card-primary","card-outline"],[1,"card-body"],[1,"fas","fa-user",2,"float","left"],[1,"overlay-wrapper"],["class","overlay",4,"ngIf"],["novalidate","",3,"formGroup","ngSubmit"],[1,"row"],[1,"col-sm-3","col-6"],[1,"form-group"],["formControlName","district",1,"form-control",3,"change"],[3,"value",4,"ngFor","ngForOf"],["formControlName","site",1,"form-control"],[1,"col-sm-2","col-6"],["type","submit",1,"btn","btn-warning","form-control",3,"disabled"],[1,"fa","fa-floppy-o","fa-right"],[1,"page-content-wrap"],[1,"col-md-12"],[1,"panel","panel-default"],[1,"panel-heading"],[1,"panel-body"],[1,"table","datatable"],[4,"ngFor","ngForOf"],["id","modal-default",1,"modal","fade"],[1,"modal-dialog"],["novalidate","",1,"form-horizontal",3,"formGroup","ngSubmit"],[1,"modal-content"],[1,"modal-header"],["height","30","src","assets/logo/logo.png","alt","","srcset","",1,"modal-title"],[1,"login-box-msg",2,"text-align","center"],[1,"btn-warning"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body"],[1,"login-box-msg"],[1,"input-group","mb-3"],["id","new_parent","formControlName","new_parent",1,"form-control"],["value",""],[1,"input-group-append"],[1,"input-group-text"],[1,"fas","fa-edit"],[1,"modal-footer","justify-content-between"],["id","close-modal","type","button","data-dismiss","modal",1,"btn","btn-default"],["type","submit",1,"btn","btn-warning",3,"disabled"],[1,"overlay"],[1,"fas","fa-3x","fa-sync-alt","fa-spin"],[1,"text-bold","pt-2"],[3,"value"],["data-toggle","modal","data-target","#modal-default",3,"click"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"span",2),e._uU(3," Chws List"),e.qZA(),e.TgZ(4,"div",3),e.YNc(5,C,4,1,"div",4),e.TgZ(6,"form",5),e.NdJ("ngSubmit",function(){return i.getReplacementChws()}),e.TgZ(7,"div",6)(8,"div",7)(9,"div",8)(10,"label"),e._uU(11,"District"),e.qZA(),e.TgZ(12,"select",9),e.NdJ("change",function(){return i.genarateSites()}),e.YNc(13,Z,2,2,"option",10),e.qZA()()(),e.TgZ(14,"div",7)(15,"div",8)(16,"label"),e._uU(17,"Site"),e.qZA(),e.TgZ(18,"select",11),e.YNc(19,v,2,2,"option",10),e.qZA()()(),e.TgZ(20,"div",12)(21,"div",8)(22,"label"),e._uU(23,"."),e.qZA(),e.TgZ(24,"button",13),e._uU(25," OK "),e._UZ(26,"span",14),e.qZA()()()()()()()(),e.TgZ(27,"div",15)(28,"div",6)(29,"div",16)(30,"div",17),e._UZ(31,"div",18),e.TgZ(32,"div",19)(33,"table",20)(34,"thead")(35,"tr")(36,"th"),e._uU(37,"Chws"),e.qZA(),e.TgZ(38,"th"),e._uU(39,"Zone"),e.qZA()()(),e.YNc(40,w,6,2,"tbody",21),e.qZA()()()()()(),e.TgZ(41,"div",22)(42,"div",23)(43,"div",3),e.YNc(44,T,4,1,"div",4),e.TgZ(45,"form",24),e.NdJ("ngSubmit",function(){return i.updateChwsFacilityIdAndContactPlace()}),e.TgZ(46,"div",25)(47,"div",26),e._UZ(48,"img",27),e.TgZ(49,"strong",28)(50,"span",29),e._uU(51,"Modifier la zone"),e.qZA()(),e.TgZ(52,"button",30)(53,"span",31),e._uU(54,"\xd7"),e.qZA()()(),e.TgZ(55,"div",32)(56,"p",33)(57,"strong"),e._uU(58),e.qZA()(),e.TgZ(59,"p"),e._uU(60,"L'ASC remplacante "),e.TgZ(61,"strong"),e._uU(62),e.qZA(),e._uU(63," intervient pr\xe9sentement dans "),e.TgZ(64,"strong"),e._uU(65),e.qZA()(),e._UZ(66,"br"),e.TgZ(67,"p"),e._uU(68,"Selectionner une nouvelle zone d'intervention"),e.qZA(),e.TgZ(69,"div",34)(70,"select",35),e._UZ(71,"option",36),e.YNc(72,_,2,2,"option",10),e.qZA(),e.TgZ(73,"div",37)(74,"div",38),e._UZ(75,"span",39),e.qZA()()()(),e.TgZ(76,"div",40)(77,"button",41),e._uU(78,"Close"),e.qZA(),e.TgZ(79,"button",42),e._uU(80,"Modifier"),e.qZA()()()()()()()),2&t&&(e.xp6(5),e.Q6J("ngIf",i.isLoading1),e.xp6(1),e.Q6J("formGroup",i.filterForm),e.xp6(7),e.Q6J("ngForOf",i.District$),e.xp6(6),e.Q6J("ngForOf",i.sites$),e.xp6(5),e.Q6J("disabled",!i.filterForm.valid),e.xp6(16),e.Q6J("ngForOf",i.replacementChws$),e.xp6(4),e.Q6J("ngIf",i.isLoading2),e.xp6(1),e.Q6J("formGroup",i.replacementChwsForm),e.xp6(13),e.Oqu(i.message),e.xp6(4),e.Oqu(null==i.chw?null:i.chw.name),e.xp6(3),e.Oqu(null==i.chw||null==i.chw.zone?null:i.chw.zone.name),e.xp6(7),e.Q6J("ngForOf",i.Zones$),e.xp6(7),e.Q6J("disabled",!i.replacementChwsForm.valid))},dependencies:[c.sg,c.O5,o._Y,o.YN,o.Kr,o.EJ,o.JJ,o.JL,o.sg,o.u],encapsulation:2}),n})(),data:{href:"replacements",icon:"fa fa-user",label:"Remplacants",title:"Remplacants"}}];let M=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[u.Bz.forChild(b),u.Bz]}),n})(),y=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[c.ez,o.UX,M]}),n})()}}]);