"use strict";(self.webpackChunkih_portal=self.webpackChunkih_portal||[]).push([["src_app_modules_user_users_module_ts"],{9460:(y,p,n)=>{n.r(p),n.d(p,{UsersModule:()=>F});var m=n(8692),c=n(3580),i=n(92),g=n(5128),u=n(8629),f=n(574),e=n(4537),h=n(1383),Z=n(7556);function U(s,r){if(1&s){const t=e.EpF();e.TgZ(0,"tbody")(1,"tr")(2,"td"),e._uU(3),e.qZA(),e.TgZ(4,"td"),e._uU(5),e.qZA(),e.TgZ(6,"td"),e._uU(7),e.qZA(),e.TgZ(8,"td"),e._uU(9),e.qZA(),e.TgZ(10,"td"),e._uU(11),e.qZA(),e.TgZ(12,"td")(13,"i",53),e.NdJ("click",function(){const l=e.CHM(t).$implicit,d=e.oxw();return e.KtG(d.EditUser(l))}),e.qZA()(),e.TgZ(14,"td")(15,"i",54),e.NdJ("click",function(){const l=e.CHM(t).$implicit,d=e.oxw();return e.KtG(d.selectedUser(l))}),e.qZA()(),e.TgZ(16,"td")(17,"span",55),e._uU(18),e.qZA()()()()}if(2&s){const t=r.$implicit,o=r.index;e.xp6(3),e.Oqu(t.id),e.xp6(2),e.Oqu(o+1),e.xp6(2),e.Oqu(t.username),e.xp6(2),e.Oqu(t.fullname),e.xp6(2),e.Oqu(t.roles),e.xp6(7),e.Oqu(t.isActive?"":"\u2713")}}function v(s,r){1&s&&(e.TgZ(0,"label",56),e._uU(1,"Username"),e.qZA())}function _(s,r){1&s&&(e.TgZ(0,"label",57),e._uU(1,"Full Name"),e.qZA())}function b(s,r){1&s&&(e.TgZ(0,"label",58),e._uU(1,"Password"),e.qZA())}function T(s,r){1&s&&(e.TgZ(0,"label",59),e._uU(1,"Password COnfirm"),e.qZA())}function A(s,r){1&s&&(e.TgZ(0,"div",60),e._uU(1," Password does not match "),e.qZA())}function C(s,r){1&s&&(e.TgZ(0,"label",59),e._uU(1,"R\xf4les"),e.qZA())}function q(s,r){if(1&s&&(e.TgZ(0,"option",61),e._uU(1),e.qZA()),2&s){const t=r.$implicit;e.s9C("value",t),e.xp6(1),e.hij(" ",t," ")}}const w=[{path:"",component:(()=>{class s{constructor(t,o,a){this.store=t,this.auth=o,this.router=a,this.users$=[],this.roles$=[],this.isLoginForm=!1,this.isLoading=!1,this.LoadingMsg="Loading...",this.isEditMode=!1,this.message="",this.APP_LOGO=g.z.APP_LOGO,this.roles=new f.G(this.store),this.roles.isSuperUser()||(location.href=this.auth.userValue()?.defaultRedirectUrl)}activeSave(){throw new Error("Method not implemented.")}ngOnInit(){this.getUsers(),this.userForm=this.createFormGroup()}getUsers(){this.auth.getAllUsers().subscribe(t=>{if(200===t.status){this.users$=[];const o=t.data;for(let a=0;a<o.length;a++)this.users$.push(o[a])}else console.log(t.data)},t=>{console.log(t.error)})}EditUser(t){this.isEditMode=!0,t.roles=t.roles.toString().replace("[","").replace("]","").split(","),this.userForm=this.createFormGroup(t),this.selectedUser(t)}selectedUser(t){this.user=t}DeleteUser(){this.isEditMode=!1,this.user&&this.auth.deleteUser(this.user).subscribe(t=>{200===t.status?(this.showModalToast("success","Supprim\xe9 avec success"),console.log("successfully deleted!"),this.getUsers(),this.user=null,this.isLoading=!1):this.message=t.data,console.log(this.message)},t=>{this.message=t,this.isLoading=!1,console.log(this.message)})}CreateUser(){this.isEditMode=!1,this.userForm=this.createFormGroup(),this.user=null}createFormGroup(t){return new i.cw({username:new i.NI(null!=t?t.username:"",[i.kI.required,i.kI.minLength(4)]),fullname:new i.NI(null!=t?t.fullname:"",[i.kI.required,i.kI.minLength(4)]),password:new i.NI("",this.isEditMode?[]:[i.kI.required,i.kI.minLength(8)]),passwordConfirm:new i.NI("",this.isEditMode?[]:[i.kI.required,i.kI.minLength(8)]),roles:new i.NI(null!=t?t.roles:"",[i.kI.required,i.kI.minLength(1)]),isActive:new i.NI(null!=t&&t.isActive)},[this.MatchValidator("password","passwordConfirm")])}passwordMatchError(){return this.userForm.getError("password")&&this.userForm.get("passwordConfirm")?.touched}showModalToast(t,o){showToast(t,o),this.closeModal("close-delete-modal")}closeModal(t="close-modal"){$("#"+t).trigger("click")}MatchValidator(t,o){return a=>{const l=a.get(t),d=a.get(o);if(l&&d){if(l.value!==d.value)return{mismatch:!0};if(this.isEditMode&&((0,u.Nf)(l.value)&&l.value.length<8||(0,u.Nf)(d.value)&&d.value.length<8))return{mismatch:!0}}return null}}register(){if(this.auth.isLoggedIn()){if(this.isEditMode){const t=(0,u.Nf)(this.userForm.value.password)&&(0,u.Nf)(this.userForm.value.passwordConfirm);this.userForm.value.editPassword=t,this.userForm.value.id=this.user.id}return(this.isEditMode?this.auth.updateUser(this.userForm.value):this.auth.register(this.userForm.value)).subscribe(t=>{200===t.status?(this.message="Registed successfully !",this.closeModal(),console.log("successfully !"),this.getUsers()):this.message=t.data,console.log(this.message),this.isLoading=!1},t=>{this.isLoading=!1})}this.auth.logout()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(h.u),e.Y36(Z.e),e.Y36(c.F0))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-user"]],decls:113,vars:21,consts:[[1,"page-title","card","card-primary","card-outline"],[1,"card-body"],[1,"fas","fa-user",2,"float","left"],["type","button","data-toggle","modal","data-target","#modal-default",1,"btn","btn-default",2,"float","right",3,"click"],[1,"page-content-wrap"],[1,"row"],[1,"col-md-12"],[1,"panel","panel-default"],[1,"panel-heading"],[1,"panel-body"],[1,"table","datatable"],["colspan","2"],[4,"ngFor","ngForOf"],["id","modal-default",1,"modal","fade"],[1,"modal-dialog"],["novalidate","",1,"form-horizontal",3,"formGroup","ngSubmit"],[1,"modal-content"],[1,"modal-header"],["height","30","alt","","srcset","",1,"modal-title",3,"src"],[1,"login-box-msg",2,"text-align","center"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body"],[1,"login-box-msg"],["for","username",4,"ngIf"],[1,"input-group","mb-3"],["id","username","type","text","placeholder","Username","formControlName","username",1,"form-control"],[1,"input-group-append"],[1,"input-group-text"],[1,"fas","fa-user"],["for","fullname",4,"ngIf"],["id","fullname","type","text","placeholder","Full Name","formControlName","fullname",1,"form-control"],["for","password",4,"ngIf"],["id","password","type","password","placeholder","Password","formControlName","password",1,"form-control"],[1,"fas","fa-lock"],["for","passwordConfirm",4,"ngIf"],["id","passwordConfirm","type","password","placeholder","Retype password","formControlName","passwordConfirm",1,"form-control"],["class","btn btn-danger",4,"ngIf"],["multiple","multiple","formControlName","roles",1,"form-control"],[3,"value",4,"ngFor","ngForOf"],[1,"col-6"],[1,"icheck-primary"],["type","checkbox","id","isActive","formControlName","isActive"],["for","isActive"],[1,"modal-footer","justify-content-between"],["id","close-modal","type","button","data-dismiss","modal",1,"btn","btn-default"],["type","submit",3,"disabled"],["id","modal-danger",1,"modal","fade"],[1,"modal-content","bg-danger"],[1,"modal-title"],["id","close-delete-modal","type","button","data-dismiss","modal","aria-label","Close",1,"close"],["type","button","data-dismiss","modal",1,"btn","btn-default"],["type","button",1,"btn","btn-danger","swalDefaultSuccess",3,"click"],["data-toggle","modal","data-target","#modal-default",1,"btn-warning","fas","fa-edit",3,"click"],["data-toggle","modal","data-target","#modal-danger",1,"btn-danger","fas","fa-trash-alt",3,"click"],[2,"font-size","20px"],["for","username"],["for","fullname"],["for","password"],["for","passwordConfirm"],[1,"btn","btn-danger"],[3,"value"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"span",2),e._uU(3," Users List"),e.qZA(),e.TgZ(4,"button",3),e.NdJ("click",function(){return o.CreateUser()}),e._uU(5," Add User "),e.qZA()()(),e.TgZ(6,"div",4)(7,"div",5)(8,"div",6)(9,"div",7),e._UZ(10,"div",8),e.TgZ(11,"div",9)(12,"table",10)(13,"thead")(14,"tr")(15,"th"),e._uU(16,"id"),e.qZA(),e.TgZ(17,"th"),e._uU(18,"N\xb0"),e.qZA(),e.TgZ(19,"th"),e._uU(20,"Username"),e.qZA(),e.TgZ(21,"th"),e._uU(22,"Full name"),e.qZA(),e.TgZ(23,"th"),e._uU(24,"Email"),e.qZA(),e.TgZ(25,"th"),e._uU(26,"Role"),e.qZA(),e.TgZ(27,"th",11),e._uU(28,"Actions"),e.qZA(),e.TgZ(29,"th"),e._uU(30,"InActifs"),e.qZA(),e.TgZ(31,"th"),e._uU(32,"IsSuperAdmin"),e.qZA()()(),e.YNc(33,U,19,6,"tbody",12),e.qZA()()()()()(),e.TgZ(34,"div",13)(35,"div",14)(36,"form",15),e.NdJ("ngSubmit",function(){return o.register()}),e.TgZ(37,"div",16)(38,"div",17),e._UZ(39,"img",18),e.TgZ(40,"strong",19)(41,"span"),e._uU(42),e.qZA()(),e.TgZ(43,"button",20)(44,"span",21),e._uU(45,"\xd7"),e.qZA()()(),e.TgZ(46,"div",22)(47,"p",23)(48,"strong"),e._uU(49),e.qZA()(),e.YNc(50,v,2,0,"label",24),e.TgZ(51,"div",25),e._UZ(52,"input",26),e.TgZ(53,"div",27)(54,"div",28),e._UZ(55,"span",29),e.qZA()()(),e.YNc(56,_,2,0,"label",30),e.TgZ(57,"div",25),e._UZ(58,"input",31),e.TgZ(59,"div",27)(60,"div",28),e._UZ(61,"span",29),e.qZA()()(),e.YNc(62,b,2,0,"label",32),e.TgZ(63,"div",25),e._UZ(64,"input",33),e.TgZ(65,"div",27)(66,"div",28),e._UZ(67,"span",34),e.qZA()()(),e.YNc(68,T,2,0,"label",35),e.TgZ(69,"div",25),e._UZ(70,"input",36),e.TgZ(71,"div",27)(72,"div",28),e._UZ(73,"span",34),e.qZA()()(),e.YNc(74,A,2,0,"div",37),e.YNc(75,C,2,0,"label",35),e.TgZ(76,"div",25)(77,"select",38),e.YNc(78,q,2,2,"option",39),e.qZA(),e.TgZ(79,"div",27)(80,"div",28),e._UZ(81,"span",34),e.qZA()()(),e.TgZ(82,"div",5)(83,"div",40)(84,"div",25)(85,"div",41),e._UZ(86,"input",42),e.TgZ(87,"label",43),e._uU(88,"Activer"),e.qZA()()()()()(),e.TgZ(89,"div",44)(90,"button",45),e._uU(91,"Close"),e.qZA(),e.TgZ(92,"button",46),e._uU(93),e.qZA()()()()()(),e.TgZ(94,"div",47)(95,"div",14)(96,"div",48)(97,"div",17)(98,"h4",49),e._uU(99,"Suppression d'utilisateur"),e.qZA(),e.TgZ(100,"button",50)(101,"span",21),e._uU(102,"\xd7"),e.qZA()()(),e.TgZ(103,"div",22),e._uU(104," Cette action est ir\xe9versible! \xcates vous s\xfbr de proc\xe9der \xe0 la suppression ? "),e.TgZ(105,"p",23)(106,"strong"),e._uU(107),e.qZA()()(),e.TgZ(108,"div",44)(109,"button",51),e._uU(110,"Annuler"),e.qZA(),e.TgZ(111,"button",52),e.NdJ("click",function(){return o.DeleteUser()}),e._uU(112,"Oui Supprimer !"),e.qZA()()()()()),2&t&&(e.xp6(33),e.Q6J("ngForOf",o.users$),e.xp6(3),e.Q6J("formGroup",o.userForm),e.xp6(3),e.s9C("src",o.APP_LOGO,e.LSH),e.xp6(2),e.Gre(" btn-",o.isEditMode?"warning":"success",""),e.xp6(1),e.Oqu(o.isEditMode?"Modifier un utilisateur":"Ajouter un utilisateur"),e.xp6(7),e.Oqu(o.message),e.xp6(1),e.Q6J("ngIf",o.isEditMode),e.xp6(6),e.Q6J("ngIf",o.isEditMode),e.xp6(6),e.Q6J("ngIf",o.isEditMode),e.xp6(6),e.Q6J("ngIf",o.isEditMode),e.xp6(6),e.Q6J("ngIf",o.passwordMatchError()),e.xp6(1),e.Q6J("ngIf",o.isEditMode),e.xp6(3),e.Q6J("ngForOf",o.roles$),e.xp6(14),e.Gre("btn btn-",o.isEditMode?"warning":"success",""),e.Q6J("disabled",!o.userForm.valid),e.xp6(1),e.Oqu(o.isEditMode?"Modifier":"Sauvegarder"),e.xp6(14),e.Oqu(o.message))},dependencies:[m.sg,m.O5,i._Y,i.YN,i.Kr,i.Fj,i.Wl,i.K7,i.JJ,i.JL,i.sg,i.u],encapsulation:2}),s})(),data:{href:"user",icon:"fa fa-user",label:"Users",title:"Users"}}];let M=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[c.Bz.forChild(w),c.Bz]}),s})(),F=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[m.ez,i.UX,M]}),s})()}}]);